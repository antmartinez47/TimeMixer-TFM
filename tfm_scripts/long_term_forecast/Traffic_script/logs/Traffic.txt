Args in experiment:
Namespace(task_name='long_term_forecast', model='TimeMixer', data='custom', root_path='./dataset/traffic/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=0, pred_len=96, seasonal_patterns='Monthly', inverse=False, top_k=5, num_kernels=6, enc_in=862, dec_in=862, c_out=862, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, mask_rate=0.25, anomaly_ratio=0.25, num_workers=10, itr=1, train_epochs=10, batch_size=8, patience=10, learning_rate=0.01, des='test', loss='MSE', lradj='TST', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', p_hidden_dims=[128, 128], p_hidden_layers=2, save_dir='./checkpoints/baseline/TimeMixer/traffic_96_96', save_last=False, break_at=0, seed=2021, delta=0.0)
Use GPU: cuda:0
########   Session 0   ########
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.6622213
	speed: 0.1427s/iter; left time: 2141.5791s
	iters: 200, epoch: 1 | loss: 0.4818269
	speed: 0.1371s/iter; left time: 2043.8720s
	iters: 300, epoch: 1 | loss: 0.4501028
	speed: 0.1373s/iter; left time: 2033.2260s
	iters: 400, epoch: 1 | loss: 0.4519575
	speed: 0.1374s/iter; left time: 2021.0229s
	iters: 500, epoch: 1 | loss: 0.4523837
	speed: 0.1373s/iter; left time: 2006.0849s
	iters: 600, epoch: 1 | loss: 0.3903823
	speed: 0.1372s/iter; left time: 1990.5448s
	iters: 700, epoch: 1 | loss: 0.5134395
	speed: 0.1370s/iter; left time: 1974.6881s
	iters: 800, epoch: 1 | loss: 0.3561489
	speed: 0.1369s/iter; left time: 1959.6555s
	iters: 900, epoch: 1 | loss: 0.3412529
	speed: 0.1369s/iter; left time: 1945.2717s
	iters: 1000, epoch: 1 | loss: 0.3327740
	speed: 0.1368s/iter; left time: 1930.9358s
	iters: 1100, epoch: 1 | loss: 0.3443124
	speed: 0.1368s/iter; left time: 1916.3954s
	iters: 1200, epoch: 1 | loss: 0.3477029
	speed: 0.1368s/iter; left time: 1903.3155s
	iters: 1300, epoch: 1 | loss: 0.4580371
	speed: 0.1368s/iter; left time: 1889.1749s
	iters: 1400, epoch: 1 | loss: 0.3240027
	speed: 0.1367s/iter; left time: 1874.7009s
	iters: 1500, epoch: 1 | loss: 0.3488558
	speed: 0.1367s/iter; left time: 1860.8949s
Epoch: 1 cost time: 207.3176782131195
Epoch: 1, Steps: 1511 | Train Loss: 0.4251587 Vali Loss: 0.4572802
Updating learning rate to 0.005202495803385922
Validation loss decreased (inf --> 0.4573).  Saving model state dict ...
	iters: 100, epoch: 2 | loss: 0.2874454
	speed: 0.2855s/iter; left time: 3854.4969s
	iters: 200, epoch: 2 | loss: 0.3283720
	speed: 0.1367s/iter; left time: 1832.1707s
	iters: 300, epoch: 2 | loss: 0.2770384
	speed: 0.1368s/iter; left time: 1819.5886s
	iters: 400, epoch: 2 | loss: 0.3530997
	speed: 0.1369s/iter; left time: 1807.3658s
	iters: 500, epoch: 2 | loss: 0.2854026
	speed: 0.1370s/iter; left time: 1794.1254s
	iters: 600, epoch: 2 | loss: 0.3221686
	speed: 0.1371s/iter; left time: 1782.0782s
	iters: 700, epoch: 2 | loss: 0.2558519
	speed: 0.1370s/iter; left time: 1766.7122s
	iters: 800, epoch: 2 | loss: 0.2780473
	speed: 0.1370s/iter; left time: 1753.2076s
	iters: 900, epoch: 2 | loss: 0.2827252
	speed: 0.1369s/iter; left time: 1738.9867s
	iters: 1000, epoch: 2 | loss: 0.2938064
	speed: 0.1369s/iter; left time: 1724.9395s
	iters: 1100, epoch: 2 | loss: 0.2599226
	speed: 0.1369s/iter; left time: 1710.8966s
	iters: 1200, epoch: 2 | loss: 0.2700859
	speed: 0.1368s/iter; left time: 1696.8046s
	iters: 1300, epoch: 2 | loss: 0.3396494
	speed: 0.1368s/iter; left time: 1682.4513s
	iters: 1400, epoch: 2 | loss: 0.2843161
	speed: 0.1367s/iter; left time: 1667.8974s
	iters: 1500, epoch: 2 | loss: 0.3227448
	speed: 0.1367s/iter; left time: 1654.4900s
Epoch: 2 cost time: 206.8649024963379
Epoch: 2, Steps: 1511 | Train Loss: 0.3119785 Vali Loss: 0.4472136
Updating learning rate to 0.009999999831139096
Validation loss decreased (0.4573 --> 0.4472).  Saving model state dict ...
	iters: 100, epoch: 3 | loss: 0.2683495
	speed: 0.2857s/iter; left time: 3425.7299s
	iters: 200, epoch: 3 | loss: 0.2957295
	speed: 0.1367s/iter; left time: 1625.5006s
	iters: 300, epoch: 3 | loss: 0.2877164
	speed: 0.1368s/iter; left time: 1612.4684s
	iters: 400, epoch: 3 | loss: 0.2966642
	speed: 0.1369s/iter; left time: 1600.5736s
	iters: 500, epoch: 3 | loss: 0.2815051
	speed: 0.1370s/iter; left time: 1587.8349s
	iters: 600, epoch: 3 | loss: 0.2515118
	speed: 0.1369s/iter; left time: 1573.1438s
	iters: 700, epoch: 3 | loss: 0.2820962
	speed: 0.1370s/iter; left time: 1559.8447s
	iters: 800, epoch: 3 | loss: 0.3219042
	speed: 0.1370s/iter; left time: 1546.1275s
	iters: 900, epoch: 3 | loss: 0.2765285
	speed: 0.1369s/iter; left time: 1531.5779s
	iters: 1000, epoch: 3 | loss: 0.2722349
	speed: 0.1368s/iter; left time: 1517.1647s
	iters: 1100, epoch: 3 | loss: 0.3085361
	speed: 0.1368s/iter; left time: 1503.3138s
	iters: 1200, epoch: 3 | loss: 0.3425957
	speed: 0.1368s/iter; left time: 1489.8140s
	iters: 1300, epoch: 3 | loss: 0.2671114
	speed: 0.1368s/iter; left time: 1475.5520s
	iters: 1400, epoch: 3 | loss: 0.2681303
	speed: 0.1368s/iter; left time: 1461.7632s
	iters: 1500, epoch: 3 | loss: 0.2567492
	speed: 0.1368s/iter; left time: 1448.4692s
Epoch: 3 cost time: 206.84483909606934
Epoch: 3, Steps: 1511 | Train Loss: 0.2970568 Vali Loss: 0.4311876
Updating learning rate to 0.00961890174626619
Validation loss decreased (0.4472 --> 0.4312).  Saving model state dict ...
	iters: 100, epoch: 4 | loss: 0.3243813
	speed: 0.2857s/iter; left time: 2994.0073s
	iters: 200, epoch: 4 | loss: 0.2796004
	speed: 0.1367s/iter; left time: 1419.1831s
	iters: 300, epoch: 4 | loss: 0.2560544
	speed: 0.1368s/iter; left time: 1406.1504s
	iters: 400, epoch: 4 | loss: 0.3056557
	speed: 0.1369s/iter; left time: 1393.4562s
	iters: 500, epoch: 4 | loss: 0.3205357
	speed: 0.1370s/iter; left time: 1381.1367s
	iters: 600, epoch: 4 | loss: 0.2797731
	speed: 0.1370s/iter; left time: 1366.6233s
	iters: 700, epoch: 4 | loss: 0.2878877
	speed: 0.1370s/iter; left time: 1353.2545s
	iters: 800, epoch: 4 | loss: 0.2917299
	speed: 0.1369s/iter; left time: 1338.7639s
	iters: 900, epoch: 4 | loss: 0.2846511
	speed: 0.1369s/iter; left time: 1325.2268s
	iters: 1000, epoch: 4 | loss: 0.3354641
	speed: 0.1368s/iter; left time: 1310.2132s
	iters: 1100, epoch: 4 | loss: 0.2694825
	speed: 0.1368s/iter; left time: 1296.7515s
	iters: 1200, epoch: 4 | loss: 0.2905752
	speed: 0.1368s/iter; left time: 1283.3287s
	iters: 1300, epoch: 4 | loss: 0.2893657
	speed: 0.1368s/iter; left time: 1269.1829s
	iters: 1400, epoch: 4 | loss: 0.3004290
	speed: 0.1368s/iter; left time: 1255.4461s
	iters: 1500, epoch: 4 | loss: 0.3022977
	speed: 0.1368s/iter; left time: 1242.2171s
Epoch: 4 cost time: 206.87027955055237
Epoch: 4, Steps: 1511 | Train Loss: 0.2899063 Vali Loss: 0.4312182
Updating learning rate to 0.00853462078579155
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3067512
	speed: 0.2858s/iter; left time: 2562.5031s
	iters: 200, epoch: 5 | loss: 0.3376164
	speed: 0.1368s/iter; left time: 1213.2143s
	iters: 300, epoch: 5 | loss: 0.2513224
	speed: 0.1370s/iter; left time: 1201.1946s
	iters: 400, epoch: 5 | loss: 0.3139269
	speed: 0.1370s/iter; left time: 1187.7453s
	iters: 500, epoch: 5 | loss: 0.3014299
	speed: 0.1371s/iter; left time: 1174.7342s
	iters: 600, epoch: 5 | loss: 0.3138584
	speed: 0.1371s/iter; left time: 1160.7076s
	iters: 700, epoch: 5 | loss: 0.3305940
	speed: 0.1371s/iter; left time: 1147.0218s
	iters: 800, epoch: 5 | loss: 0.2860945
	speed: 0.1370s/iter; left time: 1132.5231s
	iters: 900, epoch: 5 | loss: 0.3060617
	speed: 0.1370s/iter; left time: 1119.2415s
	iters: 1000, epoch: 5 | loss: 0.2796663
	speed: 0.1369s/iter; left time: 1104.3939s
	iters: 1100, epoch: 5 | loss: 0.2523438
	speed: 0.1369s/iter; left time: 1090.7919s
	iters: 1200, epoch: 5 | loss: 0.2891715
	speed: 0.1369s/iter; left time: 1076.6527s
	iters: 1300, epoch: 5 | loss: 0.3307385
	speed: 0.1368s/iter; left time: 1062.7356s
	iters: 1400, epoch: 5 | loss: 0.2561072
	speed: 0.1368s/iter; left time: 1049.0928s
	iters: 1500, epoch: 5 | loss: 0.2700347
	speed: 0.1368s/iter; left time: 1035.2791s
Epoch: 5 cost time: 206.9989938735962
Epoch: 5, Steps: 1511 | Train Loss: 0.2830075 Vali Loss: 0.4224993
Updating learning rate to 0.00691222889691606
Validation loss decreased (0.4312 --> 0.4225).  Saving model state dict ...
	iters: 100, epoch: 6 | loss: 0.2989474
	speed: 0.2859s/iter; left time: 2131.6709s
	iters: 200, epoch: 6 | loss: 0.2752961
	speed: 0.1370s/iter; left time: 1007.7485s
	iters: 300, epoch: 6 | loss: 0.2669994
	speed: 0.1370s/iter; left time: 994.2635s
	iters: 400, epoch: 6 | loss: 0.2157202
	speed: 0.1372s/iter; left time: 981.8102s
	iters: 500, epoch: 6 | loss: 0.2802855
	speed: 0.1372s/iter; left time: 968.1588s
	iters: 600, epoch: 6 | loss: 0.2596782
	speed: 0.1372s/iter; left time: 954.5497s
	iters: 700, epoch: 6 | loss: 0.2456547
	speed: 0.1372s/iter; left time: 940.5425s
	iters: 800, epoch: 6 | loss: 0.3061946
	speed: 0.1372s/iter; left time: 927.1969s
	iters: 900, epoch: 6 | loss: 0.2724679
	speed: 0.1371s/iter; left time: 912.5740s
	iters: 1000, epoch: 6 | loss: 0.2543524
	speed: 0.1371s/iter; left time: 898.9346s
	iters: 1100, epoch: 6 | loss: 0.2301403
	speed: 0.1370s/iter; left time: 884.5232s
	iters: 1200, epoch: 6 | loss: 0.2933570
	speed: 0.1371s/iter; left time: 871.1879s
	iters: 1300, epoch: 6 | loss: 0.3056034
	speed: 0.1371s/iter; left time: 857.4960s
	iters: 1400, epoch: 6 | loss: 0.2406904
	speed: 0.1370s/iter; left time: 843.5560s
	iters: 1500, epoch: 6 | loss: 0.3283797
	speed: 0.1370s/iter; left time: 829.7096s
Epoch: 6 cost time: 207.22897171974182
Epoch: 6, Steps: 1511 | Train Loss: 0.2737439 Vali Loss: 0.4217357
Updating learning rate to 0.004998720537701914
Validation loss decreased (0.4225 --> 0.4217).  Saving model state dict ...
	iters: 100, epoch: 7 | loss: 0.2394056
	speed: 0.2861s/iter; left time: 1701.1203s
	iters: 200, epoch: 7 | loss: 0.2898952
	speed: 0.1368s/iter; left time: 799.6481s
	iters: 300, epoch: 7 | loss: 0.2094966
	speed: 0.1369s/iter; left time: 786.4974s
	iters: 400, epoch: 7 | loss: 0.2619516
	speed: 0.1370s/iter; left time: 773.4983s
	iters: 500, epoch: 7 | loss: 0.2906471
	speed: 0.1370s/iter; left time: 759.8352s
	iters: 600, epoch: 7 | loss: 0.2424629
	speed: 0.1370s/iter; left time: 745.9422s
	iters: 700, epoch: 7 | loss: 0.2504155
	speed: 0.1370s/iter; left time: 732.2255s
	iters: 800, epoch: 7 | loss: 0.2385606
	speed: 0.1369s/iter; left time: 718.0818s
	iters: 900, epoch: 7 | loss: 0.2430686
	speed: 0.1369s/iter; left time: 704.2514s
	iters: 1000, epoch: 7 | loss: 0.2557161
	speed: 0.1369s/iter; left time: 690.4618s
	iters: 1100, epoch: 7 | loss: 0.2395110
	speed: 0.1368s/iter; left time: 676.7227s
	iters: 1200, epoch: 7 | loss: 0.2416090
	speed: 0.1368s/iter; left time: 662.7311s
	iters: 1300, epoch: 7 | loss: 0.2504953
	speed: 0.1368s/iter; left time: 649.0563s
	iters: 1400, epoch: 7 | loss: 0.2488357
	speed: 0.1367s/iter; left time: 635.1499s
	iters: 1500, epoch: 7 | loss: 0.2136235
	speed: 0.1367s/iter; left time: 621.4131s
Epoch: 7 cost time: 206.89811515808105
Epoch: 7, Steps: 1511 | Train Loss: 0.2653385 Vali Loss: 0.4128370
Updating learning rate to 0.003085410009842998
Validation loss decreased (0.4217 --> 0.4128).  Saving model state dict ...
	iters: 100, epoch: 8 | loss: 0.2896321
	speed: 0.2858s/iter; left time: 1267.1109s
	iters: 200, epoch: 8 | loss: 0.2453706
	speed: 0.1368s/iter; left time: 592.6831s
	iters: 300, epoch: 8 | loss: 0.2334545
	speed: 0.1368s/iter; left time: 579.1849s
	iters: 400, epoch: 8 | loss: 0.2127908
	speed: 0.1369s/iter; left time: 565.8894s
	iters: 500, epoch: 8 | loss: 0.2519562
	speed: 0.1370s/iter; left time: 552.4905s
	iters: 600, epoch: 8 | loss: 0.2301087
	speed: 0.1370s/iter; left time: 538.9910s
	iters: 700, epoch: 8 | loss: 0.2627757
	speed: 0.1370s/iter; left time: 525.1565s
	iters: 800, epoch: 8 | loss: 0.2632325
	speed: 0.1369s/iter; left time: 511.2141s
	iters: 900, epoch: 8 | loss: 0.2813226
	speed: 0.1368s/iter; left time: 497.2381s
	iters: 1000, epoch: 8 | loss: 0.2707245
	speed: 0.1368s/iter; left time: 483.3732s
	iters: 1100, epoch: 8 | loss: 0.2748194
	speed: 0.1368s/iter; left time: 469.7374s
	iters: 1200, epoch: 8 | loss: 0.2134193
	speed: 0.1368s/iter; left time: 456.0214s
	iters: 1300, epoch: 8 | loss: 0.2404808
	speed: 0.1368s/iter; left time: 442.3268s
	iters: 1400, epoch: 8 | loss: 0.2188822
	speed: 0.1367s/iter; left time: 428.4832s
	iters: 1500, epoch: 8 | loss: 0.2734039
	speed: 0.1367s/iter; left time: 414.8062s
Epoch: 8 cost time: 206.82691144943237
Epoch: 8, Steps: 1511 | Train Loss: 0.2579057 Vali Loss: 0.4101320
Updating learning rate to 0.001463581497002704
Validation loss decreased (0.4128 --> 0.4101).  Saving model state dict ...
	iters: 100, epoch: 9 | loss: 0.2646560
	speed: 0.2855s/iter; left time: 834.4342s
	iters: 200, epoch: 9 | loss: 0.2249507
	speed: 0.1367s/iter; left time: 386.0418s
	iters: 300, epoch: 9 | loss: 0.2415216
	speed: 0.1368s/iter; left time: 372.5693s
	iters: 400, epoch: 9 | loss: 0.2233793
	speed: 0.1369s/iter; left time: 359.0187s
	iters: 500, epoch: 9 | loss: 0.2143334
	speed: 0.1369s/iter; left time: 345.4918s
	iters: 600, epoch: 9 | loss: 0.2887889
	speed: 0.1370s/iter; left time: 331.9133s
	iters: 700, epoch: 9 | loss: 0.2800425
	speed: 0.1370s/iter; left time: 318.1640s
	iters: 800, epoch: 9 | loss: 0.2854684
	speed: 0.1369s/iter; left time: 304.4122s
	iters: 900, epoch: 9 | loss: 0.1825619
	speed: 0.1369s/iter; left time: 290.5875s
	iters: 1000, epoch: 9 | loss: 0.2838140
	speed: 0.1369s/iter; left time: 276.8561s
	iters: 1100, epoch: 9 | loss: 0.2430136
	speed: 0.1368s/iter; left time: 263.1450s
	iters: 1200, epoch: 9 | loss: 0.2701262
	speed: 0.1368s/iter; left time: 249.4680s
	iters: 1300, epoch: 9 | loss: 0.1992475
	speed: 0.1368s/iter; left time: 235.7062s
	iters: 1400, epoch: 9 | loss: 0.2995574
	speed: 0.1367s/iter; left time: 221.9335s
	iters: 1500, epoch: 9 | loss: 0.2807881
	speed: 0.1367s/iter; left time: 208.2171s
Epoch: 9 cost time: 206.85566210746765
Epoch: 9, Steps: 1511 | Train Loss: 0.2512961 Vali Loss: 0.4074698
Updating learning rate to 0.00038014368834888977
Validation loss decreased (0.4101 --> 0.4075).  Saving model state dict ...
	iters: 100, epoch: 10 | loss: 0.2940629
	speed: 0.2861s/iter; left time: 403.9351s
	iters: 200, epoch: 10 | loss: 0.2626951
	speed: 0.1369s/iter; left time: 179.5714s
	iters: 300, epoch: 10 | loss: 0.2516889
	speed: 0.1370s/iter; left time: 166.0119s
	iters: 400, epoch: 10 | loss: 0.2403456
	speed: 0.1370s/iter; left time: 152.3699s
	iters: 500, epoch: 10 | loss: 0.2438671
	speed: 0.1371s/iter; left time: 138.7514s
	iters: 600, epoch: 10 | loss: 0.2348785
	speed: 0.1371s/iter; left time: 125.0487s
	iters: 700, epoch: 10 | loss: 0.2510534
	speed: 0.1370s/iter; left time: 111.2609s
	iters: 800, epoch: 10 | loss: 0.2770895
	speed: 0.1369s/iter; left time: 97.4943s
	iters: 900, epoch: 10 | loss: 0.2459265
	speed: 0.1369s/iter; left time: 83.7958s
	iters: 1000, epoch: 10 | loss: 0.2514969
	speed: 0.1368s/iter; left time: 70.0665s
	iters: 1100, epoch: 10 | loss: 0.2428577
	speed: 0.1369s/iter; left time: 56.3840s
	iters: 1200, epoch: 10 | loss: 0.2289649
	speed: 0.1368s/iter; left time: 42.6957s
	iters: 1300, epoch: 10 | loss: 0.2867365
	speed: 0.1368s/iter; left time: 29.0007s
	iters: 1400, epoch: 10 | loss: 0.2325323
	speed: 0.1368s/iter; left time: 15.3228s
	iters: 1500, epoch: 10 | loss: 0.2266976
	speed: 0.1367s/iter; left time: 1.6406s
Epoch: 10 cost time: 206.94995832443237
Epoch: 10, Steps: 1511 | Train Loss: 0.2477196 Vali Loss: 0.4046584
Updating learning rate to 4.016886090482786e-08
Validation loss decreased (0.4075 --> 0.4047).  Saving model state dict ...
#####   loading best weights   #####
Process: python3 (PID: 973489) is using 6486 MiB of GPU memory.
Epoch: 10 | Elapsed Time: 12117.159273386002 s | VRAM usage: 6.333984375 Gb | Train MSE: 0.2451 Train MAE: 0.2401 Vali MSE: 0.4045 Vali MAE: 0.2652 Test MSE: 0.4754 Test MAE: 0.2885



Args in experiment:
Namespace(task_name='long_term_forecast', model='TimeMixer', data='custom', root_path='./dataset/traffic/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=0, pred_len=192, seasonal_patterns='Monthly', inverse=False, top_k=5, num_kernels=6, enc_in=862, dec_in=862, c_out=862, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, mask_rate=0.25, anomaly_ratio=0.25, num_workers=10, itr=1, train_epochs=10, batch_size=8, patience=10, learning_rate=0.01, des='test', loss='MSE', lradj='TST', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', p_hidden_dims=[128, 128], p_hidden_layers=2, save_dir='./checkpoints/baseline/TimeMixer/traffic_96_192', save_last=False, break_at=0, seed=2021, delta=0.0)
Use GPU: cuda:0
########   Session 0   ########
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5363030
	speed: 0.1530s/iter; left time: 2278.6406s
	iters: 200, epoch: 1 | loss: 0.4853885
	speed: 0.1474s/iter; left time: 2179.4679s
	iters: 300, epoch: 1 | loss: 0.4100579
	speed: 0.1475s/iter; left time: 2166.6300s
	iters: 400, epoch: 1 | loss: 0.4049079
	speed: 0.1477s/iter; left time: 2154.5077s
	iters: 500, epoch: 1 | loss: 0.4029387
	speed: 0.1475s/iter; left time: 2137.9035s
	iters: 600, epoch: 1 | loss: 0.4112103
	speed: 0.1474s/iter; left time: 2121.7013s
	iters: 700, epoch: 1 | loss: 0.3428381
	speed: 0.1473s/iter; left time: 2104.4765s
	iters: 800, epoch: 1 | loss: 0.3113244
	speed: 0.1472s/iter; left time: 2088.3452s
	iters: 900, epoch: 1 | loss: 0.3788051
	speed: 0.1471s/iter; left time: 2072.2935s
	iters: 1000, epoch: 1 | loss: 0.3213677
	speed: 0.1471s/iter; left time: 2057.6316s
	iters: 1100, epoch: 1 | loss: 0.3612999
	speed: 0.1470s/iter; left time: 2042.6481s
	iters: 1200, epoch: 1 | loss: 0.3232291
	speed: 0.1470s/iter; left time: 2027.1351s
	iters: 1300, epoch: 1 | loss: 0.3099837
	speed: 0.1470s/iter; left time: 2012.5464s
	iters: 1400, epoch: 1 | loss: 0.3079272
	speed: 0.1469s/iter; left time: 1996.9332s
Epoch: 1 cost time: 221.0253140926361
Epoch: 1, Steps: 1499 | Train Loss: 0.4138177 Vali Loss: 0.4406172
Updating learning rate to 0.005202515789797601
Validation loss decreased (inf --> 0.4406).  Saving model state dict ...
	iters: 100, epoch: 2 | loss: 0.3133478
	speed: 0.4322s/iter; left time: 5788.4040s
	iters: 200, epoch: 2 | loss: 0.3335114
	speed: 0.1471s/iter; left time: 1955.1988s
	iters: 300, epoch: 2 | loss: 0.3002786
	speed: 0.1474s/iter; left time: 1943.9747s
	iters: 400, epoch: 2 | loss: 0.2870938
	speed: 0.1475s/iter; left time: 1930.5232s
	iters: 500, epoch: 2 | loss: 0.2874335
	speed: 0.1473s/iter; left time: 1914.1836s
	iters: 600, epoch: 2 | loss: 0.2754728
	speed: 0.1472s/iter; left time: 1897.4944s
	iters: 700, epoch: 2 | loss: 0.3372965
	speed: 0.1471s/iter; left time: 1881.9014s
	iters: 800, epoch: 2 | loss: 0.3092232
	speed: 0.1471s/iter; left time: 1866.8731s
	iters: 900, epoch: 2 | loss: 0.3444217
	speed: 0.1470s/iter; left time: 1851.4898s
	iters: 1000, epoch: 2 | loss: 0.3045887
	speed: 0.1471s/iter; left time: 1836.9675s
	iters: 1100, epoch: 2 | loss: 0.3632234
	speed: 0.1470s/iter; left time: 1821.2755s
	iters: 1200, epoch: 2 | loss: 0.3021700
	speed: 0.1470s/iter; left time: 1806.5153s
	iters: 1300, epoch: 2 | loss: 0.3223948
	speed: 0.1469s/iter; left time: 1791.4555s
	iters: 1400, epoch: 2 | loss: 0.3155961
	speed: 0.1470s/iter; left time: 1776.9407s
Epoch: 2 cost time: 220.59043264389038
Epoch: 2, Steps: 1499 | Train Loss: 0.3069759 Vali Loss: 0.4241455
Updating learning rate to 0.009999999828424698
Validation loss decreased (0.4406 --> 0.4241).  Saving model state dict ...
	iters: 100, epoch: 3 | loss: 0.2977640
	speed: 0.4322s/iter; left time: 5140.1759s
	iters: 200, epoch: 3 | loss: 0.2806917
	speed: 0.1471s/iter; left time: 1734.9798s
	iters: 300, epoch: 3 | loss: 0.3278714
	speed: 0.1473s/iter; left time: 1722.5100s
	iters: 400, epoch: 3 | loss: 0.2683405
	speed: 0.1474s/iter; left time: 1708.8740s
	iters: 500, epoch: 3 | loss: 0.3073938
	speed: 0.1473s/iter; left time: 1693.2981s
	iters: 600, epoch: 3 | loss: 0.2870159
	speed: 0.1472s/iter; left time: 1677.6179s
	iters: 700, epoch: 3 | loss: 0.2666769
	speed: 0.1472s/iter; left time: 1661.9958s
	iters: 800, epoch: 3 | loss: 0.2504971
	speed: 0.1471s/iter; left time: 1646.6078s
	iters: 900, epoch: 3 | loss: 0.3217204
	speed: 0.1471s/iter; left time: 1631.2918s
	iters: 1000, epoch: 3 | loss: 0.2733570
	speed: 0.1470s/iter; left time: 1615.9640s
	iters: 1100, epoch: 3 | loss: 0.2901585
	speed: 0.1470s/iter; left time: 1601.0310s
	iters: 1200, epoch: 3 | loss: 0.2984863
	speed: 0.1469s/iter; left time: 1586.0260s
	iters: 1300, epoch: 3 | loss: 0.2870934
	speed: 0.1469s/iter; left time: 1570.8064s
	iters: 1400, epoch: 3 | loss: 0.2668448
	speed: 0.1470s/iter; left time: 1556.8845s
Epoch: 3 cost time: 220.59320187568665
Epoch: 3, Steps: 1499 | Train Loss: 0.2915552 Vali Loss: 0.4133690
Updating learning rate to 0.00961889776284302
Validation loss decreased (0.4241 --> 0.4134).  Saving model state dict ...
	iters: 100, epoch: 4 | loss: 0.2333195
	speed: 0.4319s/iter; left time: 4489.1150s
	iters: 200, epoch: 4 | loss: 0.2974451
	speed: 0.1472s/iter; left time: 1515.3967s
	iters: 300, epoch: 4 | loss: 0.2871899
	speed: 0.1474s/iter; left time: 1502.3387s
	iters: 400, epoch: 4 | loss: 0.2742569
	speed: 0.1474s/iter; left time: 1487.6040s
	iters: 500, epoch: 4 | loss: 0.2941248
	speed: 0.1473s/iter; left time: 1471.6659s
	iters: 600, epoch: 4 | loss: 0.3031980
	speed: 0.1473s/iter; left time: 1457.4290s
	iters: 700, epoch: 4 | loss: 0.2954590
	speed: 0.1472s/iter; left time: 1441.5222s
	iters: 800, epoch: 4 | loss: 0.2740344
	speed: 0.1472s/iter; left time: 1426.7531s
	iters: 900, epoch: 4 | loss: 0.2935268
	speed: 0.1471s/iter; left time: 1410.9926s
	iters: 1000, epoch: 4 | loss: 0.3242825
	speed: 0.1471s/iter; left time: 1396.2743s
	iters: 1100, epoch: 4 | loss: 0.2783945
	speed: 0.1470s/iter; left time: 1380.6412s
	iters: 1200, epoch: 4 | loss: 0.3317802
	speed: 0.1470s/iter; left time: 1366.2363s
	iters: 1300, epoch: 4 | loss: 0.2872638
	speed: 0.1470s/iter; left time: 1351.5215s
	iters: 1400, epoch: 4 | loss: 0.2572333
	speed: 0.1470s/iter; left time: 1336.5550s
Epoch: 4 cost time: 220.6421353816986
Epoch: 4, Steps: 1499 | Train Loss: 0.2827940 Vali Loss: 0.4161238
Updating learning rate to 0.008534613428099677
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2612131
	speed: 0.4319s/iter; left time: 3842.0673s
	iters: 200, epoch: 5 | loss: 0.3028725
	speed: 0.1473s/iter; left time: 1295.5940s
	iters: 300, epoch: 5 | loss: 0.2636940
	speed: 0.1474s/iter; left time: 1281.9158s
	iters: 400, epoch: 5 | loss: 0.2711340
	speed: 0.1473s/iter; left time: 1266.4370s
	iters: 500, epoch: 5 | loss: 0.3122131
	speed: 0.1473s/iter; left time: 1250.9744s
	iters: 600, epoch: 5 | loss: 0.2757733
	speed: 0.1472s/iter; left time: 1235.6619s
	iters: 700, epoch: 5 | loss: 0.2636958
	speed: 0.1471s/iter; left time: 1220.1274s
	iters: 800, epoch: 5 | loss: 0.2753846
	speed: 0.1470s/iter; left time: 1204.9855s
	iters: 900, epoch: 5 | loss: 0.2952454
	speed: 0.1470s/iter; left time: 1190.2913s
	iters: 1000, epoch: 5 | loss: 0.2977534
	speed: 0.1470s/iter; left time: 1175.0622s
	iters: 1100, epoch: 5 | loss: 0.2617377
	speed: 0.1469s/iter; left time: 1160.1652s
	iters: 1200, epoch: 5 | loss: 0.3037629
	speed: 0.1469s/iter; left time: 1145.2930s
	iters: 1300, epoch: 5 | loss: 0.2774329
	speed: 0.1469s/iter; left time: 1130.4248s
	iters: 1400, epoch: 5 | loss: 0.3017986
	speed: 0.1470s/iter; left time: 1116.3853s
Epoch: 5 cost time: 220.5833034515381
Epoch: 5, Steps: 1499 | Train Loss: 0.2757130 Vali Loss: 0.4016429
Updating learning rate to 0.006912219285097373
Validation loss decreased (0.4134 --> 0.4016).  Saving model state dict ...
	iters: 100, epoch: 6 | loss: 0.3005981
	speed: 0.4318s/iter; left time: 3193.7482s
	iters: 200, epoch: 6 | loss: 0.2421891
	speed: 0.1473s/iter; left time: 1074.7962s
	iters: 300, epoch: 6 | loss: 0.2271535
	speed: 0.1474s/iter; left time: 1060.8145s
	iters: 400, epoch: 6 | loss: 0.2836061
	speed: 0.1474s/iter; left time: 1045.7075s
	iters: 500, epoch: 6 | loss: 0.2653509
	speed: 0.1473s/iter; left time: 1030.1700s
	iters: 600, epoch: 6 | loss: 0.3110879
	speed: 0.1472s/iter; left time: 1015.0176s
	iters: 700, epoch: 6 | loss: 0.3100824
	speed: 0.1471s/iter; left time: 999.9782s
	iters: 800, epoch: 6 | loss: 0.2232220
	speed: 0.1471s/iter; left time: 984.9238s
	iters: 900, epoch: 6 | loss: 0.2732487
	speed: 0.1470s/iter; left time: 969.6764s
	iters: 1000, epoch: 6 | loss: 0.2449428
	speed: 0.1470s/iter; left time: 954.8295s
	iters: 1100, epoch: 6 | loss: 0.2597957
	speed: 0.1469s/iter; left time: 939.8839s
	iters: 1200, epoch: 6 | loss: 0.2487577
	speed: 0.1470s/iter; left time: 925.2068s
	iters: 1300, epoch: 6 | loss: 0.2291346
	speed: 0.1470s/iter; left time: 910.6558s
	iters: 1400, epoch: 6 | loss: 0.2448188
	speed: 0.1470s/iter; left time: 895.9367s
Epoch: 6 cost time: 220.61028361320496
Epoch: 6, Steps: 1499 | Train Loss: 0.2684040 Vali Loss: 0.4000259
Updating learning rate to 0.0049987101350686776
Validation loss decreased (0.4016 --> 0.4000).  Saving model state dict ...
	iters: 100, epoch: 7 | loss: 0.2443707
	speed: 0.4325s/iter; left time: 2550.2541s
	iters: 200, epoch: 7 | loss: 0.2322894
	speed: 0.1473s/iter; left time: 854.0940s
	iters: 300, epoch: 7 | loss: 0.2339226
	speed: 0.1474s/iter; left time: 839.8436s
	iters: 400, epoch: 7 | loss: 0.2924235
	speed: 0.1474s/iter; left time: 824.9682s
	iters: 500, epoch: 7 | loss: 0.2273195
	speed: 0.1473s/iter; left time: 809.6415s
	iters: 600, epoch: 7 | loss: 0.2544445
	speed: 0.1472s/iter; left time: 794.4249s
	iters: 700, epoch: 7 | loss: 0.2754560
	speed: 0.1472s/iter; left time: 779.6838s
	iters: 800, epoch: 7 | loss: 0.2628665
	speed: 0.1470s/iter; left time: 764.1729s
	iters: 900, epoch: 7 | loss: 0.2306597
	speed: 0.1471s/iter; left time: 749.5548s
	iters: 1000, epoch: 7 | loss: 0.2704239
	speed: 0.1471s/iter; left time: 735.0037s
	iters: 1100, epoch: 7 | loss: 0.2871215
	speed: 0.1470s/iter; left time: 719.6621s
	iters: 1200, epoch: 7 | loss: 0.3149929
	speed: 0.1469s/iter; left time: 704.8546s
	iters: 1300, epoch: 7 | loss: 0.2829071
	speed: 0.1469s/iter; left time: 690.0278s
	iters: 1400, epoch: 7 | loss: 0.2426779
	speed: 0.1470s/iter; left time: 675.7700s
Epoch: 7 cost time: 220.6324384212494
Epoch: 7, Steps: 1499 | Train Loss: 0.2616694 Vali Loss: 0.3948144
Updating learning rate to 0.0030854004001018218
Validation loss decreased (0.4000 --> 0.3948).  Saving model state dict ...
	iters: 100, epoch: 8 | loss: 0.2491820
	speed: 0.4327s/iter; left time: 1902.9011s
	iters: 200, epoch: 8 | loss: 0.2156479
	speed: 0.1477s/iter; left time: 634.6984s
	iters: 300, epoch: 8 | loss: 0.3012992
	speed: 0.1477s/iter; left time: 619.9612s
	iters: 400, epoch: 8 | loss: 0.2537604
	speed: 0.1476s/iter; left time: 604.8628s
	iters: 500, epoch: 8 | loss: 0.2452724
	speed: 0.1474s/iter; left time: 589.4918s
	iters: 600, epoch: 8 | loss: 0.2536650
	speed: 0.1474s/iter; left time: 574.4589s
	iters: 700, epoch: 8 | loss: 0.3064231
	speed: 0.1473s/iter; left time: 559.5873s
	iters: 800, epoch: 8 | loss: 0.2694122
	speed: 0.1473s/iter; left time: 544.5898s
	iters: 900, epoch: 8 | loss: 0.2526788
	speed: 0.1472s/iter; left time: 529.6413s
	iters: 1000, epoch: 8 | loss: 0.2451347
	speed: 0.1472s/iter; left time: 515.0693s
	iters: 1100, epoch: 8 | loss: 0.2583333
	speed: 0.1472s/iter; left time: 500.1241s
	iters: 1200, epoch: 8 | loss: 0.2957709
	speed: 0.1472s/iter; left time: 485.4825s
	iters: 1300, epoch: 8 | loss: 0.2610530
	speed: 0.1472s/iter; left time: 470.7882s
	iters: 1400, epoch: 8 | loss: 0.2700989
	speed: 0.1472s/iter; left time: 456.1474s
Epoch: 8 cost time: 220.96489071846008
Epoch: 8, Steps: 1499 | Train Loss: 0.2547526 Vali Loss: 0.3976858
Updating learning rate to 0.00146357414314957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2408463
	speed: 0.4322s/iter; left time: 1253.0543s
	iters: 200, epoch: 9 | loss: 0.2573441
	speed: 0.1475s/iter; left time: 412.7642s
	iters: 300, epoch: 9 | loss: 0.2676479
	speed: 0.1475s/iter; left time: 398.0921s
	iters: 400, epoch: 9 | loss: 0.2384084
	speed: 0.1476s/iter; left time: 383.5167s
	iters: 500, epoch: 9 | loss: 0.2603677
	speed: 0.1474s/iter; left time: 368.3360s
	iters: 600, epoch: 9 | loss: 0.2819757
	speed: 0.1473s/iter; left time: 353.4020s
	iters: 700, epoch: 9 | loss: 0.2717816
	speed: 0.1472s/iter; left time: 338.5111s
	iters: 800, epoch: 9 | loss: 0.2073046
	speed: 0.1472s/iter; left time: 323.6301s
	iters: 900, epoch: 9 | loss: 0.2176767
	speed: 0.1471s/iter; left time: 308.6889s
	iters: 1000, epoch: 9 | loss: 0.2680727
	speed: 0.1471s/iter; left time: 294.0003s
	iters: 1100, epoch: 9 | loss: 0.2478414
	speed: 0.1471s/iter; left time: 279.2737s
	iters: 1200, epoch: 9 | loss: 0.2520854
	speed: 0.1470s/iter; left time: 264.4799s
	iters: 1300, epoch: 9 | loss: 0.2548012
	speed: 0.1470s/iter; left time: 249.7728s
	iters: 1400, epoch: 9 | loss: 0.2011488
	speed: 0.1470s/iter; left time: 235.0109s
Epoch: 9 cost time: 220.7355170249939
Epoch: 9, Steps: 1499 | Train Loss: 0.2493043 Vali Loss: 0.3929946
Updating learning rate to 0.000380139709941274
Validation loss decreased (0.3948 --> 0.3930).  Saving model state dict ...
	iters: 100, epoch: 10 | loss: 0.2459879
	speed: 0.4320s/iter; left time: 604.7822s
	iters: 200, epoch: 10 | loss: 0.2382400
	speed: 0.1473s/iter; left time: 191.4749s
	iters: 300, epoch: 10 | loss: 0.2508767
	speed: 0.1474s/iter; left time: 176.8730s
	iters: 400, epoch: 10 | loss: 0.2499941
	speed: 0.1474s/iter; left time: 162.1608s
	iters: 500, epoch: 10 | loss: 0.2796656
	speed: 0.1473s/iter; left time: 147.2964s
	iters: 600, epoch: 10 | loss: 0.2355709
	speed: 0.1473s/iter; left time: 132.5361s
	iters: 700, epoch: 10 | loss: 0.2499259
	speed: 0.1472s/iter; left time: 117.7243s
	iters: 800, epoch: 10 | loss: 0.2469027
	speed: 0.1470s/iter; left time: 102.9123s
	iters: 900, epoch: 10 | loss: 0.2503491
	speed: 0.1470s/iter; left time: 88.1856s
	iters: 1000, epoch: 10 | loss: 0.2526847
	speed: 0.1469s/iter; left time: 73.4550s
	iters: 1100, epoch: 10 | loss: 0.2333666
	speed: 0.1469s/iter; left time: 58.7514s
	iters: 1200, epoch: 10 | loss: 0.2604693
	speed: 0.1470s/iter; left time: 44.0858s
	iters: 1300, epoch: 10 | loss: 0.2125494
	speed: 0.1469s/iter; left time: 29.3737s
	iters: 1400, epoch: 10 | loss: 0.2544069
	speed: 0.1469s/iter; left time: 14.6878s
Epoch: 10 cost time: 220.56151747703552
Epoch: 10, Steps: 1499 | Train Loss: 0.2463637 Vali Loss: 0.3940977
Updating learning rate to 4.017157530322315e-08
EarlyStopping counter: 1 out of 10
#####   loading best weights   #####
Process: python3 (PID: 984159) is using 7134 MiB of GPU memory.
Epoch: 10 | Elapsed Time: 12901.682838201523 s | VRAM usage: 6.966796875 Gb | Train MSE: 0.2461 Train MAE: 0.2408 Vali MSE: 0.3929 Vali MAE: 0.2601 Test MSE: 0.4707 Test MAE: 0.2921



Args in experiment:
Namespace(task_name='long_term_forecast', model='TimeMixer', data='custom', root_path='./dataset/traffic/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=0, pred_len=336, seasonal_patterns='Monthly', inverse=False, top_k=5, num_kernels=6, enc_in=862, dec_in=862, c_out=862, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, mask_rate=0.25, anomaly_ratio=0.25, num_workers=10, itr=1, train_epochs=10, batch_size=8, patience=10, learning_rate=0.01, des='test', loss='MSE', lradj='TST', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', p_hidden_dims=[128, 128], p_hidden_layers=2, save_dir='./checkpoints/baseline/TimeMixer/traffic_96_336', save_last=False, break_at=0, seed=2021, delta=0.0)
Use GPU: cuda:0
########   Session 0   ########
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5884225
	speed: 0.1627s/iter; left time: 2393.5739s
	iters: 200, epoch: 1 | loss: 0.4886453
	speed: 0.1569s/iter; left time: 2292.3169s
	iters: 300, epoch: 1 | loss: 0.4366116
	speed: 0.1572s/iter; left time: 2281.2350s
	iters: 400, epoch: 1 | loss: 0.4197351
	speed: 0.1574s/iter; left time: 2268.4428s
	iters: 500, epoch: 1 | loss: 0.3999344
	speed: 0.1572s/iter; left time: 2250.2211s
	iters: 600, epoch: 1 | loss: 0.3684431
	speed: 0.1572s/iter; left time: 2233.7414s
	iters: 700, epoch: 1 | loss: 0.3710084
	speed: 0.1570s/iter; left time: 2215.7402s
	iters: 800, epoch: 1 | loss: 0.3165509
	speed: 0.1570s/iter; left time: 2199.6948s
	iters: 900, epoch: 1 | loss: 0.3661258
	speed: 0.1570s/iter; left time: 2183.4409s
	iters: 1000, epoch: 1 | loss: 0.3666165
	speed: 0.1568s/iter; left time: 2166.0187s
	iters: 1100, epoch: 1 | loss: 0.3260443
	speed: 0.1567s/iter; left time: 2149.0936s
	iters: 1200, epoch: 1 | loss: 0.3125246
	speed: 0.1567s/iter; left time: 2132.8551s
	iters: 1300, epoch: 1 | loss: 0.3241537
	speed: 0.1566s/iter; left time: 2116.4446s
	iters: 1400, epoch: 1 | loss: 0.3418442
	speed: 0.1566s/iter; left time: 2100.7825s
Epoch: 1 cost time: 232.7822835445404
Epoch: 1, Steps: 1481 | Train Loss: 0.4222230 Vali Loss: 0.4500602
Updating learning rate to 0.005202546376904749
Validation loss decreased (inf --> 0.4501).  Saving model state dict ...
	iters: 100, epoch: 2 | loss: 0.3178040
	speed: 0.4171s/iter; left time: 5517.9943s
	iters: 200, epoch: 2 | loss: 0.3190098
	speed: 0.1568s/iter; left time: 2058.9596s
	iters: 300, epoch: 2 | loss: 0.3099036
	speed: 0.1570s/iter; left time: 2045.1875s
	iters: 400, epoch: 2 | loss: 0.3161499
	speed: 0.1571s/iter; left time: 2031.4523s
	iters: 500, epoch: 2 | loss: 0.3014639
	speed: 0.1570s/iter; left time: 2014.3569s
	iters: 600, epoch: 2 | loss: 0.2906921
	speed: 0.1569s/iter; left time: 1997.9325s
	iters: 700, epoch: 2 | loss: 0.3351437
	speed: 0.1569s/iter; left time: 1981.3520s
	iters: 800, epoch: 2 | loss: 0.3230984
	speed: 0.1569s/iter; left time: 1965.8720s
	iters: 900, epoch: 2 | loss: 0.2894235
	speed: 0.1568s/iter; left time: 1949.2570s
	iters: 1000, epoch: 2 | loss: 0.3034229
	speed: 0.1568s/iter; left time: 1932.8112s
	iters: 1100, epoch: 2 | loss: 0.3099117
	speed: 0.1567s/iter; left time: 1916.9815s
	iters: 1200, epoch: 2 | loss: 0.3258534
	speed: 0.1567s/iter; left time: 1900.9927s
	iters: 1300, epoch: 2 | loss: 0.3122840
	speed: 0.1567s/iter; left time: 1884.8820s
	iters: 1400, epoch: 2 | loss: 0.3228242
	speed: 0.1568s/iter; left time: 1870.4504s
Epoch: 2 cost time: 232.3571171760559
Epoch: 2, Steps: 1481 | Train Loss: 0.3168321 Vali Loss: 0.4305833
Updating learning rate to 0.009999999824228717
Validation loss decreased (0.4501 --> 0.4306).  Saving model state dict ...
	iters: 100, epoch: 3 | loss: 0.3269487
	speed: 0.4184s/iter; left time: 4915.6581s
	iters: 200, epoch: 3 | loss: 0.2789867
	speed: 0.1574s/iter; left time: 1833.0532s
	iters: 300, epoch: 3 | loss: 0.2690577
	speed: 0.1574s/iter; left time: 1817.7936s
	iters: 400, epoch: 3 | loss: 0.3085126
	speed: 0.1574s/iter; left time: 1801.7187s
	iters: 500, epoch: 3 | loss: 0.3201223
	speed: 0.1572s/iter; left time: 1784.6187s
	iters: 600, epoch: 3 | loss: 0.2754724
	speed: 0.1572s/iter; left time: 1768.1554s
	iters: 700, epoch: 3 | loss: 0.3088147
	speed: 0.1571s/iter; left time: 1751.4370s
	iters: 800, epoch: 3 | loss: 0.2728988
	speed: 0.1571s/iter; left time: 1735.8442s
	iters: 900, epoch: 3 | loss: 0.3367391
	speed: 0.1570s/iter; left time: 1718.5322s
	iters: 1000, epoch: 3 | loss: 0.2823349
	speed: 0.1570s/iter; left time: 1702.8720s
	iters: 1100, epoch: 3 | loss: 0.2984464
	speed: 0.1570s/iter; left time: 1688.0776s
	iters: 1200, epoch: 3 | loss: 0.3314476
	speed: 0.1570s/iter; left time: 1671.9504s
	iters: 1300, epoch: 3 | loss: 0.2861789
	speed: 0.1570s/iter; left time: 1656.0061s
	iters: 1400, epoch: 3 | loss: 0.3034920
	speed: 0.1571s/iter; left time: 1641.2369s
Epoch: 3 cost time: 232.7825300693512
Epoch: 3, Steps: 1481 | Train Loss: 0.3045418 Vali Loss: 0.4338801
Updating learning rate to 0.009618891666633737
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3094959
	speed: 0.4181s/iter; left time: 4293.3984s
	iters: 200, epoch: 4 | loss: 0.3057341
	speed: 0.1573s/iter; left time: 1599.2294s
	iters: 300, epoch: 4 | loss: 0.3167998
	speed: 0.1573s/iter; left time: 1583.5633s
	iters: 400, epoch: 4 | loss: 0.2819108
	speed: 0.1587s/iter; left time: 1581.9172s
	iters: 500, epoch: 4 | loss: 0.3053990
	speed: 0.1601s/iter; left time: 1580.2292s
	iters: 600, epoch: 4 | loss: 0.3024678
	speed: 0.1571s/iter; left time: 1534.6800s
	iters: 700, epoch: 4 | loss: 0.2674351
	speed: 0.1572s/iter; left time: 1519.4390s
	iters: 800, epoch: 4 | loss: 0.3002206
	speed: 0.1572s/iter; left time: 1504.0038s
	iters: 900, epoch: 4 | loss: 0.2874992
	speed: 0.1570s/iter; left time: 1486.2809s
	iters: 1000, epoch: 4 | loss: 0.3091055
	speed: 0.1570s/iter; left time: 1470.4874s
	iters: 1100, epoch: 4 | loss: 0.2753414
	speed: 0.1570s/iter; left time: 1454.9359s
	iters: 1200, epoch: 4 | loss: 0.3067165
	speed: 0.1570s/iter; left time: 1439.4818s
	iters: 1300, epoch: 4 | loss: 0.2982259
	speed: 0.1570s/iter; left time: 1423.6790s
	iters: 1400, epoch: 4 | loss: 0.2678075
	speed: 0.1570s/iter; left time: 1407.9899s
Epoch: 4 cost time: 233.184632062912
Epoch: 4, Steps: 1481 | Train Loss: 0.2979364 Vali Loss: 0.4235987
Updating learning rate to 0.008534602167969694
Validation loss decreased (0.4306 --> 0.4236).  Saving model state dict ...
	iters: 100, epoch: 5 | loss: 0.2961776
	speed: 0.4178s/iter; left time: 3671.4548s
	iters: 200, epoch: 5 | loss: 0.2775133
	speed: 0.1572s/iter; left time: 1365.5673s
	iters: 300, epoch: 5 | loss: 0.2917265
	speed: 0.1572s/iter; left time: 1349.7489s
	iters: 400, epoch: 5 | loss: 0.2675631
	speed: 0.1572s/iter; left time: 1334.5308s
	iters: 500, epoch: 5 | loss: 0.3562981
	speed: 0.1572s/iter; left time: 1318.4195s
	iters: 600, epoch: 5 | loss: 0.3044422
	speed: 0.1573s/iter; left time: 1303.3744s
	iters: 700, epoch: 5 | loss: 0.2769106
	speed: 0.1571s/iter; left time: 1286.4748s
	iters: 800, epoch: 5 | loss: 0.2734974
	speed: 0.1572s/iter; left time: 1271.0599s
	iters: 900, epoch: 5 | loss: 0.2942257
	speed: 0.1571s/iter; left time: 1254.8519s
	iters: 1000, epoch: 5 | loss: 0.2996282
	speed: 0.1570s/iter; left time: 1238.6339s
	iters: 1100, epoch: 5 | loss: 0.2917606
	speed: 0.1572s/iter; left time: 1223.8534s
	iters: 1200, epoch: 5 | loss: 0.2726389
	speed: 0.1572s/iter; left time: 1208.0364s
	iters: 1300, epoch: 5 | loss: 0.2677109
	speed: 0.1571s/iter; left time: 1191.6422s
	iters: 1400, epoch: 5 | loss: 0.2763629
	speed: 0.1627s/iter; left time: 1217.7911s
Epoch: 5 cost time: 233.7409541606903
Epoch: 5, Steps: 1481 | Train Loss: 0.2914129 Vali Loss: 0.4236420
Updating learning rate to 0.006912204575299406
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3102504
	speed: 0.4332s/iter; left time: 3164.7271s
	iters: 200, epoch: 6 | loss: 0.2861320
	speed: 0.1593s/iter; left time: 1147.6847s
	iters: 300, epoch: 6 | loss: 0.2758777
	speed: 0.1653s/iter; left time: 1174.7673s
	iters: 400, epoch: 6 | loss: 0.2979767
	speed: 0.1628s/iter; left time: 1140.8835s
	iters: 500, epoch: 6 | loss: 0.2833071
	speed: 0.1577s/iter; left time: 1089.2520s
	iters: 600, epoch: 6 | loss: 0.2737425
	speed: 0.1593s/iter; left time: 1084.1255s
	iters: 700, epoch: 6 | loss: 0.2906035
	speed: 0.1599s/iter; left time: 1071.9647s
	iters: 800, epoch: 6 | loss: 0.2871532
	speed: 0.1575s/iter; left time: 1040.7124s
	iters: 900, epoch: 6 | loss: 0.2678143
	speed: 0.1608s/iter; left time: 1046.1051s
	iters: 1000, epoch: 6 | loss: 0.2597474
	speed: 0.1618s/iter; left time: 1036.3416s
	iters: 1100, epoch: 6 | loss: 0.2479811
	speed: 0.1596s/iter; left time: 1006.4691s
	iters: 1200, epoch: 6 | loss: 0.2862748
	speed: 0.1601s/iter; left time: 993.7513s
	iters: 1300, epoch: 6 | loss: 0.2738148
	speed: 0.1612s/iter; left time: 984.3732s
	iters: 1400, epoch: 6 | loss: 0.3356044
	speed: 0.1580s/iter; left time: 949.1993s
Epoch: 6 cost time: 237.65838623046875
Epoch: 6, Steps: 1481 | Train Loss: 0.2846317 Vali Loss: 0.4225493
Updating learning rate to 0.004998694215036122
Validation loss decreased (0.4236 --> 0.4225).  Saving model state dict ...
	iters: 100, epoch: 7 | loss: 0.2650376
	speed: 0.4232s/iter; left time: 2464.9816s
	iters: 200, epoch: 7 | loss: 0.3046508
	speed: 0.1613s/iter; left time: 923.2181s
	iters: 300, epoch: 7 | loss: 0.2771978
	speed: 0.1608s/iter; left time: 904.5270s
	iters: 400, epoch: 7 | loss: 0.3011932
	speed: 0.1578s/iter; left time: 872.1123s
	iters: 500, epoch: 7 | loss: 0.2805191
	speed: 0.1577s/iter; left time: 855.7046s
	iters: 600, epoch: 7 | loss: 0.2691374
	speed: 0.1606s/iter; left time: 855.4174s
	iters: 700, epoch: 7 | loss: 0.2581704
	speed: 0.1611s/iter; left time: 841.5480s
	iters: 800, epoch: 7 | loss: 0.2663549
	speed: 0.1606s/iter; left time: 823.3112s
	iters: 900, epoch: 7 | loss: 0.2894554
	speed: 0.1596s/iter; left time: 801.8891s
	iters: 1000, epoch: 7 | loss: 0.2896785
	speed: 0.1606s/iter; left time: 790.7878s
	iters: 1100, epoch: 7 | loss: 0.2674845
	speed: 0.1610s/iter; left time: 776.7295s
	iters: 1200, epoch: 7 | loss: 0.3162726
	speed: 0.1601s/iter; left time: 756.5658s
	iters: 1300, epoch: 7 | loss: 0.2689795
	speed: 0.1640s/iter; left time: 758.7038s
	iters: 1400, epoch: 7 | loss: 0.2762013
	speed: 0.1591s/iter; left time: 719.8665s
Epoch: 7 cost time: 237.43463230133057
Epoch: 7, Steps: 1481 | Train Loss: 0.2778898 Vali Loss: 0.4231487
Updating learning rate to 0.003085385693515319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2504708
	speed: 0.4263s/iter; left time: 1851.6627s
	iters: 200, epoch: 8 | loss: 0.2482459
	speed: 0.1608s/iter; left time: 682.2443s
	iters: 300, epoch: 8 | loss: 0.2848845
	speed: 0.1604s/iter; left time: 664.8401s
	iters: 400, epoch: 8 | loss: 0.2744063
	speed: 0.1607s/iter; left time: 649.8583s
	iters: 500, epoch: 8 | loss: 0.2445648
	speed: 0.1621s/iter; left time: 639.3488s
	iters: 600, epoch: 8 | loss: 0.2895131
	speed: 0.1637s/iter; left time: 629.2504s
	iters: 700, epoch: 8 | loss: 0.2735828
	speed: 0.1600s/iter; left time: 598.9605s
	iters: 800, epoch: 8 | loss: 0.2739476
	speed: 0.1609s/iter; left time: 586.4778s
	iters: 900, epoch: 8 | loss: 0.2611765
	speed: 0.1621s/iter; left time: 574.3509s
	iters: 1000, epoch: 8 | loss: 0.2665725
	speed: 0.1613s/iter; left time: 555.4923s
	iters: 1100, epoch: 8 | loss: 0.2589328
	speed: 0.1601s/iter; left time: 535.2776s
	iters: 1200, epoch: 8 | loss: 0.2435249
	speed: 0.1596s/iter; left time: 517.6173s
	iters: 1300, epoch: 8 | loss: 0.3049940
	speed: 0.1614s/iter; left time: 507.5410s
	iters: 1400, epoch: 8 | loss: 0.2655350
	speed: 0.1608s/iter; left time: 489.3269s
Epoch: 8 cost time: 238.63337182998657
Epoch: 8, Steps: 1481 | Train Loss: 0.2710658 Vali Loss: 0.4195072
Updating learning rate to 0.001463562888953599
Validation loss decreased (0.4225 --> 0.4195).  Saving model state dict ...
	iters: 100, epoch: 9 | loss: 0.2589262
	speed: 0.4383s/iter; left time: 1254.7680s
	iters: 200, epoch: 9 | loss: 0.2648881
	speed: 0.1610s/iter; left time: 444.8631s
	iters: 300, epoch: 9 | loss: 0.2725268
	speed: 0.1622s/iter; left time: 432.0605s
	iters: 400, epoch: 9 | loss: 0.2505915
	speed: 0.1618s/iter; left time: 414.7456s
	iters: 500, epoch: 9 | loss: 0.2610283
	speed: 0.1598s/iter; left time: 393.6289s
	iters: 600, epoch: 9 | loss: 0.2698627
	speed: 0.1624s/iter; left time: 383.7938s
	iters: 700, epoch: 9 | loss: 0.2743762
	speed: 0.1606s/iter; left time: 363.5328s
	iters: 800, epoch: 9 | loss: 0.2493777
	speed: 0.1620s/iter; left time: 350.3786s
	iters: 900, epoch: 9 | loss: 0.2631376
	speed: 0.1624s/iter; left time: 335.0690s
	iters: 1000, epoch: 9 | loss: 0.2421544
	speed: 0.1629s/iter; left time: 319.8312s
	iters: 1100, epoch: 9 | loss: 0.2511021
	speed: 0.1631s/iter; left time: 303.8735s
	iters: 1200, epoch: 9 | loss: 0.2434140
	speed: 0.1603s/iter; left time: 282.5563s
	iters: 1300, epoch: 9 | loss: 0.2543460
	speed: 0.1576s/iter; left time: 262.1135s
	iters: 1400, epoch: 9 | loss: 0.2692772
	speed: 0.1617s/iter; left time: 252.7106s
Epoch: 9 cost time: 239.40470051765442
Epoch: 9, Steps: 1481 | Train Loss: 0.2661989 Vali Loss: 0.4109699
Updating learning rate to 0.00038013362148515257
Validation loss decreased (0.4195 --> 0.4110).  Saving model state dict ...
	iters: 100, epoch: 10 | loss: 0.2564844
	speed: 0.4333s/iter; left time: 598.8191s
	iters: 200, epoch: 10 | loss: 0.2906465
	speed: 0.1613s/iter; left time: 206.8361s
	iters: 300, epoch: 10 | loss: 0.2690534
	speed: 0.1622s/iter; left time: 191.7456s
	iters: 400, epoch: 10 | loss: 0.2714484
	speed: 0.1576s/iter; left time: 170.5333s
	iters: 500, epoch: 10 | loss: 0.2373230
	speed: 0.1581s/iter; left time: 155.2241s
	iters: 600, epoch: 10 | loss: 0.2651481
	speed: 0.1603s/iter; left time: 141.4234s
	iters: 700, epoch: 10 | loss: 0.2602793
	speed: 0.1620s/iter; left time: 126.6936s
	iters: 800, epoch: 10 | loss: 0.2651086
	speed: 0.1614s/iter; left time: 110.0601s
	iters: 900, epoch: 10 | loss: 0.2468423
	speed: 0.1582s/iter; left time: 92.0803s
	iters: 1000, epoch: 10 | loss: 0.3071669
	speed: 0.1620s/iter; left time: 78.0973s
	iters: 1100, epoch: 10 | loss: 0.2291849
	speed: 0.1583s/iter; left time: 60.4689s
	iters: 1200, epoch: 10 | loss: 0.2628525
	speed: 0.1600s/iter; left time: 45.1194s
	iters: 1300, epoch: 10 | loss: 0.3038704
	speed: 0.1604s/iter; left time: 29.1842s
	iters: 1400, epoch: 10 | loss: 0.3027637
	speed: 0.1598s/iter; left time: 13.1007s
Epoch: 10 cost time: 237.31830191612244
Epoch: 10, Steps: 1481 | Train Loss: 0.2632638 Vali Loss: 0.4109661
Updating learning rate to 4.017577128332245e-08
Validation loss decreased (0.4110 --> 0.4110).  Saving model state dict ...
#####   loading best weights   #####
Args in experiment:
Namespace(task_name='long_term_forecast', model='TimeMixer', data='custom', root_path='./dataset/traffic/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=0, pred_len=720, seasonal_patterns='Monthly', inverse=False, top_k=5, num_kernels=6, enc_in=862, dec_in=862, c_out=862, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, mask_rate=0.25, anomaly_ratio=0.25, num_workers=10, itr=1, train_epochs=10, batch_size=8, patience=10, learning_rate=0.01, des='test', loss='MSE', lradj='TST', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', p_hidden_dims=[128, 128], p_hidden_layers=2, save_dir='./checkpoints/baseline/TimeMixer/traffic_96_720', save_last=False, break_at=0, seed=2021, delta=0.0)
Use GPU: cuda:0
########   Session 0   ########
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.6515191
	speed: 0.1939s/iter; left time: 2759.2532s
	iters: 200, epoch: 1 | loss: 0.5286157
	speed: 0.1872s/iter; left time: 2645.6002s
	iters: 300, epoch: 1 | loss: 0.4890417
	speed: 0.1891s/iter; left time: 2652.8554s
	iters: 400, epoch: 1 | loss: 0.4855830
	speed: 0.1867s/iter; left time: 2601.4932s
	iters: 500, epoch: 1 | loss: 0.4450186
	speed: 0.1822s/iter; left time: 2520.3355s
