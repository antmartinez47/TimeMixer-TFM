Args in experiment:
Namespace(model='TimeMixer', task_name='long_term_forecast', seed=2021, data='ETTh2', root_path='./dataset/ETT-small/', data_path='ETTh2.csv', features='M', target='OT', freq='h', train_prop=1.0, seq_len=96, label_len=0, pred_len=96, seasonal_patterns='Monthly', inverse=False, enc_in=7, dec_in=7, c_out=7, decomp_method='moving_avg', top_k=5, moving_avg=25, d_model=16, d_ff=32, e_layers=2, dropout=0.1, embed='timeF', channel_independence=1, use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, output_attention=False, num_workers=4, train_epochs=10, batch_size=16, patience=10, delta=0.0, learning_rate=0.01, des='test', loss='MSE', lradj='type1', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_dir='./checkpoints/baseline/reproduction/ETTh2_96_96', save_last=False, break_at=0)
Use GPU: cuda:0
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3426803
	speed: 0.0142s/iter; left time: 73.6894s
	iters: 200, epoch: 1 | loss: 0.5617868
	speed: 0.0085s/iter; left time: 43.2501s
	iters: 300, epoch: 1 | loss: 0.8583422
	speed: 0.0084s/iter; left time: 41.7449s
	iters: 400, epoch: 1 | loss: 0.2924360
	speed: 0.0084s/iter; left time: 40.9907s
	iters: 500, epoch: 1 | loss: 0.1789550
	speed: 0.0084s/iter; left time: 40.2521s
Epoch: 1 cost time: 4.787532091140747
Epoch: 1, Steps: 528 | Train Loss: 0.4539751 Vali Loss: 0.2150600
Updating learning rate to 0.01
Validation loss decreased (inf --> 0.2151).  Saving model state dict ...
	iters: 100, epoch: 2 | loss: 0.1661093
	speed: 0.0166s/iter; left time: 77.2442s
	iters: 200, epoch: 2 | loss: 0.6726905
	speed: 0.0077s/iter; left time: 35.2649s
	iters: 300, epoch: 2 | loss: 0.1831425
	speed: 0.0078s/iter; left time: 34.7301s
	iters: 400, epoch: 2 | loss: 0.1670028
	speed: 0.0078s/iter; left time: 33.8716s
	iters: 500, epoch: 2 | loss: 0.2939374
	speed: 0.0078s/iter; left time: 32.9621s
Epoch: 2 cost time: 4.213101148605347
Epoch: 2, Steps: 528 | Train Loss: 0.4331207 Vali Loss: 0.2149162
Updating learning rate to 0.005
Validation loss decreased (0.2151 --> 0.2149).  Saving model state dict ...
	iters: 100, epoch: 3 | loss: 0.4260164
	speed: 0.0168s/iter; left time: 69.2086s
	iters: 200, epoch: 3 | loss: 0.3702596
	speed: 0.0078s/iter; left time: 31.5483s
	iters: 300, epoch: 3 | loss: 0.2031445
	speed: 0.0078s/iter; left time: 30.7446s
	iters: 400, epoch: 3 | loss: 0.1998191
	speed: 0.0079s/iter; left time: 30.0978s
	iters: 500, epoch: 3 | loss: 0.1986217
	speed: 0.0079s/iter; left time: 29.3249s
Epoch: 3 cost time: 4.222433090209961
Epoch: 3, Steps: 528 | Train Loss: 0.4041468 Vali Loss: 0.2180188
Updating learning rate to 0.0025
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7593970
	speed: 0.0172s/iter; left time: 62.0322s
	iters: 200, epoch: 4 | loss: 0.4222338
	speed: 0.0085s/iter; left time: 29.8804s
	iters: 300, epoch: 4 | loss: 0.5141813
	speed: 0.0085s/iter; left time: 28.7161s
	iters: 400, epoch: 4 | loss: 0.3645232
	speed: 0.0085s/iter; left time: 27.8811s
	iters: 500, epoch: 4 | loss: 0.4556556
	speed: 0.0085s/iter; left time: 27.0982s
Epoch: 4 cost time: 4.565207004547119
Epoch: 4, Steps: 528 | Train Loss: 0.3763598 Vali Loss: 0.2189844
Updating learning rate to 0.00125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3146728
	speed: 0.0174s/iter; left time: 53.3767s
	iters: 200, epoch: 5 | loss: 0.1506427
	speed: 0.0085s/iter; left time: 25.3548s
	iters: 300, epoch: 5 | loss: 0.5137863
	speed: 0.0085s/iter; left time: 24.5277s
	iters: 400, epoch: 5 | loss: 0.2136312
	speed: 0.0085s/iter; left time: 23.6671s
	iters: 500, epoch: 5 | loss: 0.5034079
	speed: 0.0085s/iter; left time: 22.6287s
Epoch: 5 cost time: 4.576756477355957
Epoch: 5, Steps: 528 | Train Loss: 0.3418889 Vali Loss: 0.2298249
Updating learning rate to 0.000625
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2184557
	speed: 0.0165s/iter; left time: 41.9226s
	iters: 200, epoch: 6 | loss: 0.4028522
	speed: 0.0077s/iter; left time: 18.6933s
	iters: 300, epoch: 6 | loss: 0.2715769
	speed: 0.0077s/iter; left time: 18.0178s
	iters: 400, epoch: 6 | loss: 0.6001613
	speed: 0.0077s/iter; left time: 17.2094s
	iters: 500, epoch: 6 | loss: 0.2976203
	speed: 0.0079s/iter; left time: 16.9128s
Epoch: 6 cost time: 4.161515474319458
Epoch: 6, Steps: 528 | Train Loss: 0.3203426 Vali Loss: 0.2251980
Updating learning rate to 0.0003125
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.5134507
	speed: 0.0172s/iter; left time: 34.7112s
	iters: 200, epoch: 7 | loss: 0.1979229
	speed: 0.0085s/iter; left time: 16.3384s
	iters: 300, epoch: 7 | loss: 0.1568113
	speed: 0.0085s/iter; left time: 15.4246s
	iters: 400, epoch: 7 | loss: 0.3665759
	speed: 0.0085s/iter; left time: 14.6033s
	iters: 500, epoch: 7 | loss: 0.2829686
	speed: 0.0085s/iter; left time: 13.7759s
Epoch: 7 cost time: 4.577043533325195
Epoch: 7, Steps: 528 | Train Loss: 0.3078882 Vali Loss: 0.2268263
Updating learning rate to 0.00015625
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.2530359
	speed: 0.0172s/iter; left time: 25.4879s
	iters: 200, epoch: 8 | loss: 0.3890049
	speed: 0.0085s/iter; left time: 11.7283s
	iters: 300, epoch: 8 | loss: 0.1747721
	speed: 0.0085s/iter; left time: 10.8930s
	iters: 400, epoch: 8 | loss: 0.6464539
	speed: 0.0082s/iter; left time: 9.6875s
	iters: 500, epoch: 8 | loss: 0.3062052
	speed: 0.0077s/iter; left time: 8.3918s
Epoch: 8 cost time: 4.432757377624512
Epoch: 8, Steps: 528 | Train Loss: 0.3019789 Vali Loss: 0.2319596
Updating learning rate to 7.8125e-05
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.2390708
	speed: 0.0165s/iter; left time: 15.8278s
	iters: 200, epoch: 9 | loss: 0.2175412
	speed: 0.0077s/iter; left time: 6.6311s
	iters: 300, epoch: 9 | loss: 0.3256620
	speed: 0.0080s/iter; left time: 6.0446s
	iters: 400, epoch: 9 | loss: 0.2589651
	speed: 0.0083s/iter; left time: 5.4715s
	iters: 500, epoch: 9 | loss: 0.4052546
	speed: 0.0083s/iter; left time: 4.6439s
Epoch: 9 cost time: 4.336995840072632
Epoch: 9, Steps: 528 | Train Loss: 0.2989158 Vali Loss: 0.2307899
Updating learning rate to 3.90625e-05
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2366436
	speed: 0.0175s/iter; left time: 7.4986s
	iters: 200, epoch: 10 | loss: 0.3881669
	speed: 0.0085s/iter; left time: 2.7991s
	iters: 300, epoch: 10 | loss: 0.3320693
	speed: 0.0085s/iter; left time: 1.9562s
	iters: 400, epoch: 10 | loss: 0.6306551
	speed: 0.0085s/iter; left time: 1.0911s
	iters: 500, epoch: 10 | loss: 0.2319736
	speed: 0.0084s/iter; left time: 0.2432s
Epoch: 10 cost time: 4.56118106842041
Epoch: 10, Steps: 528 | Train Loss: 0.2974308 Vali Loss: 0.2315446
Updating learning rate to 1.953125e-05
EarlyStopping counter: 8 out of 10
#####   loading best weights   #####
Process: python3 (PID: 535425) is using 394 MiB of GPU memory.
Epoch: 10 | Elapsed Time: 275.9689621925354 s | VRAM usage: 0.384765625 Gb | Train MSE: 0.4161 Train MAE: 0.3615 Vali MSE: 0.2149 Vali MAE: 0.3185 Test MSE: 0.2936 Test MAE: 0.3442



Args in experiment:
Namespace(model='TimeMixer', task_name='long_term_forecast', seed=2021, data='ETTh2', root_path='./dataset/ETT-small/', data_path='ETTh2.csv', features='M', target='OT', freq='h', train_prop=1.0, seq_len=96, label_len=0, pred_len=192, seasonal_patterns='Monthly', inverse=False, enc_in=7, dec_in=7, c_out=7, decomp_method='moving_avg', top_k=5, moving_avg=25, d_model=16, d_ff=32, e_layers=2, dropout=0.1, embed='timeF', channel_independence=1, use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, output_attention=False, num_workers=4, train_epochs=10, batch_size=16, patience=10, delta=0.0, learning_rate=0.01, des='test', loss='MSE', lradj='type1', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_dir='./checkpoints/baseline/reproduction/ETTh2_96_192', save_last=False, break_at=0)
Use GPU: cuda:0
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4571647
	speed: 0.0142s/iter; left time: 72.7476s
	iters: 200, epoch: 1 | loss: 0.2988093
	speed: 0.0084s/iter; left time: 42.1544s
	iters: 300, epoch: 1 | loss: 0.7146918
	speed: 0.0083s/iter; left time: 41.0092s
	iters: 400, epoch: 1 | loss: 0.2979915
	speed: 0.0084s/iter; left time: 40.6554s
	iters: 500, epoch: 1 | loss: 0.4247355
	speed: 0.0084s/iter; left time: 39.4683s
Epoch: 1 cost time: 4.705251932144165
Epoch: 1, Steps: 522 | Train Loss: 0.5844290 Vali Loss: 0.2770228
Updating learning rate to 0.01
Validation loss decreased (inf --> 0.2770).  Saving model state dict ...
	iters: 100, epoch: 2 | loss: 0.8311904
	speed: 0.0156s/iter; left time: 71.5430s
	iters: 200, epoch: 2 | loss: 0.3676781
	speed: 0.0075s/iter; left time: 33.8137s
	iters: 300, epoch: 2 | loss: 0.2945523
	speed: 0.0075s/iter; left time: 32.9950s
	iters: 400, epoch: 2 | loss: 0.4592168
	speed: 0.0075s/iter; left time: 32.3263s
	iters: 500, epoch: 2 | loss: 0.2774835
	speed: 0.0075s/iter; left time: 31.6033s
Epoch: 2 cost time: 3.9987995624542236
Epoch: 2, Steps: 522 | Train Loss: 0.5519435 Vali Loss: 0.2884880
Updating learning rate to 0.005
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4524278
	speed: 0.0154s/iter; left time: 62.6246s
	iters: 200, epoch: 3 | loss: 0.5327448
	speed: 0.0074s/iter; left time: 29.4701s
	iters: 300, epoch: 3 | loss: 0.6579175
	speed: 0.0074s/iter; left time: 28.8488s
	iters: 400, epoch: 3 | loss: 0.3729124
	speed: 0.0075s/iter; left time: 28.3821s
	iters: 500, epoch: 3 | loss: 0.3059908
	speed: 0.0075s/iter; left time: 27.4785s
Epoch: 3 cost time: 3.9796228408813477
Epoch: 3, Steps: 522 | Train Loss: 0.5091934 Vali Loss: 0.2978178
Updating learning rate to 0.0025
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.3461247
	speed: 0.0156s/iter; left time: 55.6173s
	iters: 200, epoch: 4 | loss: 0.6276451
	speed: 0.0077s/iter; left time: 26.5949s
	iters: 300, epoch: 4 | loss: 0.2474053
	speed: 0.0076s/iter; left time: 25.5495s
	iters: 400, epoch: 4 | loss: 0.5201617
	speed: 0.0076s/iter; left time: 24.6696s
	iters: 500, epoch: 4 | loss: 0.3870457
	speed: 0.0075s/iter; left time: 23.6470s
Epoch: 4 cost time: 4.0496392250061035
Epoch: 4, Steps: 522 | Train Loss: 0.4737587 Vali Loss: 0.2836600
Updating learning rate to 0.00125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3784484
	speed: 0.0152s/iter; left time: 46.1557s
	iters: 200, epoch: 5 | loss: 0.3188289
	speed: 0.0076s/iter; left time: 22.1721s
	iters: 300, epoch: 5 | loss: 0.4897000
	speed: 0.0076s/iter; left time: 21.4175s
	iters: 400, epoch: 5 | loss: 0.3089922
	speed: 0.0076s/iter; left time: 20.7280s
	iters: 500, epoch: 5 | loss: 0.2756325
	speed: 0.0075s/iter; left time: 19.8210s
Epoch: 5 cost time: 4.002993106842041
Epoch: 5, Steps: 522 | Train Loss: 0.4375701 Vali Loss: 0.3003531
Updating learning rate to 0.000625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.3878342
	speed: 0.0167s/iter; left time: 41.9463s
	iters: 200, epoch: 6 | loss: 0.2542899
	speed: 0.0086s/iter; left time: 20.8459s
	iters: 300, epoch: 6 | loss: 0.4526419
	speed: 0.0086s/iter; left time: 19.9044s
	iters: 400, epoch: 6 | loss: 0.5116305
	speed: 0.0086s/iter; left time: 19.0152s
	iters: 500, epoch: 6 | loss: 0.3146714
	speed: 0.0086s/iter; left time: 18.1943s
Epoch: 6 cost time: 4.571905851364136
Epoch: 6, Steps: 522 | Train Loss: 0.4139393 Vali Loss: 0.3079234
Updating learning rate to 0.0003125
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.5110418
	speed: 0.0161s/iter; left time: 32.0838s
	iters: 200, epoch: 7 | loss: 0.3620534
	speed: 0.0078s/iter; left time: 14.7138s
	iters: 300, epoch: 7 | loss: 0.2707856
	speed: 0.0077s/iter; left time: 13.7920s
	iters: 400, epoch: 7 | loss: 0.5307145
	speed: 0.0077s/iter; left time: 13.0655s
	iters: 500, epoch: 7 | loss: 0.2779094
	speed: 0.0078s/iter; left time: 12.3939s
Epoch: 7 cost time: 4.1132307052612305
Epoch: 7, Steps: 522 | Train Loss: 0.4013579 Vali Loss: 0.3126070
Updating learning rate to 0.00015625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.4290835
	speed: 0.0158s/iter; left time: 23.1172s
	iters: 200, epoch: 8 | loss: 0.2975605
	speed: 0.0078s/iter; left time: 10.6895s
	iters: 300, epoch: 8 | loss: 0.2544420
	speed: 0.0078s/iter; left time: 9.8953s
	iters: 400, epoch: 8 | loss: 0.8706506
	speed: 0.0078s/iter; left time: 9.1364s
	iters: 500, epoch: 8 | loss: 0.3256460
	speed: 0.0078s/iter; left time: 8.3659s
Epoch: 8 cost time: 4.163187742233276
Epoch: 8, Steps: 522 | Train Loss: 0.3957780 Vali Loss: 0.3129593
Updating learning rate to 7.8125e-05
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.3547466
	speed: 0.0156s/iter; left time: 14.7611s
	iters: 200, epoch: 9 | loss: 0.2729029
	speed: 0.0076s/iter; left time: 6.3802s
	iters: 300, epoch: 9 | loss: 0.4753205
	speed: 0.0078s/iter; left time: 5.8285s
	iters: 400, epoch: 9 | loss: 0.4611247
	speed: 0.0077s/iter; left time: 4.9583s
	iters: 500, epoch: 9 | loss: 0.3057460
	speed: 0.0076s/iter; left time: 4.1585s
Epoch: 9 cost time: 4.060936212539673
Epoch: 9, Steps: 522 | Train Loss: 0.3922622 Vali Loss: 0.3139696
Updating learning rate to 3.90625e-05
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.2781082
	speed: 0.0156s/iter; left time: 6.5803s
	iters: 200, epoch: 10 | loss: 0.2970614
	speed: 0.0077s/iter; left time: 2.4870s
	iters: 300, epoch: 10 | loss: 0.2584237
	speed: 0.0076s/iter; left time: 1.6990s
	iters: 400, epoch: 10 | loss: 0.4456595
	speed: 0.0076s/iter; left time: 0.9378s
	iters: 500, epoch: 10 | loss: 0.2842202
	speed: 0.0076s/iter; left time: 0.1753s
Epoch: 10 cost time: 4.071565628051758
Epoch: 10, Steps: 522 | Train Loss: 0.3910295 Vali Loss: 0.3132443
Updating learning rate to 1.953125e-05
EarlyStopping counter: 9 out of 10
#####   loading best weights   #####
Process: python3 (PID: 536408) is using 394 MiB of GPU memory.
Epoch: 10 | Elapsed Time: 261.7290868759155 s | VRAM usage: 0.384765625 Gb | Train MSE: 0.5409 Train MAE: 0.4191 Vali MSE: 0.2770 Vali MAE: 0.3588 Test MSE: 0.3827 Test MAE: 0.4014



Args in experiment:
Namespace(model='TimeMixer', task_name='long_term_forecast', seed=2021, data='ETTh2', root_path='./dataset/ETT-small/', data_path='ETTh2.csv', features='M', target='OT', freq='h', train_prop=1.0, seq_len=96, label_len=0, pred_len=336, seasonal_patterns='Monthly', inverse=False, enc_in=7, dec_in=7, c_out=7, decomp_method='moving_avg', top_k=5, moving_avg=25, d_model=16, d_ff=32, e_layers=2, dropout=0.1, embed='timeF', channel_independence=1, use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, output_attention=False, num_workers=4, train_epochs=10, batch_size=16, patience=10, delta=0.0, learning_rate=0.01, des='test', loss='MSE', lradj='type1', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_dir='./checkpoints/baseline/reproduction/ETTh2_96_336', save_last=False, break_at=0)
Use GPU: cuda:0
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.7817742
	speed: 0.0142s/iter; left time: 71.2143s
	iters: 200, epoch: 1 | loss: 0.2734316
	speed: 0.0085s/iter; left time: 41.6937s
	iters: 300, epoch: 1 | loss: 0.6493971
	speed: 0.0086s/iter; left time: 41.5729s
	iters: 400, epoch: 1 | loss: 0.6653695
	speed: 0.0085s/iter; left time: 40.1402s
	iters: 500, epoch: 1 | loss: 0.6205056
	speed: 0.0075s/iter; left time: 34.7096s
Epoch: 1 cost time: 4.583392381668091
Epoch: 1, Steps: 513 | Train Loss: 0.7036234 Vali Loss: 0.3694843
Updating learning rate to 0.01
Validation loss decreased (inf --> 0.3695).  Saving model state dict ...
	iters: 100, epoch: 2 | loss: 0.9924542
	speed: 0.0150s/iter; left time: 67.8041s
	iters: 200, epoch: 2 | loss: 0.7591643
	speed: 0.0077s/iter; left time: 33.8266s
	iters: 300, epoch: 2 | loss: 0.7717764
	speed: 0.0076s/iter; left time: 32.8165s
	iters: 400, epoch: 2 | loss: 0.5690858
	speed: 0.0077s/iter; left time: 32.3604s
	iters: 500, epoch: 2 | loss: 0.4454429
	speed: 0.0077s/iter; left time: 31.6772s
Epoch: 2 cost time: 4.009008169174194
Epoch: 2, Steps: 513 | Train Loss: 0.6564672 Vali Loss: 0.3788340
Updating learning rate to 0.005
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3201536
	speed: 0.0153s/iter; left time: 61.2275s
	iters: 200, epoch: 3 | loss: 1.0288581
	speed: 0.0078s/iter; left time: 30.4110s
	iters: 300, epoch: 3 | loss: 0.6673570
	speed: 0.0078s/iter; left time: 29.6935s
	iters: 400, epoch: 3 | loss: 0.8220142
	speed: 0.0078s/iter; left time: 28.8308s
	iters: 500, epoch: 3 | loss: 0.8363159
	speed: 0.0078s/iter; left time: 27.9951s
Epoch: 3 cost time: 4.085268497467041
Epoch: 3, Steps: 513 | Train Loss: 0.6226333 Vali Loss: 0.3809197
Updating learning rate to 0.0025
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.1835350
	speed: 0.0152s/iter; left time: 53.0324s
	iters: 200, epoch: 4 | loss: 0.3379326
	speed: 0.0076s/iter; left time: 25.8065s
	iters: 300, epoch: 4 | loss: 0.4347523
	speed: 0.0077s/iter; left time: 25.2100s
	iters: 400, epoch: 4 | loss: 0.2727849
	speed: 0.0084s/iter; left time: 26.8325s
	iters: 500, epoch: 4 | loss: 0.5314953
	speed: 0.0087s/iter; left time: 26.8224s
Epoch: 4 cost time: 4.190986394882202
Epoch: 4, Steps: 513 | Train Loss: 0.5829741 Vali Loss: 0.3734113
Updating learning rate to 0.00125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.2959718
	speed: 0.0152s/iter; left time: 45.2231s
	iters: 200, epoch: 5 | loss: 0.5404011
	speed: 0.0079s/iter; left time: 22.6290s
	iters: 300, epoch: 5 | loss: 0.7138805
	speed: 0.0079s/iter; left time: 21.8329s
	iters: 400, epoch: 5 | loss: 0.8439649
	speed: 0.0078s/iter; left time: 20.8335s
	iters: 500, epoch: 5 | loss: 0.4465089
	speed: 0.0078s/iter; left time: 20.0241s
Epoch: 5 cost time: 4.095734596252441
Epoch: 5, Steps: 513 | Train Loss: 0.5473338 Vali Loss: 0.3812225
Updating learning rate to 0.000625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.5808433
	speed: 0.0154s/iter; left time: 38.0653s
	iters: 200, epoch: 6 | loss: 0.4333166
	speed: 0.0079s/iter; left time: 18.7295s
	iters: 300, epoch: 6 | loss: 0.7589747
	speed: 0.0080s/iter; left time: 18.2388s
	iters: 400, epoch: 6 | loss: 0.4395999
	speed: 0.0087s/iter; left time: 18.8494s
	iters: 500, epoch: 6 | loss: 1.0461932
	speed: 0.0085s/iter; left time: 17.5144s
Epoch: 6 cost time: 4.310134172439575
Epoch: 6, Steps: 513 | Train Loss: 0.5229608 Vali Loss: 0.3909429
Updating learning rate to 0.0003125
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.4085058
	speed: 0.0161s/iter; left time: 31.4020s
	iters: 200, epoch: 7 | loss: 0.2401748
	speed: 0.0086s/iter; left time: 15.9699s
	iters: 300, epoch: 7 | loss: 0.6863133
	speed: 0.0087s/iter; left time: 15.2871s
	iters: 400, epoch: 7 | loss: 0.3229302
	speed: 0.0088s/iter; left time: 14.4701s
	iters: 500, epoch: 7 | loss: 0.5641786
	speed: 0.0087s/iter; left time: 13.4599s
Epoch: 7 cost time: 4.518085479736328
Epoch: 7, Steps: 513 | Train Loss: 0.5106395 Vali Loss: 0.3918365
Updating learning rate to 0.00015625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.3988421
	speed: 0.0151s/iter; left time: 21.7902s
	iters: 200, epoch: 8 | loss: 0.3272204
	speed: 0.0076s/iter; left time: 10.1863s
	iters: 300, epoch: 8 | loss: 0.4451256
	speed: 0.0076s/iter; left time: 9.4687s
	iters: 400, epoch: 8 | loss: 0.3093723
	speed: 0.0076s/iter; left time: 8.6082s
	iters: 500, epoch: 8 | loss: 0.5582430
	speed: 0.0075s/iter; left time: 7.8351s
Epoch: 8 cost time: 3.9638936519622803
Epoch: 8, Steps: 513 | Train Loss: 0.5037086 Vali Loss: 0.3921587
Updating learning rate to 7.8125e-05
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.4360446
	speed: 0.0153s/iter; left time: 14.1448s
	iters: 200, epoch: 9 | loss: 0.5672303
	speed: 0.0080s/iter; left time: 6.5840s
	iters: 300, epoch: 9 | loss: 0.7737520
	speed: 0.0080s/iter; left time: 5.7964s
	iters: 400, epoch: 9 | loss: 0.4039431
	speed: 0.0079s/iter; left time: 4.9357s
	iters: 500, epoch: 9 | loss: 0.4351410
	speed: 0.0078s/iter; left time: 4.0941s
Epoch: 9 cost time: 4.125307083129883
Epoch: 9, Steps: 513 | Train Loss: 0.5001087 Vali Loss: 0.3915223
Updating learning rate to 3.90625e-05
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.9985545
	speed: 0.0160s/iter; left time: 6.6083s
	iters: 200, epoch: 10 | loss: 0.9461213
	speed: 0.0085s/iter; left time: 2.6676s
	iters: 300, epoch: 10 | loss: 0.6409519
	speed: 0.0086s/iter; left time: 1.8507s
	iters: 400, epoch: 10 | loss: 0.8725826
	speed: 0.0086s/iter; left time: 0.9810s
	iters: 500, epoch: 10 | loss: 0.3770412
	speed: 0.0084s/iter; left time: 0.1180s
Epoch: 10 cost time: 4.474979877471924
Epoch: 10, Steps: 513 | Train Loss: 0.4987850 Vali Loss: 0.3928305
Updating learning rate to 1.953125e-05
EarlyStopping counter: 9 out of 10
#####   loading best weights   #####
Process: python3 (PID: 537350) is using 394 MiB of GPU memory.
Epoch: 10 | Elapsed Time: 263.5670304298401 s | VRAM usage: 0.384765625 Gb | Train MSE: 0.6458 Train MAE: 0.4621 Vali MSE: 0.3695 Vali MAE: 0.4098 Test MSE: 0.4165 Test MAE: 0.4309



Args in experiment:
Namespace(model='TimeMixer', task_name='long_term_forecast', seed=2021, data='ETTh2', root_path='./dataset/ETT-small/', data_path='ETTh2.csv', features='M', target='OT', freq='h', train_prop=1.0, seq_len=96, label_len=0, pred_len=720, seasonal_patterns='Monthly', inverse=False, enc_in=7, dec_in=7, c_out=7, decomp_method='moving_avg', top_k=5, moving_avg=25, d_model=16, d_ff=32, e_layers=2, dropout=0.1, embed='timeF', channel_independence=1, use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, output_attention=False, num_workers=4, train_epochs=10, batch_size=16, patience=10, delta=0.0, learning_rate=0.01, des='test', loss='MSE', lradj='type1', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_dir='./checkpoints/baseline/reproduction/ETTh2_96_720', save_last=False, break_at=0)
Use GPU: cuda:0
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7845238
	speed: 0.0143s/iter; left time: 68.3964s
	iters: 200, epoch: 1 | loss: 1.0471432
	speed: 0.0085s/iter; left time: 39.8709s
	iters: 300, epoch: 1 | loss: 1.3455813
	speed: 0.0085s/iter; left time: 39.0928s
	iters: 400, epoch: 1 | loss: 0.9176332
	speed: 0.0087s/iter; left time: 39.0143s
Epoch: 1 cost time: 4.517252206802368
Epoch: 1, Steps: 489 | Train Loss: 0.8860035 Vali Loss: 0.6122961
Updating learning rate to 0.01
Validation loss decreased (inf --> 0.6123).  Saving model state dict ...
	iters: 100, epoch: 2 | loss: 0.9071231
	speed: 0.0220s/iter; left time: 94.7574s
	iters: 200, epoch: 2 | loss: 0.7574092
	speed: 0.0087s/iter; left time: 36.3629s
	iters: 300, epoch: 2 | loss: 0.9003053
	speed: 0.0087s/iter; left time: 35.5201s
	iters: 400, epoch: 2 | loss: 0.7968664
	speed: 0.0087s/iter; left time: 34.9776s
Epoch: 2 cost time: 4.336674213409424
Epoch: 2, Steps: 489 | Train Loss: 0.8484391 Vali Loss: 0.6490911
Updating learning rate to 0.005
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9279291
	speed: 0.0221s/iter; left time: 84.1505s
	iters: 200, epoch: 3 | loss: 0.6103275
	speed: 0.0085s/iter; left time: 31.5821s
	iters: 300, epoch: 3 | loss: 0.5979836
	speed: 0.0086s/iter; left time: 31.2049s
	iters: 400, epoch: 3 | loss: 1.0170865
	speed: 0.0087s/iter; left time: 30.4206s
Epoch: 3 cost time: 4.299836874008179
Epoch: 3, Steps: 489 | Train Loss: 0.7943897 Vali Loss: 0.6096423
Updating learning rate to 0.0025
Validation loss decreased (0.6123 --> 0.6096).  Saving model state dict ...
	iters: 100, epoch: 4 | loss: 1.3687221
	speed: 0.0222s/iter; left time: 73.8065s
	iters: 200, epoch: 4 | loss: 0.5049899
	speed: 0.0083s/iter; left time: 26.7765s
	iters: 300, epoch: 4 | loss: 0.8997324
	speed: 0.0080s/iter; left time: 24.9285s
	iters: 400, epoch: 4 | loss: 0.9574984
	speed: 0.0079s/iter; left time: 23.9495s
Epoch: 4 cost time: 4.080334424972534
Epoch: 4, Steps: 489 | Train Loss: 0.7546312 Vali Loss: 0.6222015
Updating learning rate to 0.00125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8301893
	speed: 0.0216s/iter; left time: 61.1075s
	iters: 200, epoch: 5 | loss: 0.3783593
	speed: 0.0087s/iter; left time: 23.7816s
	iters: 300, epoch: 5 | loss: 0.7071355
	speed: 0.0087s/iter; left time: 22.9351s
	iters: 400, epoch: 5 | loss: 0.7401021
	speed: 0.0087s/iter; left time: 22.0739s
Epoch: 5 cost time: 4.337137460708618
Epoch: 5, Steps: 489 | Train Loss: 0.7190216 Vali Loss: 0.6220803
Updating learning rate to 0.000625
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3790092
	speed: 0.0220s/iter; left time: 51.5264s
	iters: 200, epoch: 6 | loss: 0.6783718
	speed: 0.0083s/iter; left time: 18.7305s
	iters: 300, epoch: 6 | loss: 0.4870964
	speed: 0.0080s/iter; left time: 17.1624s
	iters: 400, epoch: 6 | loss: 0.5625742
	speed: 0.0079s/iter; left time: 16.2039s
Epoch: 6 cost time: 4.077913045883179
Epoch: 6, Steps: 489 | Train Loss: 0.7007983 Vali Loss: 0.6495540
Updating learning rate to 0.0003125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7477086
	speed: 0.0215s/iter; left time: 39.8945s
	iters: 200, epoch: 7 | loss: 0.6933210
	speed: 0.0086s/iter; left time: 15.1004s
	iters: 300, epoch: 7 | loss: 0.9381097
	speed: 0.0086s/iter; left time: 14.2258s
	iters: 400, epoch: 7 | loss: 0.5862038
	speed: 0.0087s/iter; left time: 13.4865s
Epoch: 7 cost time: 4.298639535903931
Epoch: 7, Steps: 489 | Train Loss: 0.6887639 Vali Loss: 0.6479760
Updating learning rate to 0.00015625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7583030
	speed: 0.0220s/iter; left time: 30.0327s
	iters: 200, epoch: 8 | loss: 0.8938744
	speed: 0.0086s/iter; left time: 10.8570s
	iters: 300, epoch: 8 | loss: 1.2584513
	speed: 0.0086s/iter; left time: 10.0325s
	iters: 400, epoch: 8 | loss: 0.7141759
	speed: 0.0082s/iter; left time: 8.7057s
Epoch: 8 cost time: 4.167105436325073
Epoch: 8, Steps: 489 | Train Loss: 0.6830716 Vali Loss: 0.6492464
Updating learning rate to 7.8125e-05
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.4626361
	speed: 0.0208s/iter; left time: 18.2708s
	iters: 200, epoch: 9 | loss: 0.4285685
	speed: 0.0080s/iter; left time: 6.2291s
	iters: 300, epoch: 9 | loss: 0.4266296
	speed: 0.0080s/iter; left time: 5.4325s
	iters: 400, epoch: 9 | loss: 0.5041067
	speed: 0.0080s/iter; left time: 4.6137s
Epoch: 9 cost time: 4.069221258163452
Epoch: 9, Steps: 489 | Train Loss: 0.6794504 Vali Loss: 0.6545468
Updating learning rate to 3.90625e-05
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.5489302
	speed: 0.0219s/iter; left time: 8.5231s
	iters: 200, epoch: 10 | loss: 1.0036643
	speed: 0.0079s/iter; left time: 2.2981s
	iters: 300, epoch: 10 | loss: 0.7330937
	speed: 0.0079s/iter; left time: 1.5062s
	iters: 400, epoch: 10 | loss: 0.5835862
	speed: 0.0080s/iter; left time: 0.7171s
Epoch: 10 cost time: 3.990351438522339
Epoch: 10, Steps: 489 | Train Loss: 0.6778470 Vali Loss: 0.6523415
Updating learning rate to 1.953125e-05
EarlyStopping counter: 7 out of 10
#####   loading best weights   #####
Process: python3 (PID: 538295) is using 416 MiB of GPU memory.
Epoch: 10 | Elapsed Time: 262.494558095932 s | VRAM usage: 0.40625 Gb | Train MSE: 0.7784 Train MAE: 0.5306 Vali MSE: 0.6096 Vali MAE: 0.5408 Test MSE: 0.4257 Test MAE: 0.4421



