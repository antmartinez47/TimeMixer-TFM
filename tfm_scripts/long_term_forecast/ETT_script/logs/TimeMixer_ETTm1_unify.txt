Args in experiment:
Namespace(model='TimeMixer', task_name='long_term_forecast', seed=2021, data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', train_prop=1.0, seq_len=96, label_len=0, pred_len=96, seasonal_patterns='Monthly', inverse=False, enc_in=7, dec_in=7, c_out=7, decomp_method='moving_avg', top_k=5, moving_avg=25, d_model=16, d_ff=32, e_layers=2, dropout=0.1, embed='timeF', channel_independence=1, use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, output_attention=False, num_workers=4, train_epochs=10, batch_size=16, patience=10, delta=0.0, learning_rate=0.01, des='test', loss='MSE', lradj='type1', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_dir='./checkpoints/baseline/reproduction/ETTm1_96_96', save_last=False, break_at=0)
Use GPU: cuda:0
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4948096
	speed: 0.0141s/iter; left time: 300.9413s
	iters: 200, epoch: 1 | loss: 0.3441389
	speed: 0.0085s/iter; left time: 180.8353s
	iters: 300, epoch: 1 | loss: 0.3151350
	speed: 0.0085s/iter; left time: 179.4208s
	iters: 400, epoch: 1 | loss: 0.3414700
	speed: 0.0085s/iter; left time: 178.5413s
	iters: 500, epoch: 1 | loss: 0.2700089
	speed: 0.0084s/iter; left time: 177.2877s
	iters: 600, epoch: 1 | loss: 0.3501796
	speed: 0.0085s/iter; left time: 177.7490s
	iters: 700, epoch: 1 | loss: 0.3244050
	speed: 0.0085s/iter; left time: 176.9867s
	iters: 800, epoch: 1 | loss: 0.3194570
	speed: 0.0085s/iter; left time: 175.7440s
	iters: 900, epoch: 1 | loss: 0.3601447
	speed: 0.0085s/iter; left time: 174.8658s
	iters: 1000, epoch: 1 | loss: 0.3003172
	speed: 0.0085s/iter; left time: 175.0891s
	iters: 1100, epoch: 1 | loss: 0.2547136
	speed: 0.0086s/iter; left time: 174.4481s
	iters: 1200, epoch: 1 | loss: 0.2806681
	speed: 0.0086s/iter; left time: 174.0187s
	iters: 1300, epoch: 1 | loss: 0.2354277
	speed: 0.0085s/iter; left time: 171.9698s
	iters: 1400, epoch: 1 | loss: 0.2680621
	speed: 0.0085s/iter; left time: 170.9571s
	iters: 1500, epoch: 1 | loss: 0.2682120
	speed: 0.0085s/iter; left time: 170.2887s
	iters: 1600, epoch: 1 | loss: 0.3126012
	speed: 0.0085s/iter; left time: 169.2625s
	iters: 1700, epoch: 1 | loss: 0.2366000
	speed: 0.0086s/iter; left time: 169.2728s
	iters: 1800, epoch: 1 | loss: 0.2866086
	speed: 0.0085s/iter; left time: 167.9063s
	iters: 1900, epoch: 1 | loss: 0.2771593
	speed: 0.0085s/iter; left time: 167.2613s
	iters: 2000, epoch: 1 | loss: 0.2530545
	speed: 0.0085s/iter; left time: 166.1685s
	iters: 2100, epoch: 1 | loss: 0.3121422
	speed: 0.0085s/iter; left time: 164.8072s
Epoch: 1 cost time: 18.605313539505005
Epoch: 1, Steps: 2148 | Train Loss: 0.3169227 Vali Loss: 0.4042797
Updating learning rate to 0.01
Validation loss decreased (inf --> 0.4043).  Saving model state dict ...
	iters: 100, epoch: 2 | loss: 0.3699439
	speed: 0.0341s/iter; left time: 656.7553s
	iters: 200, epoch: 2 | loss: 0.2938944
	speed: 0.0074s/iter; left time: 142.3866s
	iters: 300, epoch: 2 | loss: 0.3402215
	speed: 0.0075s/iter; left time: 142.4720s
	iters: 400, epoch: 2 | loss: 0.3017204
	speed: 0.0076s/iter; left time: 143.1912s
	iters: 500, epoch: 2 | loss: 0.2972711
	speed: 0.0075s/iter; left time: 141.5549s
	iters: 600, epoch: 2 | loss: 0.2731922
	speed: 0.0075s/iter; left time: 140.5518s
	iters: 700, epoch: 2 | loss: 0.2464091
	speed: 0.0075s/iter; left time: 139.5662s
	iters: 800, epoch: 2 | loss: 0.2224210
	speed: 0.0074s/iter; left time: 137.9487s
	iters: 900, epoch: 2 | loss: 0.2597392
	speed: 0.0074s/iter; left time: 136.5625s
	iters: 1000, epoch: 2 | loss: 0.2562620
	speed: 0.0083s/iter; left time: 151.4082s
	iters: 1100, epoch: 2 | loss: 0.2465965
	speed: 0.0084s/iter; left time: 152.6497s
	iters: 1200, epoch: 2 | loss: 0.2796847
	speed: 0.0084s/iter; left time: 152.3585s
	iters: 1300, epoch: 2 | loss: 0.2567938
	speed: 0.0083s/iter; left time: 150.5546s
	iters: 1400, epoch: 2 | loss: 0.3312335
	speed: 0.0080s/iter; left time: 143.7103s
	iters: 1500, epoch: 2 | loss: 0.2630348
	speed: 0.0077s/iter; left time: 137.8401s
	iters: 1600, epoch: 2 | loss: 0.3268435
	speed: 0.0078s/iter; left time: 137.6638s
	iters: 1700, epoch: 2 | loss: 0.2856803
	speed: 0.0078s/iter; left time: 136.9839s
	iters: 1800, epoch: 2 | loss: 0.2815776
	speed: 0.0078s/iter; left time: 136.2871s
	iters: 1900, epoch: 2 | loss: 0.2267692
	speed: 0.0078s/iter; left time: 135.8191s
	iters: 2000, epoch: 2 | loss: 0.2473212
	speed: 0.0078s/iter; left time: 134.9591s
	iters: 2100, epoch: 2 | loss: 0.2590563
	speed: 0.0078s/iter; left time: 134.1133s
Epoch: 2 cost time: 16.767725467681885
Epoch: 2, Steps: 2148 | Train Loss: 0.2855441 Vali Loss: 0.4029191
Updating learning rate to 0.005
Validation loss decreased (0.4043 --> 0.4029).  Saving model state dict ...
	iters: 100, epoch: 3 | loss: 0.2404242
	speed: 0.0345s/iter; left time: 588.6468s
	iters: 200, epoch: 3 | loss: 0.2725032
	speed: 0.0084s/iter; left time: 142.8469s
	iters: 300, epoch: 3 | loss: 0.2565989
	speed: 0.0084s/iter; left time: 141.6741s
	iters: 400, epoch: 3 | loss: 0.2511980
	speed: 0.0078s/iter; left time: 131.0965s
	iters: 500, epoch: 3 | loss: 0.2920493
	speed: 0.0077s/iter; left time: 128.5281s
	iters: 600, epoch: 3 | loss: 0.2729399
	speed: 0.0077s/iter; left time: 127.7935s
	iters: 700, epoch: 3 | loss: 0.3116558
	speed: 0.0078s/iter; left time: 128.6644s
	iters: 800, epoch: 3 | loss: 0.2772913
	speed: 0.0078s/iter; left time: 128.1911s
	iters: 900, epoch: 3 | loss: 0.2191173
	speed: 0.0078s/iter; left time: 126.4936s
	iters: 1000, epoch: 3 | loss: 0.2379603
	speed: 0.0077s/iter; left time: 124.7918s
	iters: 1100, epoch: 3 | loss: 0.3619419
	speed: 0.0077s/iter; left time: 123.3106s
	iters: 1200, epoch: 3 | loss: 0.3442364
	speed: 0.0077s/iter; left time: 122.6819s
	iters: 1300, epoch: 3 | loss: 0.2088238
	speed: 0.0077s/iter; left time: 122.1765s
	iters: 1400, epoch: 3 | loss: 0.2314713
	speed: 0.0077s/iter; left time: 121.6617s
	iters: 1500, epoch: 3 | loss: 0.2026842
	speed: 0.0077s/iter; left time: 121.4413s
	iters: 1600, epoch: 3 | loss: 0.2351978
	speed: 0.0077s/iter; left time: 119.7541s
	iters: 1700, epoch: 3 | loss: 0.2656481
	speed: 0.0077s/iter; left time: 119.2421s
	iters: 1800, epoch: 3 | loss: 0.3380420
	speed: 0.0085s/iter; left time: 130.0288s
	iters: 1900, epoch: 3 | loss: 0.3217249
	speed: 0.0085s/iter; left time: 129.4414s
	iters: 2000, epoch: 3 | loss: 0.3159616
	speed: 0.0084s/iter; left time: 127.7395s
	iters: 2100, epoch: 3 | loss: 0.3101126
	speed: 0.0084s/iter; left time: 126.5857s
Epoch: 3 cost time: 17.19803214073181
Epoch: 3, Steps: 2148 | Train Loss: 0.2624033 Vali Loss: 0.4001166
Updating learning rate to 0.0025
Validation loss decreased (0.4029 --> 0.4001).  Saving model state dict ...
	iters: 100, epoch: 4 | loss: 0.2810002
	speed: 0.0335s/iter; left time: 500.1375s
	iters: 200, epoch: 4 | loss: 0.3426162
	speed: 0.0077s/iter; left time: 113.9512s
	iters: 300, epoch: 4 | loss: 0.2871774
	speed: 0.0077s/iter; left time: 112.8162s
	iters: 400, epoch: 4 | loss: 0.2887720
	speed: 0.0077s/iter; left time: 112.5719s
	iters: 500, epoch: 4 | loss: 0.1808493
	speed: 0.0076s/iter; left time: 111.0151s
	iters: 600, epoch: 4 | loss: 0.1984152
	speed: 0.0076s/iter; left time: 110.1388s
	iters: 700, epoch: 4 | loss: 0.2934237
	speed: 0.0076s/iter; left time: 109.3134s
	iters: 800, epoch: 4 | loss: 0.2313128
	speed: 0.0077s/iter; left time: 109.2476s
	iters: 900, epoch: 4 | loss: 0.2559111
	speed: 0.0081s/iter; left time: 114.4748s
	iters: 1000, epoch: 4 | loss: 0.3995092
	speed: 0.0085s/iter; left time: 119.0288s
	iters: 1100, epoch: 4 | loss: 0.2482848
	speed: 0.0085s/iter; left time: 117.9276s
	iters: 1200, epoch: 4 | loss: 0.2292416
	speed: 0.0085s/iter; left time: 117.3516s
	iters: 1300, epoch: 4 | loss: 0.2490522
	speed: 0.0085s/iter; left time: 116.5963s
	iters: 1400, epoch: 4 | loss: 0.2197017
	speed: 0.0085s/iter; left time: 115.4117s
	iters: 1500, epoch: 4 | loss: 0.2194619
	speed: 0.0085s/iter; left time: 114.7545s
	iters: 1600, epoch: 4 | loss: 0.1764413
	speed: 0.0085s/iter; left time: 113.7985s
	iters: 1700, epoch: 4 | loss: 0.2329261
	speed: 0.0085s/iter; left time: 113.2449s
	iters: 1800, epoch: 4 | loss: 0.1638297
	speed: 0.0084s/iter; left time: 111.6894s
	iters: 1900, epoch: 4 | loss: 0.1943759
	speed: 0.0084s/iter; left time: 110.3732s
	iters: 2000, epoch: 4 | loss: 0.2363596
	speed: 0.0084s/iter; left time: 109.6927s
	iters: 2100, epoch: 4 | loss: 0.2965790
	speed: 0.0084s/iter; left time: 108.7261s
Epoch: 4 cost time: 17.57456684112549
Epoch: 4, Steps: 2148 | Train Loss: 0.2497120 Vali Loss: 0.4013611
Updating learning rate to 0.00125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2378284
	speed: 0.0334s/iter; left time: 427.3554s
	iters: 200, epoch: 5 | loss: 0.2805367
	speed: 0.0078s/iter; left time: 98.4279s
	iters: 300, epoch: 5 | loss: 0.2614494
	speed: 0.0077s/iter; left time: 97.4866s
	iters: 400, epoch: 5 | loss: 0.2001501
	speed: 0.0078s/iter; left time: 97.9652s
	iters: 500, epoch: 5 | loss: 0.1888951
	speed: 0.0084s/iter; left time: 104.0390s
	iters: 600, epoch: 5 | loss: 0.2112046
	speed: 0.0084s/iter; left time: 102.8932s
	iters: 700, epoch: 5 | loss: 0.2792726
	speed: 0.0083s/iter; left time: 101.3841s
	iters: 800, epoch: 5 | loss: 0.2496227
	speed: 0.0084s/iter; left time: 100.9473s
	iters: 900, epoch: 5 | loss: 0.2838658
	speed: 0.0084s/iter; left time: 100.2327s
	iters: 1000, epoch: 5 | loss: 0.2196250
	speed: 0.0084s/iter; left time: 99.7687s
	iters: 1100, epoch: 5 | loss: 0.2995944
	speed: 0.0084s/iter; left time: 98.6960s
	iters: 1200, epoch: 5 | loss: 0.2549731
	speed: 0.0084s/iter; left time: 98.6172s
	iters: 1300, epoch: 5 | loss: 0.2443736
	speed: 0.0083s/iter; left time: 96.6448s
	iters: 1400, epoch: 5 | loss: 0.2957954
	speed: 0.0084s/iter; left time: 96.3732s
	iters: 1500, epoch: 5 | loss: 0.1989924
	speed: 0.0083s/iter; left time: 94.8772s
	iters: 1600, epoch: 5 | loss: 0.1997389
	speed: 0.0075s/iter; left time: 84.5218s
	iters: 1700, epoch: 5 | loss: 0.1777864
	speed: 0.0074s/iter; left time: 83.2806s
	iters: 1800, epoch: 5 | loss: 0.2920215
	speed: 0.0075s/iter; left time: 82.9287s
	iters: 1900, epoch: 5 | loss: 0.2321440
	speed: 0.0075s/iter; left time: 82.4121s
	iters: 2000, epoch: 5 | loss: 0.2265086
	speed: 0.0074s/iter; left time: 81.0133s
	iters: 2100, epoch: 5 | loss: 0.1866487
	speed: 0.0074s/iter; left time: 80.2232s
Epoch: 5 cost time: 17.230066537857056
Epoch: 5, Steps: 2148 | Train Loss: 0.2408230 Vali Loss: 0.4059770
Updating learning rate to 0.000625
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2979861
	speed: 0.0330s/iter; left time: 351.1823s
	iters: 200, epoch: 6 | loss: 0.2115217
	speed: 0.0076s/iter; left time: 79.7986s
	iters: 300, epoch: 6 | loss: 0.2648593
	speed: 0.0076s/iter; left time: 79.7881s
	iters: 400, epoch: 6 | loss: 0.2775165
	speed: 0.0077s/iter; left time: 79.1783s
	iters: 500, epoch: 6 | loss: 0.1808844
	speed: 0.0076s/iter; left time: 78.0600s
	iters: 600, epoch: 6 | loss: 0.2792926
	speed: 0.0075s/iter; left time: 76.0082s
	iters: 700, epoch: 6 | loss: 0.1646085
	speed: 0.0075s/iter; left time: 75.6663s
	iters: 800, epoch: 6 | loss: 0.1969050
	speed: 0.0075s/iter; left time: 74.8637s
	iters: 900, epoch: 6 | loss: 0.1897131
	speed: 0.0075s/iter; left time: 73.8221s
	iters: 1000, epoch: 6 | loss: 0.1883066
	speed: 0.0075s/iter; left time: 72.8898s
	iters: 1100, epoch: 6 | loss: 0.1906681
	speed: 0.0075s/iter; left time: 72.7356s
	iters: 1200, epoch: 6 | loss: 0.1976055
	speed: 0.0075s/iter; left time: 71.4255s
	iters: 1300, epoch: 6 | loss: 0.2209390
	speed: 0.0075s/iter; left time: 70.9602s
	iters: 1400, epoch: 6 | loss: 0.1836862
	speed: 0.0075s/iter; left time: 70.1020s
	iters: 1500, epoch: 6 | loss: 0.2229488
	speed: 0.0075s/iter; left time: 69.4595s
	iters: 1600, epoch: 6 | loss: 0.1739919
	speed: 0.0075s/iter; left time: 68.5058s
	iters: 1700, epoch: 6 | loss: 0.1990501
	speed: 0.0075s/iter; left time: 68.2137s
	iters: 1800, epoch: 6 | loss: 0.1713320
	speed: 0.0075s/iter; left time: 66.9543s
	iters: 1900, epoch: 6 | loss: 0.2477355
	speed: 0.0075s/iter; left time: 66.4584s
	iters: 2000, epoch: 6 | loss: 0.2047977
	speed: 0.0074s/iter; left time: 64.8560s
	iters: 2100, epoch: 6 | loss: 0.1805416
	speed: 0.0077s/iter; left time: 66.6033s
Epoch: 6 cost time: 16.3148672580719
Epoch: 6, Steps: 2148 | Train Loss: 0.2350983 Vali Loss: 0.4064622
Updating learning rate to 0.0003125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2229593
	speed: 0.0344s/iter; left time: 292.0200s
	iters: 200, epoch: 7 | loss: 0.1887445
	speed: 0.0084s/iter; left time: 70.2049s
	iters: 300, epoch: 7 | loss: 0.2291288
	speed: 0.0083s/iter; left time: 68.7871s
	iters: 400, epoch: 7 | loss: 0.3037959
	speed: 0.0083s/iter; left time: 68.0117s
	iters: 500, epoch: 7 | loss: 0.2344122
	speed: 0.0083s/iter; left time: 67.0582s
	iters: 600, epoch: 7 | loss: 0.1791480
	speed: 0.0084s/iter; left time: 66.8442s
	iters: 700, epoch: 7 | loss: 0.2127939
	speed: 0.0083s/iter; left time: 65.6856s
	iters: 800, epoch: 7 | loss: 0.2125781
	speed: 0.0085s/iter; left time: 66.3891s
	iters: 900, epoch: 7 | loss: 0.2785846
	speed: 0.0085s/iter; left time: 65.7127s
	iters: 1000, epoch: 7 | loss: 0.2676867
	speed: 0.0085s/iter; left time: 64.8463s
	iters: 1100, epoch: 7 | loss: 0.1852559
	speed: 0.0085s/iter; left time: 63.7796s
	iters: 1200, epoch: 7 | loss: 0.2357490
	speed: 0.0085s/iter; left time: 63.0780s
	iters: 1300, epoch: 7 | loss: 0.2179165
	speed: 0.0085s/iter; left time: 62.1205s
	iters: 1400, epoch: 7 | loss: 0.2520725
	speed: 0.0085s/iter; left time: 61.0443s
	iters: 1500, epoch: 7 | loss: 0.2060100
	speed: 0.0085s/iter; left time: 60.2605s
	iters: 1600, epoch: 7 | loss: 0.2145740
	speed: 0.0084s/iter; left time: 58.4029s
	iters: 1700, epoch: 7 | loss: 0.2149422
	speed: 0.0077s/iter; left time: 53.3876s
	iters: 1800, epoch: 7 | loss: 0.2142351
	speed: 0.0077s/iter; left time: 52.6349s
	iters: 1900, epoch: 7 | loss: 0.1545780
	speed: 0.0078s/iter; left time: 52.1829s
	iters: 2000, epoch: 7 | loss: 0.2021404
	speed: 0.0078s/iter; left time: 51.2232s
	iters: 2100, epoch: 7 | loss: 0.2171135
	speed: 0.0075s/iter; left time: 48.8771s
Epoch: 7 cost time: 17.80869436264038
Epoch: 7, Steps: 2148 | Train Loss: 0.2316644 Vali Loss: 0.4073849
Updating learning rate to 0.00015625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1798884
	speed: 0.0332s/iter; left time: 210.4514s
	iters: 200, epoch: 8 | loss: 0.2004171
	speed: 0.0075s/iter; left time: 46.6651s
	iters: 300, epoch: 8 | loss: 0.2681788
	speed: 0.0073s/iter; left time: 44.7823s
	iters: 400, epoch: 8 | loss: 0.2250689
	speed: 0.0076s/iter; left time: 45.8656s
	iters: 500, epoch: 8 | loss: 0.3015550
	speed: 0.0076s/iter; left time: 45.0781s
	iters: 600, epoch: 8 | loss: 0.2463993
	speed: 0.0084s/iter; left time: 49.0558s
	iters: 700, epoch: 8 | loss: 0.2395495
	speed: 0.0084s/iter; left time: 48.2201s
	iters: 800, epoch: 8 | loss: 0.2108130
	speed: 0.0085s/iter; left time: 47.7579s
	iters: 900, epoch: 8 | loss: 0.2426666
	speed: 0.0084s/iter; left time: 46.5068s
	iters: 1000, epoch: 8 | loss: 0.2366692
	speed: 0.0078s/iter; left time: 42.3331s
	iters: 1100, epoch: 8 | loss: 0.1779776
	speed: 0.0078s/iter; left time: 41.5586s
	iters: 1200, epoch: 8 | loss: 0.4747586
	speed: 0.0077s/iter; left time: 40.5963s
	iters: 1300, epoch: 8 | loss: 0.2286595
	speed: 0.0078s/iter; left time: 39.9326s
	iters: 1400, epoch: 8 | loss: 0.2298696
	speed: 0.0078s/iter; left time: 39.3339s
	iters: 1500, epoch: 8 | loss: 0.2738229
	speed: 0.0078s/iter; left time: 38.6582s
	iters: 1600, epoch: 8 | loss: 0.2357681
	speed: 0.0078s/iter; left time: 37.5760s
	iters: 1700, epoch: 8 | loss: 0.2234536
	speed: 0.0078s/iter; left time: 36.9647s
	iters: 1800, epoch: 8 | loss: 0.3365129
	speed: 0.0078s/iter; left time: 36.1965s
	iters: 1900, epoch: 8 | loss: 0.2761021
	speed: 0.0077s/iter; left time: 35.1008s
	iters: 2000, epoch: 8 | loss: 0.2712885
	speed: 0.0077s/iter; left time: 34.4182s
	iters: 2100, epoch: 8 | loss: 0.2790699
	speed: 0.0077s/iter; left time: 33.6353s
Epoch: 8 cost time: 16.879634141921997
Epoch: 8, Steps: 2148 | Train Loss: 0.2298114 Vali Loss: 0.4099965
Updating learning rate to 7.8125e-05
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.2233225
	speed: 0.0342s/iter; left time: 143.5773s
	iters: 200, epoch: 9 | loss: 0.2904844
	speed: 0.0085s/iter; left time: 34.8821s
	iters: 300, epoch: 9 | loss: 0.2318523
	speed: 0.0085s/iter; left time: 34.0857s
	iters: 400, epoch: 9 | loss: 0.2144826
	speed: 0.0085s/iter; left time: 33.0239s
	iters: 500, epoch: 9 | loss: 0.1736886
	speed: 0.0086s/iter; left time: 32.4805s
	iters: 600, epoch: 9 | loss: 0.1919076
	speed: 0.0084s/iter; left time: 31.1816s
	iters: 700, epoch: 9 | loss: 0.2689712
	speed: 0.0084s/iter; left time: 30.3190s
	iters: 800, epoch: 9 | loss: 0.2448029
	speed: 0.0084s/iter; left time: 29.4996s
	iters: 900, epoch: 9 | loss: 0.2046726
	speed: 0.0085s/iter; left time: 29.0065s
	iters: 1000, epoch: 9 | loss: 0.2007279
	speed: 0.0085s/iter; left time: 27.9603s
	iters: 1100, epoch: 9 | loss: 0.2378803
	speed: 0.0084s/iter; left time: 26.9084s
	iters: 1200, epoch: 9 | loss: 0.3358880
	speed: 0.0085s/iter; left time: 26.2035s
	iters: 1300, epoch: 9 | loss: 0.1879401
	speed: 0.0080s/iter; left time: 24.1118s
	iters: 1400, epoch: 9 | loss: 0.2265139
	speed: 0.0077s/iter; left time: 22.4468s
	iters: 1500, epoch: 9 | loss: 0.1747664
	speed: 0.0077s/iter; left time: 21.6363s
	iters: 1600, epoch: 9 | loss: 0.2037438
	speed: 0.0077s/iter; left time: 20.7510s
	iters: 1700, epoch: 9 | loss: 0.2119921
	speed: 0.0077s/iter; left time: 19.9272s
	iters: 1800, epoch: 9 | loss: 0.2199629
	speed: 0.0078s/iter; left time: 19.4436s
	iters: 1900, epoch: 9 | loss: 0.2209385
	speed: 0.0077s/iter; left time: 18.3805s
	iters: 2000, epoch: 9 | loss: 0.2395377
	speed: 0.0085s/iter; left time: 19.4309s
	iters: 2100, epoch: 9 | loss: 0.1991116
	speed: 0.0084s/iter; left time: 18.5218s
Epoch: 9 cost time: 17.773147106170654
Epoch: 9, Steps: 2148 | Train Loss: 0.2289114 Vali Loss: 0.4087744
Updating learning rate to 3.90625e-05
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1867365
	speed: 0.0346s/iter; left time: 70.9060s
	iters: 200, epoch: 10 | loss: 0.2858822
	speed: 0.0085s/iter; left time: 16.4984s
	iters: 300, epoch: 10 | loss: 0.2709486
	speed: 0.0083s/iter; left time: 15.3048s
	iters: 400, epoch: 10 | loss: 0.2354145
	speed: 0.0078s/iter; left time: 13.5643s
	iters: 500, epoch: 10 | loss: 0.2264140
	speed: 0.0078s/iter; left time: 12.8686s
	iters: 600, epoch: 10 | loss: 0.2101735
	speed: 0.0078s/iter; left time: 12.1112s
	iters: 700, epoch: 10 | loss: 0.2582262
	speed: 0.0078s/iter; left time: 11.2409s
	iters: 800, epoch: 10 | loss: 0.3150549
	speed: 0.0077s/iter; left time: 10.4205s
	iters: 900, epoch: 10 | loss: 0.2929587
	speed: 0.0078s/iter; left time: 9.7530s
	iters: 1000, epoch: 10 | loss: 0.1826541
	speed: 0.0078s/iter; left time: 9.0006s
	iters: 1100, epoch: 10 | loss: 0.2105066
	speed: 0.0078s/iter; left time: 8.1695s
	iters: 1200, epoch: 10 | loss: 0.2468102
	speed: 0.0077s/iter; left time: 7.3383s
	iters: 1300, epoch: 10 | loss: 0.2451114
	speed: 0.0078s/iter; left time: 6.5812s
	iters: 1400, epoch: 10 | loss: 0.1951507
	speed: 0.0077s/iter; left time: 5.7787s
	iters: 1500, epoch: 10 | loss: 0.1912633
	speed: 0.0077s/iter; left time: 5.0254s
	iters: 1600, epoch: 10 | loss: 0.2923487
	speed: 0.0077s/iter; left time: 4.2488s
	iters: 1700, epoch: 10 | loss: 0.2301803
	speed: 0.0077s/iter; left time: 3.4517s
	iters: 1800, epoch: 10 | loss: 0.2167566
	speed: 0.0077s/iter; left time: 2.6842s
	iters: 1900, epoch: 10 | loss: 0.2736851
	speed: 0.0078s/iter; left time: 1.9480s
	iters: 2000, epoch: 10 | loss: 0.2265204
	speed: 0.0077s/iter; left time: 1.1454s
	iters: 2100, epoch: 10 | loss: 0.1692224
	speed: 0.0077s/iter; left time: 0.3774s
Epoch: 10 cost time: 16.92073082923889
Epoch: 10, Steps: 2148 | Train Loss: 0.2284155 Vali Loss: 0.4122709
Updating learning rate to 1.953125e-05
EarlyStopping counter: 7 out of 10
#####   loading best weights   #####
Process: python3 (PID: 539238) is using 394 MiB of GPU memory.
Epoch: 10 | Elapsed Time: 1073.7614693641663 s | VRAM usage: 0.384765625 Gb | Train MSE: 0.2510 Train MAE: 0.3386 Vali MSE: 0.4001 Vali MAE: 0.4181 Test MSE: 0.3218 Test MAE: 0.3626



Args in experiment:
Namespace(model='TimeMixer', task_name='long_term_forecast', seed=2021, data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', train_prop=1.0, seq_len=96, label_len=0, pred_len=192, seasonal_patterns='Monthly', inverse=False, enc_in=7, dec_in=7, c_out=7, decomp_method='moving_avg', top_k=5, moving_avg=25, d_model=16, d_ff=32, e_layers=2, dropout=0.1, embed='timeF', channel_independence=1, use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, output_attention=False, num_workers=4, train_epochs=10, batch_size=16, patience=10, delta=0.0, learning_rate=0.01, des='test', loss='MSE', lradj='type1', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_dir='./checkpoints/baseline/reproduction/ETTm1_96_192', save_last=False, break_at=0)
Use GPU: cuda:0
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4411578
	speed: 0.0141s/iter; left time: 300.3718s
	iters: 200, epoch: 1 | loss: 0.4576346
	speed: 0.0086s/iter; left time: 183.0268s
	iters: 300, epoch: 1 | loss: 0.3999460
	speed: 0.0086s/iter; left time: 181.9644s
	iters: 400, epoch: 1 | loss: 0.3094636
	speed: 0.0086s/iter; left time: 180.4038s
	iters: 500, epoch: 1 | loss: 0.4712197
	speed: 0.0086s/iter; left time: 180.3940s
	iters: 600, epoch: 1 | loss: 0.3266095
	speed: 0.0086s/iter; left time: 178.8517s
	iters: 700, epoch: 1 | loss: 0.3835570
	speed: 0.0086s/iter; left time: 178.3961s
	iters: 800, epoch: 1 | loss: 0.4982136
	speed: 0.0086s/iter; left time: 176.9629s
	iters: 900, epoch: 1 | loss: 0.2857617
	speed: 0.0086s/iter; left time: 176.1009s
	iters: 1000, epoch: 1 | loss: 0.3542050
	speed: 0.0086s/iter; left time: 175.5951s
	iters: 1100, epoch: 1 | loss: 0.3670135
	speed: 0.0086s/iter; left time: 174.1354s
	iters: 1200, epoch: 1 | loss: 0.3401544
	speed: 0.0085s/iter; left time: 172.8738s
	iters: 1300, epoch: 1 | loss: 0.3756814
	speed: 0.0085s/iter; left time: 171.6625s
	iters: 1400, epoch: 1 | loss: 0.3343572
	speed: 0.0082s/iter; left time: 163.4912s
	iters: 1500, epoch: 1 | loss: 0.3245045
	speed: 0.0076s/iter; left time: 152.2874s
	iters: 1600, epoch: 1 | loss: 0.3735248
	speed: 0.0077s/iter; left time: 153.0385s
	iters: 1700, epoch: 1 | loss: 0.3627124
	speed: 0.0077s/iter; left time: 151.0579s
	iters: 1800, epoch: 1 | loss: 0.3495044
	speed: 0.0076s/iter; left time: 149.9314s
	iters: 1900, epoch: 1 | loss: 0.2838893
	speed: 0.0076s/iter; left time: 147.5565s
	iters: 2000, epoch: 1 | loss: 0.3742801
	speed: 0.0076s/iter; left time: 147.3173s
	iters: 2100, epoch: 1 | loss: 0.2994111
	speed: 0.0077s/iter; left time: 147.8891s
Epoch: 1 cost time: 17.958998441696167
Epoch: 1, Steps: 2142 | Train Loss: 0.3708163 Vali Loss: 0.5214707
Updating learning rate to 0.01
Validation loss decreased (inf --> 0.5215).  Saving model state dict ...
	iters: 100, epoch: 2 | loss: 0.3790721
	speed: 0.0332s/iter; left time: 636.8962s
	iters: 200, epoch: 2 | loss: 0.3439062
	speed: 0.0079s/iter; left time: 149.8283s
	iters: 300, epoch: 2 | loss: 0.2727497
	speed: 0.0079s/iter; left time: 149.2657s
	iters: 400, epoch: 2 | loss: 0.3523684
	speed: 0.0078s/iter; left time: 148.0748s
	iters: 500, epoch: 2 | loss: 0.4715111
	speed: 0.0078s/iter; left time: 147.3068s
	iters: 600, epoch: 2 | loss: 0.4532044
	speed: 0.0084s/iter; left time: 157.5629s
	iters: 700, epoch: 2 | loss: 0.3484865
	speed: 0.0086s/iter; left time: 160.5986s
	iters: 800, epoch: 2 | loss: 0.2894002
	speed: 0.0087s/iter; left time: 159.9232s
	iters: 900, epoch: 2 | loss: 0.3606252
	speed: 0.0086s/iter; left time: 158.9269s
	iters: 1000, epoch: 2 | loss: 0.3443242
	speed: 0.0087s/iter; left time: 158.4407s
	iters: 1100, epoch: 2 | loss: 0.4002245
	speed: 0.0087s/iter; left time: 158.4061s
	iters: 1200, epoch: 2 | loss: 0.2845537
	speed: 0.0087s/iter; left time: 156.9577s
	iters: 1300, epoch: 2 | loss: 0.2874430
	speed: 0.0086s/iter; left time: 154.8722s
	iters: 1400, epoch: 2 | loss: 0.3644784
	speed: 0.0086s/iter; left time: 154.3537s
	iters: 1500, epoch: 2 | loss: 0.2992252
	speed: 0.0087s/iter; left time: 154.5565s
	iters: 1600, epoch: 2 | loss: 0.3827312
	speed: 0.0086s/iter; left time: 152.4512s
	iters: 1700, epoch: 2 | loss: 0.3356888
	speed: 0.0087s/iter; left time: 152.4659s
	iters: 1800, epoch: 2 | loss: 0.4796050
	speed: 0.0086s/iter; left time: 150.6801s
	iters: 1900, epoch: 2 | loss: 0.3292894
	speed: 0.0087s/iter; left time: 151.0315s
	iters: 2000, epoch: 2 | loss: 0.3524602
	speed: 0.0087s/iter; left time: 149.8192s
	iters: 2100, epoch: 2 | loss: 0.5407895
	speed: 0.0087s/iter; left time: 148.7830s
Epoch: 2 cost time: 18.199809789657593
Epoch: 2, Steps: 2142 | Train Loss: 0.3380650 Vali Loss: 0.5178511
Updating learning rate to 0.005
Validation loss decreased (0.5215 --> 0.5179).  Saving model state dict ...
	iters: 100, epoch: 3 | loss: 0.2590508
	speed: 0.0336s/iter; left time: 572.4298s
	iters: 200, epoch: 3 | loss: 0.3049832
	speed: 0.0077s/iter; left time: 129.5845s
	iters: 300, epoch: 3 | loss: 0.2644494
	speed: 0.0078s/iter; left time: 131.1043s
	iters: 400, epoch: 3 | loss: 0.3286469
	speed: 0.0076s/iter; left time: 126.5899s
	iters: 500, epoch: 3 | loss: 0.2734095
	speed: 0.0076s/iter; left time: 126.8013s
	iters: 600, epoch: 3 | loss: 0.2625232
	speed: 0.0078s/iter; left time: 128.4272s
	iters: 700, epoch: 3 | loss: 0.3362566
	speed: 0.0079s/iter; left time: 129.8641s
	iters: 800, epoch: 3 | loss: 0.3464388
	speed: 0.0076s/iter; left time: 124.0502s
	iters: 900, epoch: 3 | loss: 0.2837542
	speed: 0.0076s/iter; left time: 124.0906s
	iters: 1000, epoch: 3 | loss: 0.4427181
	speed: 0.0076s/iter; left time: 123.3094s
	iters: 1100, epoch: 3 | loss: 0.4186685
	speed: 0.0076s/iter; left time: 122.1249s
	iters: 1200, epoch: 3 | loss: 0.3357162
	speed: 0.0077s/iter; left time: 122.8574s
	iters: 1300, epoch: 3 | loss: 0.3442716
	speed: 0.0077s/iter; left time: 121.6080s
	iters: 1400, epoch: 3 | loss: 0.3884625
	speed: 0.0077s/iter; left time: 121.3071s
	iters: 1500, epoch: 3 | loss: 0.2533962
	speed: 0.0077s/iter; left time: 120.0315s
	iters: 1600, epoch: 3 | loss: 0.2127892
	speed: 0.0078s/iter; left time: 120.8837s
	iters: 1700, epoch: 3 | loss: 0.5284874
	speed: 0.0077s/iter; left time: 119.3329s
	iters: 1800, epoch: 3 | loss: 0.3058479
	speed: 0.0077s/iter; left time: 118.4068s
	iters: 1900, epoch: 3 | loss: 0.2847314
	speed: 0.0077s/iter; left time: 117.5082s
	iters: 2000, epoch: 3 | loss: 0.4504587
	speed: 0.0077s/iter; left time: 116.9782s
	iters: 2100, epoch: 3 | loss: 0.3430746
	speed: 0.0077s/iter; left time: 116.1904s
Epoch: 3 cost time: 16.54120969772339
Epoch: 3, Steps: 2142 | Train Loss: 0.3133475 Vali Loss: 0.5196822
Updating learning rate to 0.0025
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2541834
	speed: 0.0336s/iter; left time: 500.1244s
	iters: 200, epoch: 4 | loss: 0.3115687
	speed: 0.0087s/iter; left time: 128.6243s
	iters: 300, epoch: 4 | loss: 0.3325717
	speed: 0.0087s/iter; left time: 127.3054s
	iters: 400, epoch: 4 | loss: 0.3266077
	speed: 0.0087s/iter; left time: 127.2371s
	iters: 500, epoch: 4 | loss: 0.3083309
	speed: 0.0087s/iter; left time: 126.3346s
	iters: 600, epoch: 4 | loss: 0.2827065
	speed: 0.0088s/iter; left time: 126.3361s
	iters: 700, epoch: 4 | loss: 0.2372973
	speed: 0.0087s/iter; left time: 124.8194s
	iters: 800, epoch: 4 | loss: 0.3555698
	speed: 0.0084s/iter; left time: 119.5962s
	iters: 900, epoch: 4 | loss: 0.2356533
	speed: 0.0080s/iter; left time: 112.6195s
	iters: 1000, epoch: 4 | loss: 0.2325580
	speed: 0.0080s/iter; left time: 111.9246s
	iters: 1100, epoch: 4 | loss: 0.2456617
	speed: 0.0080s/iter; left time: 110.8181s
	iters: 1200, epoch: 4 | loss: 0.2663018
	speed: 0.0079s/iter; left time: 109.4448s
	iters: 1300, epoch: 4 | loss: 0.2624372
	speed: 0.0078s/iter; left time: 107.3579s
	iters: 1400, epoch: 4 | loss: 0.2756495
	speed: 0.0078s/iter; left time: 106.6974s
	iters: 1500, epoch: 4 | loss: 0.3161885
	speed: 0.0078s/iter; left time: 105.8768s
	iters: 1600, epoch: 4 | loss: 0.4082555
	speed: 0.0078s/iter; left time: 104.9105s
	iters: 1700, epoch: 4 | loss: 0.3894431
	speed: 0.0079s/iter; left time: 104.8922s
	iters: 1800, epoch: 4 | loss: 0.3002222
	speed: 0.0079s/iter; left time: 103.6106s
	iters: 1900, epoch: 4 | loss: 0.2962705
	speed: 0.0078s/iter; left time: 102.7625s
	iters: 2000, epoch: 4 | loss: 0.1922911
	speed: 0.0079s/iter; left time: 102.1413s
	iters: 2100, epoch: 4 | loss: 0.3226510
	speed: 0.0078s/iter; left time: 100.9560s
Epoch: 4 cost time: 17.597023725509644
Epoch: 4, Steps: 2142 | Train Loss: 0.3003295 Vali Loss: 0.5156750
Updating learning rate to 0.00125
Validation loss decreased (0.5179 --> 0.5157).  Saving model state dict ...
	iters: 100, epoch: 5 | loss: 0.3030360
	speed: 0.0344s/iter; left time: 438.1807s
	iters: 200, epoch: 5 | loss: 0.3355361
	speed: 0.0086s/iter; left time: 108.8049s
	iters: 300, epoch: 5 | loss: 0.2840549
	speed: 0.0080s/iter; left time: 100.2634s
	iters: 400, epoch: 5 | loss: 0.3726112
	speed: 0.0077s/iter; left time: 95.8999s
	iters: 500, epoch: 5 | loss: 0.2701640
	speed: 0.0077s/iter; left time: 95.3347s
	iters: 600, epoch: 5 | loss: 0.3022636
	speed: 0.0079s/iter; left time: 96.8101s
	iters: 700, epoch: 5 | loss: 0.3170625
	speed: 0.0085s/iter; left time: 102.9016s
	iters: 800, epoch: 5 | loss: 0.2943896
	speed: 0.0084s/iter; left time: 101.7101s
	iters: 900, epoch: 5 | loss: 0.3102787
	speed: 0.0084s/iter; left time: 100.8630s
	iters: 1000, epoch: 5 | loss: 0.2786883
	speed: 0.0085s/iter; left time: 100.5309s
	iters: 1100, epoch: 5 | loss: 0.3276791
	speed: 0.0085s/iter; left time: 100.0422s
	iters: 1200, epoch: 5 | loss: 0.2413136
	speed: 0.0085s/iter; left time: 98.7058s
	iters: 1300, epoch: 5 | loss: 0.2998065
	speed: 0.0084s/iter; left time: 97.4826s
	iters: 1400, epoch: 5 | loss: 0.3441631
	speed: 0.0084s/iter; left time: 96.5511s
	iters: 1500, epoch: 5 | loss: 0.3032328
	speed: 0.0085s/iter; left time: 96.1630s
	iters: 1600, epoch: 5 | loss: 0.3747331
	speed: 0.0083s/iter; left time: 93.1441s
	iters: 1700, epoch: 5 | loss: 0.3731523
	speed: 0.0077s/iter; left time: 85.8008s
	iters: 1800, epoch: 5 | loss: 0.2893236
	speed: 0.0076s/iter; left time: 84.3005s
	iters: 1900, epoch: 5 | loss: 0.2096411
	speed: 0.0077s/iter; left time: 83.9322s
	iters: 2000, epoch: 5 | loss: 0.3450015
	speed: 0.0076s/iter; left time: 82.5398s
	iters: 2100, epoch: 5 | loss: 0.3729317
	speed: 0.0077s/iter; left time: 82.5477s
Epoch: 5 cost time: 17.523797750473022
Epoch: 5, Steps: 2142 | Train Loss: 0.2922705 Vali Loss: 0.5114720
Updating learning rate to 0.000625
Validation loss decreased (0.5157 --> 0.5115).  Saving model state dict ...
	iters: 100, epoch: 6 | loss: 0.2904976
	speed: 0.0329s/iter; left time: 348.6275s
	iters: 200, epoch: 6 | loss: 0.3031544
	speed: 0.0077s/iter; left time: 80.4424s
	iters: 300, epoch: 6 | loss: 0.4422922
	speed: 0.0077s/iter; left time: 80.2420s
	iters: 400, epoch: 6 | loss: 0.3161996
	speed: 0.0077s/iter; left time: 79.3452s
	iters: 500, epoch: 6 | loss: 0.3157964
	speed: 0.0077s/iter; left time: 78.1747s
	iters: 600, epoch: 6 | loss: 0.2029037
	speed: 0.0077s/iter; left time: 78.2032s
	iters: 700, epoch: 6 | loss: 0.2369986
	speed: 0.0077s/iter; left time: 77.0486s
	iters: 800, epoch: 6 | loss: 0.2908895
	speed: 0.0078s/iter; left time: 77.2009s
	iters: 900, epoch: 6 | loss: 0.2657494
	speed: 0.0077s/iter; left time: 75.6723s
	iters: 1000, epoch: 6 | loss: 0.2021285
	speed: 0.0077s/iter; left time: 74.7992s
	iters: 1100, epoch: 6 | loss: 0.3110304
	speed: 0.0078s/iter; left time: 74.5229s
	iters: 1200, epoch: 6 | loss: 0.3231186
	speed: 0.0077s/iter; left time: 73.6110s
	iters: 1300, epoch: 6 | loss: 0.2515712
	speed: 0.0077s/iter; left time: 72.6393s
	iters: 1400, epoch: 6 | loss: 0.3190131
	speed: 0.0076s/iter; left time: 71.0655s
	iters: 1500, epoch: 6 | loss: 0.3666340
	speed: 0.0077s/iter; left time: 71.1835s
	iters: 1600, epoch: 6 | loss: 0.4253750
	speed: 0.0077s/iter; left time: 70.0903s
	iters: 1700, epoch: 6 | loss: 0.2707204
	speed: 0.0077s/iter; left time: 69.7197s
	iters: 1800, epoch: 6 | loss: 0.2139235
	speed: 0.0077s/iter; left time: 68.5459s
	iters: 1900, epoch: 6 | loss: 0.2976253
	speed: 0.0077s/iter; left time: 67.5226s
	iters: 2000, epoch: 6 | loss: 0.2504320
	speed: 0.0076s/iter; left time: 66.0070s
	iters: 2100, epoch: 6 | loss: 0.2372440
	speed: 0.0076s/iter; left time: 65.6481s
Epoch: 6 cost time: 16.55218482017517
Epoch: 6, Steps: 2142 | Train Loss: 0.2869384 Vali Loss: 0.5160075
Updating learning rate to 0.0003125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2918803
	speed: 0.0329s/iter; left time: 278.9565s
	iters: 200, epoch: 7 | loss: 0.2892129
	speed: 0.0077s/iter; left time: 64.2680s
	iters: 300, epoch: 7 | loss: 0.3127607
	speed: 0.0076s/iter; left time: 62.8613s
	iters: 400, epoch: 7 | loss: 0.3550993
	speed: 0.0073s/iter; left time: 59.8905s
	iters: 500, epoch: 7 | loss: 0.3153928
	speed: 0.0073s/iter; left time: 59.1436s
	iters: 600, epoch: 7 | loss: 0.2092561
	speed: 0.0079s/iter; left time: 62.6339s
	iters: 700, epoch: 7 | loss: 0.2570473
	speed: 0.0074s/iter; left time: 58.2785s
	iters: 800, epoch: 7 | loss: 0.2744969
	speed: 0.0073s/iter; left time: 56.8666s
	iters: 900, epoch: 7 | loss: 0.4015795
	speed: 0.0073s/iter; left time: 56.0364s
	iters: 1000, epoch: 7 | loss: 0.2567763
	speed: 0.0076s/iter; left time: 57.6422s
	iters: 1100, epoch: 7 | loss: 0.3330114
	speed: 0.0078s/iter; left time: 58.0638s
	iters: 1200, epoch: 7 | loss: 0.2365115
	speed: 0.0078s/iter; left time: 57.3755s
	iters: 1300, epoch: 7 | loss: 0.3115372
	speed: 0.0077s/iter; left time: 56.2243s
	iters: 1400, epoch: 7 | loss: 0.2144212
	speed: 0.0078s/iter; left time: 55.6059s
	iters: 1500, epoch: 7 | loss: 0.2561107
	speed: 0.0078s/iter; left time: 55.1802s
	iters: 1600, epoch: 7 | loss: 0.3182254
	speed: 0.0078s/iter; left time: 54.3763s
	iters: 1700, epoch: 7 | loss: 0.2231792
	speed: 0.0079s/iter; left time: 53.9500s
	iters: 1800, epoch: 7 | loss: 0.3250820
	speed: 0.0078s/iter; left time: 52.5628s
	iters: 1900, epoch: 7 | loss: 0.3212971
	speed: 0.0078s/iter; left time: 51.8260s
	iters: 2000, epoch: 7 | loss: 0.2655434
	speed: 0.0078s/iter; left time: 51.2305s
	iters: 2100, epoch: 7 | loss: 0.2581258
	speed: 0.0078s/iter; left time: 50.6686s
Epoch: 7 cost time: 16.451879739761353
Epoch: 7, Steps: 2142 | Train Loss: 0.2839688 Vali Loss: 0.5144045
Updating learning rate to 0.00015625
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2202169
	speed: 0.0328s/iter; left time: 207.5866s
	iters: 200, epoch: 8 | loss: 0.4195685
	speed: 0.0076s/iter; left time: 47.5418s
	iters: 300, epoch: 8 | loss: 0.3526151
	speed: 0.0077s/iter; left time: 47.0718s
	iters: 400, epoch: 8 | loss: 0.2147725
	speed: 0.0076s/iter; left time: 46.0850s
	iters: 500, epoch: 8 | loss: 0.2620666
	speed: 0.0077s/iter; left time: 45.4271s
	iters: 600, epoch: 8 | loss: 0.2044166
	speed: 0.0076s/iter; left time: 44.1802s
	iters: 700, epoch: 8 | loss: 0.2979328
	speed: 0.0075s/iter; left time: 42.9876s
	iters: 800, epoch: 8 | loss: 0.3401217
	speed: 0.0075s/iter; left time: 42.3712s
	iters: 900, epoch: 8 | loss: 0.3205057
	speed: 0.0076s/iter; left time: 41.9313s
	iters: 1000, epoch: 8 | loss: 0.2013278
	speed: 0.0076s/iter; left time: 41.1017s
	iters: 1100, epoch: 8 | loss: 0.4016696
	speed: 0.0075s/iter; left time: 40.1109s
	iters: 1200, epoch: 8 | loss: 0.3409997
	speed: 0.0076s/iter; left time: 39.6352s
	iters: 1300, epoch: 8 | loss: 0.2079310
	speed: 0.0076s/iter; left time: 38.9634s
	iters: 1400, epoch: 8 | loss: 0.3401509
	speed: 0.0077s/iter; left time: 38.4604s
	iters: 1500, epoch: 8 | loss: 0.2682852
	speed: 0.0076s/iter; left time: 37.5734s
	iters: 1600, epoch: 8 | loss: 0.2699187
	speed: 0.0076s/iter; left time: 36.8016s
	iters: 1700, epoch: 8 | loss: 0.2521942
	speed: 0.0076s/iter; left time: 35.7149s
	iters: 1800, epoch: 8 | loss: 0.4094769
	speed: 0.0076s/iter; left time: 35.1988s
	iters: 1900, epoch: 8 | loss: 0.3018880
	speed: 0.0076s/iter; left time: 34.2208s
	iters: 2000, epoch: 8 | loss: 0.3060274
	speed: 0.0075s/iter; left time: 33.3981s
	iters: 2100, epoch: 8 | loss: 0.3417913
	speed: 0.0076s/iter; left time: 32.7242s
Epoch: 8 cost time: 16.355297565460205
Epoch: 8, Steps: 2142 | Train Loss: 0.2825160 Vali Loss: 0.5173983
Updating learning rate to 7.8125e-05
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2636814
	speed: 0.0323s/iter; left time: 135.1901s
	iters: 200, epoch: 9 | loss: 0.2682378
	speed: 0.0077s/iter; left time: 31.4974s
	iters: 300, epoch: 9 | loss: 0.2226368
	speed: 0.0074s/iter; left time: 29.4057s
	iters: 400, epoch: 9 | loss: 0.4190010
	speed: 0.0077s/iter; left time: 29.7315s
	iters: 500, epoch: 9 | loss: 0.2925827
	speed: 0.0076s/iter; left time: 28.9144s
	iters: 600, epoch: 9 | loss: 0.3489372
	speed: 0.0075s/iter; left time: 27.7274s
	iters: 700, epoch: 9 | loss: 0.2261344
	speed: 0.0074s/iter; left time: 26.4448s
	iters: 800, epoch: 9 | loss: 0.3337649
	speed: 0.0077s/iter; left time: 26.7486s
	iters: 900, epoch: 9 | loss: 0.2314922
	speed: 0.0077s/iter; left time: 26.0682s
	iters: 1000, epoch: 9 | loss: 0.2371396
	speed: 0.0077s/iter; left time: 25.4187s
	iters: 1100, epoch: 9 | loss: 0.2060860
	speed: 0.0077s/iter; left time: 24.5933s
	iters: 1200, epoch: 9 | loss: 0.2773934
	speed: 0.0077s/iter; left time: 23.8050s
	iters: 1300, epoch: 9 | loss: 0.2101930
	speed: 0.0077s/iter; left time: 23.0408s
	iters: 1400, epoch: 9 | loss: 0.4159067
	speed: 0.0077s/iter; left time: 22.1823s
	iters: 1500, epoch: 9 | loss: 0.3295524
	speed: 0.0077s/iter; left time: 21.4612s
	iters: 1600, epoch: 9 | loss: 0.2639361
	speed: 0.0077s/iter; left time: 20.7646s
	iters: 1700, epoch: 9 | loss: 0.3274070
	speed: 0.0077s/iter; left time: 19.9765s
	iters: 1800, epoch: 9 | loss: 0.2372970
	speed: 0.0077s/iter; left time: 19.1448s
	iters: 1900, epoch: 9 | loss: 0.3421798
	speed: 0.0077s/iter; left time: 18.3590s
	iters: 2000, epoch: 9 | loss: 0.3572942
	speed: 0.0077s/iter; left time: 17.6711s
	iters: 2100, epoch: 9 | loss: 0.3175755
	speed: 0.0078s/iter; left time: 17.0397s
Epoch: 9 cost time: 16.476316213607788
Epoch: 9, Steps: 2142 | Train Loss: 0.2815722 Vali Loss: 0.5202181
Updating learning rate to 3.90625e-05
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2577920
	speed: 0.0325s/iter; left time: 66.3902s
	iters: 200, epoch: 10 | loss: 0.1842339
	speed: 0.0075s/iter; left time: 14.5022s
	iters: 300, epoch: 10 | loss: 0.2587804
	speed: 0.0075s/iter; left time: 13.7623s
	iters: 400, epoch: 10 | loss: 0.2987137
	speed: 0.0075s/iter; left time: 13.0512s
	iters: 500, epoch: 10 | loss: 0.3391487
	speed: 0.0076s/iter; left time: 12.4147s
	iters: 600, epoch: 10 | loss: 0.2232293
	speed: 0.0076s/iter; left time: 11.7150s
	iters: 700, epoch: 10 | loss: 0.2348198
	speed: 0.0074s/iter; left time: 10.7250s
	iters: 800, epoch: 10 | loss: 0.2080976
	speed: 0.0075s/iter; left time: 10.0519s
	iters: 900, epoch: 10 | loss: 0.3196849
	speed: 0.0076s/iter; left time: 9.4161s
	iters: 1000, epoch: 10 | loss: 0.2347426
	speed: 0.0075s/iter; left time: 8.6282s
	iters: 1100, epoch: 10 | loss: 0.2628396
	speed: 0.0077s/iter; left time: 8.0403s
	iters: 1200, epoch: 10 | loss: 0.2988558
	speed: 0.0077s/iter; left time: 7.2464s
	iters: 1300, epoch: 10 | loss: 0.2580607
	speed: 0.0077s/iter; left time: 6.4660s
	iters: 1400, epoch: 10 | loss: 0.3098414
	speed: 0.0076s/iter; left time: 5.6477s
	iters: 1500, epoch: 10 | loss: 0.3095207
	speed: 0.0077s/iter; left time: 4.9440s
	iters: 1600, epoch: 10 | loss: 0.3063191
	speed: 0.0076s/iter; left time: 4.1526s
	iters: 1700, epoch: 10 | loss: 0.4290669
	speed: 0.0076s/iter; left time: 3.3776s
	iters: 1800, epoch: 10 | loss: 0.2551519
	speed: 0.0076s/iter; left time: 2.6133s
	iters: 1900, epoch: 10 | loss: 0.3115951
	speed: 0.0076s/iter; left time: 1.8587s
	iters: 2000, epoch: 10 | loss: 0.2838806
	speed: 0.0077s/iter; left time: 1.0972s
	iters: 2100, epoch: 10 | loss: 0.2246912
	speed: 0.0076s/iter; left time: 0.3250s
Epoch: 10 cost time: 16.323658227920532
Epoch: 10, Steps: 2142 | Train Loss: 0.2811705 Vali Loss: 0.5186011
Updating learning rate to 1.953125e-05
EarlyStopping counter: 5 out of 10
#####   loading best weights   #####
Process: python3 (PID: 540787) is using 394 MiB of GPU memory.
Epoch: 10 | Elapsed Time: 1068.4233722686768 s | VRAM usage: 0.384765625 Gb | Train MSE: 0.2857 Train MAE: 0.3643 Vali MSE: 0.5115 Vali MAE: 0.4767 Test MSE: 0.3637 Test MAE: 0.3838



Args in experiment:
Namespace(model='TimeMixer', task_name='long_term_forecast', seed=2021, data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', train_prop=1.0, seq_len=96, label_len=0, pred_len=336, seasonal_patterns='Monthly', inverse=False, enc_in=7, dec_in=7, c_out=7, decomp_method='moving_avg', top_k=5, moving_avg=25, d_model=16, d_ff=32, e_layers=2, dropout=0.1, embed='timeF', channel_independence=1, use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, output_attention=False, num_workers=4, train_epochs=10, batch_size=16, patience=10, delta=0.0, learning_rate=0.01, des='test', loss='MSE', lradj='type1', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_dir='./checkpoints/baseline/reproduction/ETTm1_96_336', save_last=False, break_at=0)
Use GPU: cuda:0
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3950634
	speed: 0.0142s/iter; left time: 300.5340s
	iters: 200, epoch: 1 | loss: 0.3452445
	speed: 0.0086s/iter; left time: 180.8564s
	iters: 300, epoch: 1 | loss: 0.5313392
	speed: 0.0086s/iter; left time: 180.1437s
	iters: 400, epoch: 1 | loss: 0.4902233
	speed: 0.0086s/iter; left time: 180.7591s
	iters: 500, epoch: 1 | loss: 0.3449630
	speed: 0.0087s/iter; left time: 181.0684s
	iters: 600, epoch: 1 | loss: 0.4806404
	speed: 0.0086s/iter; left time: 178.1833s
	iters: 700, epoch: 1 | loss: 0.3510023
	speed: 0.0086s/iter; left time: 178.0316s
	iters: 800, epoch: 1 | loss: 0.3641350
	speed: 0.0085s/iter; left time: 175.0445s
	iters: 900, epoch: 1 | loss: 0.4497265
	speed: 0.0079s/iter; left time: 161.1968s
	iters: 1000, epoch: 1 | loss: 0.3675171
	speed: 0.0079s/iter; left time: 159.7679s
	iters: 1100, epoch: 1 | loss: 0.3916070
	speed: 0.0077s/iter; left time: 156.5358s
	iters: 1200, epoch: 1 | loss: 0.4201820
	speed: 0.0075s/iter; left time: 151.4962s
	iters: 1300, epoch: 1 | loss: 0.3568658
	speed: 0.0076s/iter; left time: 151.3030s
	iters: 1400, epoch: 1 | loss: 0.3998430
	speed: 0.0075s/iter; left time: 149.1685s
	iters: 1500, epoch: 1 | loss: 0.3902168
	speed: 0.0075s/iter; left time: 148.5784s
	iters: 1600, epoch: 1 | loss: 0.3420797
	speed: 0.0075s/iter; left time: 148.6754s
	iters: 1700, epoch: 1 | loss: 0.3902625
	speed: 0.0076s/iter; left time: 148.3073s
	iters: 1800, epoch: 1 | loss: 0.3700998
	speed: 0.0075s/iter; left time: 146.6630s
	iters: 1900, epoch: 1 | loss: 0.4511524
	speed: 0.0076s/iter; left time: 147.0228s
	iters: 2000, epoch: 1 | loss: 0.3579194
	speed: 0.0075s/iter; left time: 145.6280s
	iters: 2100, epoch: 1 | loss: 0.3868796
	speed: 0.0076s/iter; left time: 146.2808s
Epoch: 1 cost time: 17.323338270187378
Epoch: 1, Steps: 2133 | Train Loss: 0.4241119 Vali Loss: 0.6791951
Updating learning rate to 0.01
Validation loss decreased (inf --> 0.6792).  Saving model state dict ...
	iters: 100, epoch: 2 | loss: 0.4554310
	speed: 0.0320s/iter; left time: 610.6811s
	iters: 200, epoch: 2 | loss: 0.4295256
	speed: 0.0078s/iter; left time: 147.2960s
	iters: 300, epoch: 2 | loss: 0.2943486
	speed: 0.0077s/iter; left time: 144.7768s
	iters: 400, epoch: 2 | loss: 0.3752084
	speed: 0.0077s/iter; left time: 144.6485s
	iters: 500, epoch: 2 | loss: 0.5193471
	speed: 0.0076s/iter; left time: 142.8497s
	iters: 600, epoch: 2 | loss: 0.2647157
	speed: 0.0078s/iter; left time: 144.9322s
	iters: 700, epoch: 2 | loss: 0.3217877
	speed: 0.0077s/iter; left time: 143.2022s
	iters: 800, epoch: 2 | loss: 0.3754054
	speed: 0.0076s/iter; left time: 140.2123s
	iters: 900, epoch: 2 | loss: 0.3519716
	speed: 0.0076s/iter; left time: 138.3968s
	iters: 1000, epoch: 2 | loss: 0.3649327
	speed: 0.0079s/iter; left time: 144.6462s
	iters: 1100, epoch: 2 | loss: 0.4215831
	speed: 0.0087s/iter; left time: 157.0190s
	iters: 1200, epoch: 2 | loss: 0.4139446
	speed: 0.0086s/iter; left time: 154.0844s
	iters: 1300, epoch: 2 | loss: 0.3276277
	speed: 0.0086s/iter; left time: 153.2851s
	iters: 1400, epoch: 2 | loss: 0.3326591
	speed: 0.0086s/iter; left time: 153.3295s
	iters: 1500, epoch: 2 | loss: 0.2951032
	speed: 0.0084s/iter; left time: 148.7572s
	iters: 1600, epoch: 2 | loss: 0.3504653
	speed: 0.0084s/iter; left time: 147.5651s
	iters: 1700, epoch: 2 | loss: 0.3338399
	speed: 0.0077s/iter; left time: 135.2203s
	iters: 1800, epoch: 2 | loss: 0.5447809
	speed: 0.0077s/iter; left time: 134.1493s
	iters: 1900, epoch: 2 | loss: 0.3554828
	speed: 0.0077s/iter; left time: 132.9951s
	iters: 2000, epoch: 2 | loss: 0.3569066
	speed: 0.0077s/iter; left time: 132.6518s
	iters: 2100, epoch: 2 | loss: 0.4355046
	speed: 0.0078s/iter; left time: 133.8568s
Epoch: 2 cost time: 17.023927688598633
Epoch: 2, Steps: 2133 | Train Loss: 0.3869370 Vali Loss: 0.6553888
Updating learning rate to 0.005
Validation loss decreased (0.6792 --> 0.6554).  Saving model state dict ...
	iters: 100, epoch: 3 | loss: 0.3802195
	speed: 0.0329s/iter; left time: 558.8597s
	iters: 200, epoch: 3 | loss: 0.3529603
	speed: 0.0078s/iter; left time: 132.0398s
	iters: 300, epoch: 3 | loss: 0.2955439
	speed: 0.0078s/iter; left time: 130.0346s
	iters: 400, epoch: 3 | loss: 0.3150511
	speed: 0.0078s/iter; left time: 129.9980s
	iters: 500, epoch: 3 | loss: 0.3172130
	speed: 0.0079s/iter; left time: 130.2075s
	iters: 600, epoch: 3 | loss: 0.4001651
	speed: 0.0079s/iter; left time: 130.6654s
	iters: 700, epoch: 3 | loss: 0.3466663
	speed: 0.0079s/iter; left time: 130.0817s
	iters: 800, epoch: 3 | loss: 0.4996499
	speed: 0.0079s/iter; left time: 128.5337s
	iters: 900, epoch: 3 | loss: 0.5753962
	speed: 0.0078s/iter; left time: 126.1917s
	iters: 1000, epoch: 3 | loss: 0.4139561
	speed: 0.0078s/iter; left time: 125.8330s
	iters: 1100, epoch: 3 | loss: 0.3158541
	speed: 0.0078s/iter; left time: 124.1519s
	iters: 1200, epoch: 3 | loss: 0.2934395
	speed: 0.0077s/iter; left time: 122.8432s
	iters: 1300, epoch: 3 | loss: 0.3332058
	speed: 0.0077s/iter; left time: 121.9407s
	iters: 1400, epoch: 3 | loss: 0.3455771
	speed: 0.0078s/iter; left time: 122.8819s
	iters: 1500, epoch: 3 | loss: 0.3881911
	speed: 0.0077s/iter; left time: 120.5940s
	iters: 1600, epoch: 3 | loss: 0.3247524
	speed: 0.0077s/iter; left time: 119.7567s
	iters: 1700, epoch: 3 | loss: 0.4162141
	speed: 0.0077s/iter; left time: 118.3904s
	iters: 1800, epoch: 3 | loss: 0.3408826
	speed: 0.0077s/iter; left time: 117.4011s
	iters: 1900, epoch: 3 | loss: 0.5706334
	speed: 0.0077s/iter; left time: 117.2260s
	iters: 2000, epoch: 3 | loss: 0.3076578
	speed: 0.0078s/iter; left time: 118.1243s
	iters: 2100, epoch: 3 | loss: 0.4497736
	speed: 0.0077s/iter; left time: 114.9701s
Epoch: 3 cost time: 16.703124523162842
Epoch: 3, Steps: 2133 | Train Loss: 0.3645133 Vali Loss: 0.6540720
Updating learning rate to 0.0025
Validation loss decreased (0.6554 --> 0.6541).  Saving model state dict ...
	iters: 100, epoch: 4 | loss: 0.2838617
	speed: 0.0330s/iter; left time: 488.7885s
	iters: 200, epoch: 4 | loss: 0.2774566
	speed: 0.0078s/iter; left time: 114.2145s
	iters: 300, epoch: 4 | loss: 0.2772134
	speed: 0.0077s/iter; left time: 112.5376s
	iters: 400, epoch: 4 | loss: 0.4165106
	speed: 0.0077s/iter; left time: 111.7492s
	iters: 500, epoch: 4 | loss: 0.4925339
	speed: 0.0077s/iter; left time: 111.1099s
	iters: 600, epoch: 4 | loss: 0.2978371
	speed: 0.0077s/iter; left time: 110.2075s
	iters: 700, epoch: 4 | loss: 0.3651444
	speed: 0.0076s/iter; left time: 108.5323s
	iters: 800, epoch: 4 | loss: 0.2638449
	speed: 0.0076s/iter; left time: 107.8577s
	iters: 900, epoch: 4 | loss: 0.3341230
	speed: 0.0076s/iter; left time: 105.9436s
	iters: 1000, epoch: 4 | loss: 0.3161648
	speed: 0.0076s/iter; left time: 105.7697s
	iters: 1100, epoch: 4 | loss: 0.3488551
	speed: 0.0076s/iter; left time: 104.8644s
	iters: 1200, epoch: 4 | loss: 0.5252190
	speed: 0.0076s/iter; left time: 104.3606s
	iters: 1300, epoch: 4 | loss: 0.2936023
	speed: 0.0075s/iter; left time: 102.8214s
	iters: 1400, epoch: 4 | loss: 0.3966105
	speed: 0.0076s/iter; left time: 102.4975s
	iters: 1500, epoch: 4 | loss: 0.2894527
	speed: 0.0078s/iter; left time: 105.0027s
	iters: 1600, epoch: 4 | loss: 0.4846112
	speed: 0.0078s/iter; left time: 103.4640s
	iters: 1700, epoch: 4 | loss: 0.3397149
	speed: 0.0076s/iter; left time: 100.2101s
	iters: 1800, epoch: 4 | loss: 0.3783833
	speed: 0.0076s/iter; left time: 99.4201s
	iters: 1900, epoch: 4 | loss: 0.3198275
	speed: 0.0076s/iter; left time: 99.6714s
	iters: 2000, epoch: 4 | loss: 0.4774787
	speed: 0.0078s/iter; left time: 100.4291s
	iters: 2100, epoch: 4 | loss: 0.3305764
	speed: 0.0076s/iter; left time: 97.3190s
Epoch: 4 cost time: 16.42066264152527
Epoch: 4, Steps: 2133 | Train Loss: 0.3526651 Vali Loss: 0.6644496
Updating learning rate to 0.00125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5235950
	speed: 0.0322s/iter; left time: 408.5499s
	iters: 200, epoch: 5 | loss: 0.3104678
	speed: 0.0075s/iter; left time: 94.8371s
	iters: 300, epoch: 5 | loss: 0.3283816
	speed: 0.0074s/iter; left time: 93.0924s
	iters: 400, epoch: 5 | loss: 0.4369656
	speed: 0.0076s/iter; left time: 93.8280s
	iters: 500, epoch: 5 | loss: 0.2958903
	speed: 0.0075s/iter; left time: 91.6879s
	iters: 600, epoch: 5 | loss: 0.3886131
	speed: 0.0075s/iter; left time: 91.6362s
	iters: 700, epoch: 5 | loss: 0.4973691
	speed: 0.0076s/iter; left time: 92.0909s
	iters: 800, epoch: 5 | loss: 0.3039933
	speed: 0.0075s/iter; left time: 89.9161s
	iters: 900, epoch: 5 | loss: 0.2949947
	speed: 0.0075s/iter; left time: 89.4364s
	iters: 1000, epoch: 5 | loss: 0.4491015
	speed: 0.0076s/iter; left time: 90.1411s
	iters: 1100, epoch: 5 | loss: 0.4391368
	speed: 0.0076s/iter; left time: 88.5724s
	iters: 1200, epoch: 5 | loss: 0.3295989
	speed: 0.0076s/iter; left time: 87.9685s
	iters: 1300, epoch: 5 | loss: 0.3075397
	speed: 0.0074s/iter; left time: 85.2188s
	iters: 1400, epoch: 5 | loss: 0.3069847
	speed: 0.0074s/iter; left time: 84.7210s
	iters: 1500, epoch: 5 | loss: 0.4421225
	speed: 0.0074s/iter; left time: 83.3938s
	iters: 1600, epoch: 5 | loss: 0.3564741
	speed: 0.0074s/iter; left time: 83.2287s
	iters: 1700, epoch: 5 | loss: 0.3212191
	speed: 0.0075s/iter; left time: 83.3573s
	iters: 1800, epoch: 5 | loss: 0.4028285
	speed: 0.0075s/iter; left time: 82.8073s
	iters: 1900, epoch: 5 | loss: 0.3387896
	speed: 0.0075s/iter; left time: 81.5049s
	iters: 2000, epoch: 5 | loss: 0.3005876
	speed: 0.0075s/iter; left time: 81.1650s
	iters: 2100, epoch: 5 | loss: 0.3756357
	speed: 0.0075s/iter; left time: 79.9427s
Epoch: 5 cost time: 16.086634159088135
Epoch: 5, Steps: 2133 | Train Loss: 0.3445505 Vali Loss: 0.6557627
Updating learning rate to 0.000625
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3269629
	speed: 0.0332s/iter; left time: 350.3303s
	iters: 200, epoch: 6 | loss: 0.4044074
	speed: 0.0076s/iter; left time: 79.8704s
	iters: 300, epoch: 6 | loss: 0.2677045
	speed: 0.0076s/iter; left time: 78.9293s
	iters: 400, epoch: 6 | loss: 0.3466377
	speed: 0.0076s/iter; left time: 78.3427s
	iters: 500, epoch: 6 | loss: 0.4160917
	speed: 0.0077s/iter; left time: 78.3397s
	iters: 600, epoch: 6 | loss: 0.3928167
	speed: 0.0077s/iter; left time: 77.3583s
	iters: 700, epoch: 6 | loss: 0.4622796
	speed: 0.0077s/iter; left time: 76.8157s
	iters: 800, epoch: 6 | loss: 0.3210738
	speed: 0.0076s/iter; left time: 75.2528s
	iters: 900, epoch: 6 | loss: 0.4603103
	speed: 0.0077s/iter; left time: 74.9389s
	iters: 1000, epoch: 6 | loss: 0.3164984
	speed: 0.0077s/iter; left time: 74.3369s
	iters: 1100, epoch: 6 | loss: 0.2701857
	speed: 0.0077s/iter; left time: 73.7217s
	iters: 1200, epoch: 6 | loss: 0.2918060
	speed: 0.0077s/iter; left time: 72.7685s
	iters: 1300, epoch: 6 | loss: 0.2865960
	speed: 0.0078s/iter; left time: 72.6695s
	iters: 1400, epoch: 6 | loss: 0.2757023
	speed: 0.0077s/iter; left time: 71.5149s
	iters: 1500, epoch: 6 | loss: 0.3598466
	speed: 0.0077s/iter; left time: 70.8777s
	iters: 1600, epoch: 6 | loss: 0.2826799
	speed: 0.0077s/iter; left time: 69.7843s
	iters: 1700, epoch: 6 | loss: 0.3333883
	speed: 0.0077s/iter; left time: 69.0478s
	iters: 1800, epoch: 6 | loss: 0.3466217
	speed: 0.0077s/iter; left time: 67.9127s
	iters: 1900, epoch: 6 | loss: 0.2734849
	speed: 0.0077s/iter; left time: 67.3185s
	iters: 2000, epoch: 6 | loss: 0.2847442
	speed: 0.0077s/iter; left time: 66.9925s
	iters: 2100, epoch: 6 | loss: 0.2543772
	speed: 0.0077s/iter; left time: 66.0147s
Epoch: 6 cost time: 16.47956371307373
Epoch: 6, Steps: 2133 | Train Loss: 0.3393328 Vali Loss: 0.6595010
Updating learning rate to 0.0003125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2902115
	speed: 0.0326s/iter; left time: 275.0940s
	iters: 200, epoch: 7 | loss: 0.2792312
	speed: 0.0083s/iter; left time: 69.5555s
	iters: 300, epoch: 7 | loss: 0.3516737
	speed: 0.0082s/iter; left time: 67.4529s
	iters: 400, epoch: 7 | loss: 0.3846624
	speed: 0.0083s/iter; left time: 67.5489s
	iters: 500, epoch: 7 | loss: 0.3063743
	speed: 0.0079s/iter; left time: 63.7192s
	iters: 600, epoch: 7 | loss: 0.3034776
	speed: 0.0075s/iter; left time: 59.5189s
	iters: 700, epoch: 7 | loss: 0.3100968
	speed: 0.0075s/iter; left time: 59.0636s
	iters: 800, epoch: 7 | loss: 0.3014495
	speed: 0.0076s/iter; left time: 58.4355s
	iters: 900, epoch: 7 | loss: 0.4304410
	speed: 0.0078s/iter; left time: 59.2318s
	iters: 1000, epoch: 7 | loss: 0.3115195
	speed: 0.0077s/iter; left time: 57.7548s
	iters: 1100, epoch: 7 | loss: 0.2746782
	speed: 0.0076s/iter; left time: 56.8584s
	iters: 1200, epoch: 7 | loss: 0.2992272
	speed: 0.0077s/iter; left time: 56.5782s
	iters: 1300, epoch: 7 | loss: 0.3603942
	speed: 0.0077s/iter; left time: 55.8538s
	iters: 1400, epoch: 7 | loss: 0.4892946
	speed: 0.0078s/iter; left time: 55.2954s
	iters: 1500, epoch: 7 | loss: 0.2865527
	speed: 0.0076s/iter; left time: 53.7070s
	iters: 1600, epoch: 7 | loss: 0.3327692
	speed: 0.0076s/iter; left time: 52.9597s
	iters: 1700, epoch: 7 | loss: 0.3536144
	speed: 0.0077s/iter; left time: 52.6391s
	iters: 1800, epoch: 7 | loss: 0.2808525
	speed: 0.0077s/iter; left time: 51.8469s
	iters: 1900, epoch: 7 | loss: 0.3012674
	speed: 0.0077s/iter; left time: 51.3112s
	iters: 2000, epoch: 7 | loss: 0.3689277
	speed: 0.0076s/iter; left time: 49.4173s
	iters: 2100, epoch: 7 | loss: 0.2883375
	speed: 0.0076s/iter; left time: 48.8289s
Epoch: 7 cost time: 16.711191415786743
Epoch: 7, Steps: 2133 | Train Loss: 0.3364041 Vali Loss: 0.6569542
Updating learning rate to 0.00015625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.3287756
	speed: 0.0319s/iter; left time: 200.9862s
	iters: 200, epoch: 8 | loss: 0.3772993
	speed: 0.0077s/iter; left time: 47.6084s
	iters: 300, epoch: 8 | loss: 0.3004037
	speed: 0.0077s/iter; left time: 47.1350s
	iters: 400, epoch: 8 | loss: 0.2720298
	speed: 0.0077s/iter; left time: 46.2757s
	iters: 500, epoch: 8 | loss: 0.3016873
	speed: 0.0077s/iter; left time: 45.5241s
	iters: 600, epoch: 8 | loss: 0.2932617
	speed: 0.0079s/iter; left time: 45.9356s
	iters: 700, epoch: 8 | loss: 0.3441130
	speed: 0.0077s/iter; left time: 44.1731s
	iters: 800, epoch: 8 | loss: 0.3839564
	speed: 0.0078s/iter; left time: 43.4934s
	iters: 900, epoch: 8 | loss: 0.2866465
	speed: 0.0078s/iter; left time: 42.7432s
	iters: 1000, epoch: 8 | loss: 0.2434486
	speed: 0.0077s/iter; left time: 41.5585s
	iters: 1100, epoch: 8 | loss: 0.2963432
	speed: 0.0077s/iter; left time: 40.9029s
	iters: 1200, epoch: 8 | loss: 0.2937050
	speed: 0.0078s/iter; left time: 40.4341s
	iters: 1300, epoch: 8 | loss: 0.2693974
	speed: 0.0078s/iter; left time: 39.5760s
	iters: 1400, epoch: 8 | loss: 0.3245503
	speed: 0.0077s/iter; left time: 38.4280s
	iters: 1500, epoch: 8 | loss: 0.3128649
	speed: 0.0078s/iter; left time: 38.1752s
	iters: 1600, epoch: 8 | loss: 0.3055822
	speed: 0.0079s/iter; left time: 37.8390s
	iters: 1700, epoch: 8 | loss: 0.3959021
	speed: 0.0079s/iter; left time: 36.9843s
	iters: 1800, epoch: 8 | loss: 0.2989403
	speed: 0.0079s/iter; left time: 36.1133s
	iters: 1900, epoch: 8 | loss: 0.2856157
	speed: 0.0079s/iter; left time: 35.3714s
	iters: 2000, epoch: 8 | loss: 0.3539236
	speed: 0.0079s/iter; left time: 34.8729s
	iters: 2100, epoch: 8 | loss: 0.2287636
	speed: 0.0078s/iter; left time: 33.4224s
Epoch: 8 cost time: 16.678504467010498
Epoch: 8, Steps: 2133 | Train Loss: 0.3347243 Vali Loss: 0.6619288
Updating learning rate to 7.8125e-05
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.2943527
	speed: 0.0333s/iter; left time: 138.5905s
	iters: 200, epoch: 9 | loss: 0.2814321
	speed: 0.0079s/iter; left time: 32.0977s
	iters: 300, epoch: 9 | loss: 0.4465810
	speed: 0.0077s/iter; left time: 30.7273s
	iters: 400, epoch: 9 | loss: 0.3057500
	speed: 0.0078s/iter; left time: 30.3392s
	iters: 500, epoch: 9 | loss: 0.3934236
	speed: 0.0079s/iter; left time: 29.8591s
	iters: 600, epoch: 9 | loss: 0.3067294
	speed: 0.0078s/iter; left time: 28.6039s
	iters: 700, epoch: 9 | loss: 0.3268466
	speed: 0.0079s/iter; left time: 28.0301s
	iters: 800, epoch: 9 | loss: 0.3710624
	speed: 0.0079s/iter; left time: 27.3426s
	iters: 900, epoch: 9 | loss: 0.2622593
	speed: 0.0078s/iter; left time: 26.2656s
	iters: 1000, epoch: 9 | loss: 0.4247098
	speed: 0.0079s/iter; left time: 25.8976s
	iters: 1100, epoch: 9 | loss: 0.2883490
	speed: 0.0079s/iter; left time: 24.8629s
	iters: 1200, epoch: 9 | loss: 0.3569189
	speed: 0.0078s/iter; left time: 24.0376s
	iters: 1300, epoch: 9 | loss: 0.3387260
	speed: 0.0078s/iter; left time: 23.1996s
	iters: 1400, epoch: 9 | loss: 0.3930264
	speed: 0.0078s/iter; left time: 22.2981s
	iters: 1500, epoch: 9 | loss: 0.3946736
	speed: 0.0078s/iter; left time: 21.5321s
	iters: 1600, epoch: 9 | loss: 0.4181060
	speed: 0.0078s/iter; left time: 20.8948s
	iters: 1700, epoch: 9 | loss: 0.2497684
	speed: 0.0080s/iter; left time: 20.5890s
	iters: 1800, epoch: 9 | loss: 0.2980521
	speed: 0.0078s/iter; left time: 19.3440s
	iters: 1900, epoch: 9 | loss: 0.4182857
	speed: 0.0078s/iter; left time: 18.5111s
	iters: 2000, epoch: 9 | loss: 0.3232565
	speed: 0.0078s/iter; left time: 17.7709s
	iters: 2100, epoch: 9 | loss: 0.3775973
	speed: 0.0078s/iter; left time: 16.9659s
Epoch: 9 cost time: 16.873477935791016
Epoch: 9, Steps: 2133 | Train Loss: 0.3340196 Vali Loss: 0.6642451
Updating learning rate to 3.90625e-05
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.3653966
	speed: 0.0330s/iter; left time: 67.1068s
	iters: 200, epoch: 10 | loss: 0.3386499
	speed: 0.0078s/iter; left time: 15.0677s
	iters: 300, epoch: 10 | loss: 0.3047810
	speed: 0.0078s/iter; left time: 14.3776s
	iters: 400, epoch: 10 | loss: 0.2923711
	speed: 0.0078s/iter; left time: 13.5728s
	iters: 500, epoch: 10 | loss: 0.2980362
	speed: 0.0078s/iter; left time: 12.7222s
	iters: 600, epoch: 10 | loss: 0.4463797
	speed: 0.0079s/iter; left time: 12.0553s
	iters: 700, epoch: 10 | loss: 0.2881314
	speed: 0.0079s/iter; left time: 11.2791s
	iters: 800, epoch: 10 | loss: 0.4307480
	speed: 0.0079s/iter; left time: 10.5210s
	iters: 900, epoch: 10 | loss: 0.3112576
	speed: 0.0079s/iter; left time: 9.7061s
	iters: 1000, epoch: 10 | loss: 0.2693796
	speed: 0.0078s/iter; left time: 8.8628s
	iters: 1100, epoch: 10 | loss: 0.3185288
	speed: 0.0080s/iter; left time: 8.2241s
	iters: 1200, epoch: 10 | loss: 0.3210255
	speed: 0.0079s/iter; left time: 7.3992s
	iters: 1300, epoch: 10 | loss: 0.2988385
	speed: 0.0079s/iter; left time: 6.5500s
	iters: 1400, epoch: 10 | loss: 0.3183482
	speed: 0.0078s/iter; left time: 5.6967s
	iters: 1500, epoch: 10 | loss: 0.3382044
	speed: 0.0078s/iter; left time: 4.9680s
	iters: 1600, epoch: 10 | loss: 0.3609711
	speed: 0.0078s/iter; left time: 4.1798s
	iters: 1700, epoch: 10 | loss: 0.3472838
	speed: 0.0079s/iter; left time: 3.4197s
	iters: 1800, epoch: 10 | loss: 0.2750895
	speed: 0.0078s/iter; left time: 2.6180s
	iters: 1900, epoch: 10 | loss: 0.2725720
	speed: 0.0078s/iter; left time: 1.8351s
	iters: 2000, epoch: 10 | loss: 0.3306920
	speed: 0.0078s/iter; left time: 1.0492s
	iters: 2100, epoch: 10 | loss: 0.2948140
	speed: 0.0079s/iter; left time: 0.2689s
Epoch: 10 cost time: 16.83292317390442
Epoch: 10, Steps: 2133 | Train Loss: 0.3332994 Vali Loss: 0.6649032
Updating learning rate to 1.953125e-05
EarlyStopping counter: 7 out of 10
#####   loading best weights   #####
Process: python3 (PID: 542426) is using 394 MiB of GPU memory.
Epoch: 10 | Elapsed Time: 1039.338775396347 s | VRAM usage: 0.384765625 Gb | Train MSE: 0.3578 Train MAE: 0.4109 Vali MSE: 0.6541 Vali MAE: 0.5403 Test MSE: 0.3914 Test MAE: 0.4057



Args in experiment:
Namespace(model='TimeMixer', task_name='long_term_forecast', seed=2021, data='ETTm1', root_path='./dataset/ETT-small/', data_path='ETTm1.csv', features='M', target='OT', freq='h', train_prop=1.0, seq_len=96, label_len=0, pred_len=720, seasonal_patterns='Monthly', inverse=False, enc_in=7, dec_in=7, c_out=7, decomp_method='moving_avg', top_k=5, moving_avg=25, d_model=16, d_ff=32, e_layers=2, dropout=0.1, embed='timeF', channel_independence=1, use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, output_attention=False, num_workers=4, train_epochs=10, batch_size=16, patience=10, delta=0.0, learning_rate=0.01, des='test', loss='MSE', lradj='type1', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', save_dir='./checkpoints/baseline/reproduction/ETTm1_96_720', save_last=False, break_at=0)
Use GPU: cuda:0
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6065266
	speed: 0.0144s/iter; left time: 301.3578s
	iters: 200, epoch: 1 | loss: 0.5106918
	speed: 0.0089s/iter; left time: 186.6361s
	iters: 300, epoch: 1 | loss: 0.4318809
	speed: 0.0085s/iter; left time: 177.1327s
	iters: 400, epoch: 1 | loss: 0.5284629
	speed: 0.0088s/iter; left time: 181.3226s
	iters: 500, epoch: 1 | loss: 0.4594403
	speed: 0.0089s/iter; left time: 182.4115s
	iters: 600, epoch: 1 | loss: 0.4831761
	speed: 0.0087s/iter; left time: 178.1304s
	iters: 700, epoch: 1 | loss: 0.4616873
	speed: 0.0087s/iter; left time: 176.9567s
	iters: 800, epoch: 1 | loss: 0.5028660
	speed: 0.0087s/iter; left time: 175.5469s
	iters: 900, epoch: 1 | loss: 0.4275442
	speed: 0.0087s/iter; left time: 176.0931s
	iters: 1000, epoch: 1 | loss: 0.4334817
	speed: 0.0083s/iter; left time: 166.5030s
	iters: 1100, epoch: 1 | loss: 0.4868520
	speed: 0.0079s/iter; left time: 158.2159s
	iters: 1200, epoch: 1 | loss: 0.5901220
	speed: 0.0079s/iter; left time: 158.0154s
	iters: 1300, epoch: 1 | loss: 0.4559057
	speed: 0.0080s/iter; left time: 157.7895s
	iters: 1400, epoch: 1 | loss: 0.3660873
	speed: 0.0079s/iter; left time: 155.5174s
	iters: 1500, epoch: 1 | loss: 0.4286410
	speed: 0.0080s/iter; left time: 156.4161s
	iters: 1600, epoch: 1 | loss: 0.4700633
	speed: 0.0080s/iter; left time: 155.3754s
	iters: 1700, epoch: 1 | loss: 0.3955725
	speed: 0.0079s/iter; left time: 154.0561s
	iters: 1800, epoch: 1 | loss: 0.5998600
	speed: 0.0079s/iter; left time: 152.7143s
	iters: 1900, epoch: 1 | loss: 0.4715743
	speed: 0.0079s/iter; left time: 151.7010s
	iters: 2000, epoch: 1 | loss: 0.5306832
	speed: 0.0080s/iter; left time: 152.7256s
	iters: 2100, epoch: 1 | loss: 0.3854295
	speed: 0.0080s/iter; left time: 151.7445s
Epoch: 1 cost time: 17.81545639038086
Epoch: 1, Steps: 2109 | Train Loss: 0.4926323 Vali Loss: 0.9880179
Updating learning rate to 0.01
Validation loss decreased (inf --> 0.9880).  Saving model state dict ...
	iters: 100, epoch: 2 | loss: 0.4537578
	speed: 0.0319s/iter; left time: 601.5302s
	iters: 200, epoch: 2 | loss: 0.4391915
	speed: 0.0079s/iter; left time: 147.8043s
	iters: 300, epoch: 2 | loss: 0.4970431
	speed: 0.0079s/iter; left time: 147.3095s
	iters: 400, epoch: 2 | loss: 0.5057102
	speed: 0.0078s/iter; left time: 145.7978s
	iters: 500, epoch: 2 | loss: 0.4250731
	speed: 0.0080s/iter; left time: 148.3359s
	iters: 600, epoch: 2 | loss: 0.5039226
	speed: 0.0088s/iter; left time: 162.3384s
	iters: 700, epoch: 2 | loss: 0.5126933
	speed: 0.0088s/iter; left time: 160.6844s
	iters: 800, epoch: 2 | loss: 0.6859840
	speed: 0.0084s/iter; left time: 152.1220s
	iters: 900, epoch: 2 | loss: 0.3641017
	speed: 0.0088s/iter; left time: 158.9646s
	iters: 1000, epoch: 2 | loss: 0.6038110
	speed: 0.0088s/iter; left time: 157.3522s
	iters: 1100, epoch: 2 | loss: 0.5665817
	speed: 0.0087s/iter; left time: 155.9632s
	iters: 1200, epoch: 2 | loss: 0.3942384
	speed: 0.0088s/iter; left time: 155.8486s
	iters: 1300, epoch: 2 | loss: 0.4418662
	speed: 0.0089s/iter; left time: 156.8088s
	iters: 1400, epoch: 2 | loss: 0.4753441
	speed: 0.0088s/iter; left time: 153.8455s
	iters: 1500, epoch: 2 | loss: 0.4787211
	speed: 0.0088s/iter; left time: 153.1486s
	iters: 1600, epoch: 2 | loss: 0.5113395
	speed: 0.0088s/iter; left time: 152.6010s
	iters: 1700, epoch: 2 | loss: 0.4416195
	speed: 0.0087s/iter; left time: 150.3746s
	iters: 1800, epoch: 2 | loss: 0.3709739
	speed: 0.0087s/iter; left time: 148.8008s
	iters: 1900, epoch: 2 | loss: 0.4377395
	speed: 0.0086s/iter; left time: 147.4079s
	iters: 2000, epoch: 2 | loss: 0.4960137
	speed: 0.0087s/iter; left time: 148.0409s
	iters: 2100, epoch: 2 | loss: 0.3047872
	speed: 0.0088s/iter; left time: 149.0379s
Epoch: 2 cost time: 18.144695043563843
Epoch: 2, Steps: 2109 | Train Loss: 0.4597786 Vali Loss: 0.9668606
Updating learning rate to 0.005
Validation loss decreased (0.9880 --> 0.9669).  Saving model state dict ...
	iters: 100, epoch: 3 | loss: 0.5221948
	speed: 0.0321s/iter; left time: 538.1602s
	iters: 200, epoch: 3 | loss: 0.5045909
	speed: 0.0089s/iter; left time: 147.9104s
	iters: 300, epoch: 3 | loss: 0.4326178
	speed: 0.0089s/iter; left time: 147.7630s
	iters: 400, epoch: 3 | loss: 0.4638210
	speed: 0.0086s/iter; left time: 142.4414s
	iters: 500, epoch: 3 | loss: 0.4144187
	speed: 0.0081s/iter; left time: 132.5571s
	iters: 600, epoch: 3 | loss: 0.4737404
	speed: 0.0080s/iter; left time: 129.8303s
	iters: 700, epoch: 3 | loss: 0.4131874
	speed: 0.0079s/iter; left time: 127.7432s
	iters: 800, epoch: 3 | loss: 0.3731532
	speed: 0.0079s/iter; left time: 127.4810s
	iters: 900, epoch: 3 | loss: 0.3838830
	speed: 0.0079s/iter; left time: 126.2515s
	iters: 1000, epoch: 3 | loss: 0.3505809
	speed: 0.0079s/iter; left time: 125.7002s
	iters: 1100, epoch: 3 | loss: 0.4346111
	speed: 0.0079s/iter; left time: 124.1898s
	iters: 1200, epoch: 3 | loss: 0.3964808
	speed: 0.0079s/iter; left time: 124.5771s
	iters: 1300, epoch: 3 | loss: 0.4402173
	speed: 0.0079s/iter; left time: 123.2727s
	iters: 1400, epoch: 3 | loss: 0.3444657
	speed: 0.0079s/iter; left time: 122.3426s
	iters: 1500, epoch: 3 | loss: 0.6282728
	speed: 0.0079s/iter; left time: 121.9687s
	iters: 1600, epoch: 3 | loss: 0.5281950
	speed: 0.0079s/iter; left time: 120.6595s
	iters: 1700, epoch: 3 | loss: 0.3726281
	speed: 0.0079s/iter; left time: 120.3132s
	iters: 1800, epoch: 3 | loss: 0.5991794
	speed: 0.0080s/iter; left time: 120.0939s
	iters: 1900, epoch: 3 | loss: 0.3545992
	speed: 0.0080s/iter; left time: 119.0892s
	iters: 2000, epoch: 3 | loss: 0.4364893
	speed: 0.0079s/iter; left time: 117.1847s
	iters: 2100, epoch: 3 | loss: 0.3897610
	speed: 0.0081s/iter; left time: 120.0379s
Epoch: 3 cost time: 17.19683837890625
Epoch: 3, Steps: 2109 | Train Loss: 0.4378624 Vali Loss: 0.9632644
Updating learning rate to 0.0025
Validation loss decreased (0.9669 --> 0.9633).  Saving model state dict ...
	iters: 100, epoch: 4 | loss: 0.4811002
	speed: 0.0313s/iter; left time: 459.0229s
	iters: 200, epoch: 4 | loss: 0.3592062
	speed: 0.0079s/iter; left time: 115.0046s
	iters: 300, epoch: 4 | loss: 0.3656595
	speed: 0.0080s/iter; left time: 115.2168s
	iters: 400, epoch: 4 | loss: 0.4243475
	speed: 0.0078s/iter; left time: 112.3372s
	iters: 500, epoch: 4 | loss: 0.4027098
	speed: 0.0079s/iter; left time: 112.2950s
	iters: 600, epoch: 4 | loss: 0.3945169
	speed: 0.0078s/iter; left time: 110.1212s
	iters: 700, epoch: 4 | loss: 0.5146199
	speed: 0.0079s/iter; left time: 111.4541s
	iters: 800, epoch: 4 | loss: 0.4297991
	speed: 0.0079s/iter; left time: 110.1559s
	iters: 900, epoch: 4 | loss: 0.4400460
	speed: 0.0078s/iter; left time: 108.2800s
	iters: 1000, epoch: 4 | loss: 0.4637610
	speed: 0.0078s/iter; left time: 107.3468s
	iters: 1100, epoch: 4 | loss: 0.4138032
	speed: 0.0079s/iter; left time: 107.6802s
	iters: 1200, epoch: 4 | loss: 0.2967084
	speed: 0.0078s/iter; left time: 105.4338s
	iters: 1300, epoch: 4 | loss: 0.4753079
	speed: 0.0078s/iter; left time: 104.4752s
	iters: 1400, epoch: 4 | loss: 0.4386164
	speed: 0.0078s/iter; left time: 103.6990s
	iters: 1500, epoch: 4 | loss: 0.4076950
	speed: 0.0078s/iter; left time: 103.7087s
	iters: 1600, epoch: 4 | loss: 0.3767277
	speed: 0.0079s/iter; left time: 103.5467s
	iters: 1700, epoch: 4 | loss: 0.3503299
	speed: 0.0077s/iter; left time: 101.0370s
	iters: 1800, epoch: 4 | loss: 0.4529119
	speed: 0.0078s/iter; left time: 101.5002s
	iters: 1900, epoch: 4 | loss: 0.2699172
	speed: 0.0078s/iter; left time: 99.8205s
	iters: 2000, epoch: 4 | loss: 0.3513756
	speed: 0.0079s/iter; left time: 101.1701s
	iters: 2100, epoch: 4 | loss: 0.4783344
	speed: 0.0079s/iter; left time: 99.8070s
Epoch: 4 cost time: 16.615448236465454
Epoch: 4, Steps: 2109 | Train Loss: 0.4241811 Vali Loss: 0.9698835
Updating learning rate to 0.00125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4126290
	speed: 0.0311s/iter; left time: 390.6833s
	iters: 200, epoch: 5 | loss: 0.3813776
	speed: 0.0085s/iter; left time: 105.9395s
	iters: 300, epoch: 5 | loss: 0.4073851
	speed: 0.0086s/iter; left time: 106.6442s
	iters: 400, epoch: 5 | loss: 0.4918346
	speed: 0.0080s/iter; left time: 97.7840s
	iters: 500, epoch: 5 | loss: 0.4320386
	speed: 0.0080s/iter; left time: 97.1425s
	iters: 600, epoch: 5 | loss: 0.4644766
	speed: 0.0080s/iter; left time: 95.9886s
	iters: 700, epoch: 5 | loss: 0.5206596
	speed: 0.0080s/iter; left time: 95.6542s
	iters: 800, epoch: 5 | loss: 0.4582847
	speed: 0.0080s/iter; left time: 94.3458s
	iters: 900, epoch: 5 | loss: 0.4569357
	speed: 0.0080s/iter; left time: 94.4053s
	iters: 1000, epoch: 5 | loss: 0.4165224
	speed: 0.0079s/iter; left time: 92.6536s
	iters: 1100, epoch: 5 | loss: 0.4130736
	speed: 0.0080s/iter; left time: 92.6477s
	iters: 1200, epoch: 5 | loss: 0.4083170
	speed: 0.0080s/iter; left time: 91.9581s
	iters: 1300, epoch: 5 | loss: 0.4015305
	speed: 0.0081s/iter; left time: 91.9215s
	iters: 1400, epoch: 5 | loss: 0.4959061
	speed: 0.0082s/iter; left time: 92.0270s
	iters: 1500, epoch: 5 | loss: 0.3683307
	speed: 0.0080s/iter; left time: 89.2899s
	iters: 1600, epoch: 5 | loss: 0.3530398
	speed: 0.0080s/iter; left time: 88.0422s
	iters: 1700, epoch: 5 | loss: 0.3469652
	speed: 0.0079s/iter; left time: 86.9875s
	iters: 1800, epoch: 5 | loss: 0.4244440
	speed: 0.0080s/iter; left time: 86.4885s
	iters: 1900, epoch: 5 | loss: 0.4640120
	speed: 0.0080s/iter; left time: 85.7024s
	iters: 2000, epoch: 5 | loss: 0.6145476
	speed: 0.0080s/iter; left time: 85.3271s
	iters: 2100, epoch: 5 | loss: 0.3827278
	speed: 0.0083s/iter; left time: 87.8300s
Epoch: 5 cost time: 17.102269649505615
Epoch: 5, Steps: 2109 | Train Loss: 0.4140799 Vali Loss: 0.9585557
Updating learning rate to 0.000625
Validation loss decreased (0.9633 --> 0.9586).  Saving model state dict ...
	iters: 100, epoch: 6 | loss: 0.3954627
	speed: 0.0312s/iter; left time: 326.1228s
	iters: 200, epoch: 6 | loss: 0.3008633
	speed: 0.0078s/iter; left time: 81.0380s
	iters: 300, epoch: 6 | loss: 0.4455638
	speed: 0.0089s/iter; left time: 90.7261s
	iters: 400, epoch: 6 | loss: 0.3954113
	speed: 0.0088s/iter; left time: 88.9490s
	iters: 500, epoch: 6 | loss: 0.4367336
	speed: 0.0088s/iter; left time: 88.3288s
	iters: 600, epoch: 6 | loss: 0.3625692
	speed: 0.0088s/iter; left time: 87.9303s
	iters: 700, epoch: 6 | loss: 0.3208196
	speed: 0.0089s/iter; left time: 87.3379s
	iters: 800, epoch: 6 | loss: 0.4220980
	speed: 0.0088s/iter; left time: 85.5652s
	iters: 900, epoch: 6 | loss: 0.4367281
	speed: 0.0088s/iter; left time: 84.7080s
	iters: 1000, epoch: 6 | loss: 0.3450392
	speed: 0.0088s/iter; left time: 83.8787s
	iters: 1100, epoch: 6 | loss: 0.3507223
	speed: 0.0088s/iter; left time: 82.9828s
	iters: 1200, epoch: 6 | loss: 0.3736455
	speed: 0.0088s/iter; left time: 82.6564s
	iters: 1300, epoch: 6 | loss: 0.3826069
	speed: 0.0088s/iter; left time: 81.0971s
	iters: 1400, epoch: 6 | loss: 0.4298299
	speed: 0.0088s/iter; left time: 80.1396s
	iters: 1500, epoch: 6 | loss: 0.3326091
	speed: 0.0087s/iter; left time: 78.7847s
	iters: 1600, epoch: 6 | loss: 0.3694752
	speed: 0.0087s/iter; left time: 77.7722s
	iters: 1700, epoch: 6 | loss: 0.3539874
	speed: 0.0087s/iter; left time: 76.9796s
	iters: 1800, epoch: 6 | loss: 0.4168569
	speed: 0.0087s/iter; left time: 76.4473s
	iters: 1900, epoch: 6 | loss: 0.4664111
	speed: 0.0088s/iter; left time: 75.6908s
	iters: 2000, epoch: 6 | loss: 0.6046101
	speed: 0.0088s/iter; left time: 75.1329s
	iters: 2100, epoch: 6 | loss: 0.3078410
	speed: 0.0088s/iter; left time: 74.0025s
Epoch: 6 cost time: 18.423952102661133
Epoch: 6, Steps: 2109 | Train Loss: 0.4072895 Vali Loss: 0.9581329
Updating learning rate to 0.0003125
Validation loss decreased (0.9586 --> 0.9581).  Saving model state dict ...
	iters: 100, epoch: 7 | loss: 0.4787999
	speed: 0.0328s/iter; left time: 273.7062s
	iters: 200, epoch: 7 | loss: 0.3948099
	speed: 0.0088s/iter; left time: 72.7072s
	iters: 300, epoch: 7 | loss: 0.4891224
	speed: 0.0088s/iter; left time: 71.4663s
	iters: 400, epoch: 7 | loss: 0.4376163
	speed: 0.0088s/iter; left time: 71.0131s
	iters: 500, epoch: 7 | loss: 0.5441173
	speed: 0.0088s/iter; left time: 69.9022s
	iters: 600, epoch: 7 | loss: 0.3717319
	speed: 0.0089s/iter; left time: 69.4315s
	iters: 700, epoch: 7 | loss: 0.3711644
	speed: 0.0088s/iter; left time: 68.0495s
	iters: 800, epoch: 7 | loss: 0.5279199
	speed: 0.0087s/iter; left time: 66.3693s
	iters: 900, epoch: 7 | loss: 0.4060489
	speed: 0.0081s/iter; left time: 61.2305s
	iters: 1000, epoch: 7 | loss: 0.4460413
	speed: 0.0081s/iter; left time: 60.4902s
	iters: 1100, epoch: 7 | loss: 0.3220381
	speed: 0.0080s/iter; left time: 59.0094s
	iters: 1200, epoch: 7 | loss: 0.3085330
	speed: 0.0082s/iter; left time: 59.1590s
	iters: 1300, epoch: 7 | loss: 0.3803584
	speed: 0.0080s/iter; left time: 57.1938s
	iters: 1400, epoch: 7 | loss: 0.4248928
	speed: 0.0080s/iter; left time: 56.2985s
	iters: 1500, epoch: 7 | loss: 0.4823641
	speed: 0.0080s/iter; left time: 55.4933s
	iters: 1600, epoch: 7 | loss: 0.5530477
	speed: 0.0080s/iter; left time: 54.5696s
	iters: 1700, epoch: 7 | loss: 0.3502979
	speed: 0.0080s/iter; left time: 53.7211s
	iters: 1800, epoch: 7 | loss: 0.3928443
	speed: 0.0080s/iter; left time: 52.9388s
	iters: 1900, epoch: 7 | loss: 0.3148975
	speed: 0.0079s/iter; left time: 51.9664s
	iters: 2000, epoch: 7 | loss: 0.4114556
	speed: 0.0079s/iter; left time: 51.1099s
	iters: 2100, epoch: 7 | loss: 0.3528698
	speed: 0.0080s/iter; left time: 50.5656s
Epoch: 7 cost time: 17.629383087158203
Epoch: 7, Steps: 2109 | Train Loss: 0.4029089 Vali Loss: 0.9623237
Updating learning rate to 0.00015625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3618833
	speed: 0.0326s/iter; left time: 202.8629s
	iters: 200, epoch: 8 | loss: 0.3614518
	speed: 0.0088s/iter; left time: 53.8382s
	iters: 300, epoch: 8 | loss: 0.4035531
	speed: 0.0088s/iter; left time: 52.9982s
	iters: 400, epoch: 8 | loss: 0.3908966
	speed: 0.0087s/iter; left time: 51.6928s
	iters: 500, epoch: 8 | loss: 0.3796226
	speed: 0.0087s/iter; left time: 50.6314s
	iters: 600, epoch: 8 | loss: 0.3577855
	speed: 0.0087s/iter; left time: 50.0326s
	iters: 700, epoch: 8 | loss: 0.4456662
	speed: 0.0088s/iter; left time: 49.2953s
	iters: 800, epoch: 8 | loss: 0.3470864
	speed: 0.0087s/iter; left time: 48.0411s
	iters: 900, epoch: 8 | loss: 0.3214004
	speed: 0.0080s/iter; left time: 43.3364s
	iters: 1000, epoch: 8 | loss: 0.5363637
	speed: 0.0080s/iter; left time: 42.6368s
	iters: 1100, epoch: 8 | loss: 0.3920253
	speed: 0.0080s/iter; left time: 42.0849s
	iters: 1200, epoch: 8 | loss: 0.4399282
	speed: 0.0080s/iter; left time: 40.9145s
	iters: 1300, epoch: 8 | loss: 0.3811282
	speed: 0.0080s/iter; left time: 40.1029s
	iters: 1400, epoch: 8 | loss: 0.4007932
	speed: 0.0080s/iter; left time: 39.2507s
	iters: 1500, epoch: 8 | loss: 0.3779794
	speed: 0.0080s/iter; left time: 38.7683s
	iters: 1600, epoch: 8 | loss: 0.3225268
	speed: 0.0080s/iter; left time: 37.8777s
	iters: 1700, epoch: 8 | loss: 0.4097213
	speed: 0.0080s/iter; left time: 37.1077s
	iters: 1800, epoch: 8 | loss: 0.3219316
	speed: 0.0080s/iter; left time: 36.4071s
	iters: 1900, epoch: 8 | loss: 0.3627602
	speed: 0.0088s/iter; left time: 38.8237s
	iters: 2000, epoch: 8 | loss: 0.3925645
	speed: 0.0087s/iter; left time: 37.6279s
	iters: 2100, epoch: 8 | loss: 0.4057329
	speed: 0.0087s/iter; left time: 36.7938s
Epoch: 8 cost time: 17.80968952178955
Epoch: 8, Steps: 2109 | Train Loss: 0.4007351 Vali Loss: 0.9595636
Updating learning rate to 7.8125e-05
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4911847
	speed: 0.0325s/iter; left time: 133.8285s
	iters: 200, epoch: 9 | loss: 0.3696617
	speed: 0.0088s/iter; left time: 35.4466s
	iters: 300, epoch: 9 | loss: 0.4346723
	speed: 0.0088s/iter; left time: 34.5750s
	iters: 400, epoch: 9 | loss: 0.3788579
	speed: 0.0089s/iter; left time: 33.8346s
	iters: 500, epoch: 9 | loss: 0.3657398
	speed: 0.0083s/iter; left time: 30.9916s
	iters: 600, epoch: 9 | loss: 0.3294684
	speed: 0.0080s/iter; left time: 28.8277s
	iters: 700, epoch: 9 | loss: 0.3720642
	speed: 0.0083s/iter; left time: 29.0461s
	iters: 800, epoch: 9 | loss: 0.3914700
	speed: 0.0082s/iter; left time: 28.0177s
	iters: 900, epoch: 9 | loss: 0.4101785
	speed: 0.0088s/iter; left time: 29.1675s
	iters: 1000, epoch: 9 | loss: 0.4806732
	speed: 0.0088s/iter; left time: 28.3086s
	iters: 1100, epoch: 9 | loss: 0.3484136
	speed: 0.0087s/iter; left time: 27.2648s
	iters: 1200, epoch: 9 | loss: 0.5366598
	speed: 0.0079s/iter; left time: 23.8362s
	iters: 1300, epoch: 9 | loss: 0.3992811
	speed: 0.0079s/iter; left time: 22.9919s
	iters: 1400, epoch: 9 | loss: 0.3547854
	speed: 0.0080s/iter; left time: 22.4933s
	iters: 1500, epoch: 9 | loss: 0.3626366
	speed: 0.0079s/iter; left time: 21.3808s
	iters: 1600, epoch: 9 | loss: 0.3525725
	speed: 0.0079s/iter; left time: 20.6689s
	iters: 1700, epoch: 9 | loss: 0.3414484
	speed: 0.0078s/iter; left time: 19.7610s
	iters: 1800, epoch: 9 | loss: 0.3708770
	speed: 0.0078s/iter; left time: 18.9223s
	iters: 1900, epoch: 9 | loss: 0.5795703
	speed: 0.0079s/iter; left time: 18.3045s
	iters: 2000, epoch: 9 | loss: 0.3471420
	speed: 0.0081s/iter; left time: 17.9530s
	iters: 2100, epoch: 9 | loss: 0.4242276
	speed: 0.0082s/iter; left time: 17.3585s
Epoch: 9 cost time: 17.53434181213379
Epoch: 9, Steps: 2109 | Train Loss: 0.3992970 Vali Loss: 0.9612627
Updating learning rate to 3.90625e-05
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3383411
	speed: 0.0319s/iter; left time: 64.1701s
	iters: 200, epoch: 10 | loss: 0.4840075
	speed: 0.0080s/iter; left time: 15.2705s
	iters: 300, epoch: 10 | loss: 0.3362797
	speed: 0.0081s/iter; left time: 14.6761s
	iters: 400, epoch: 10 | loss: 0.3548241
	speed: 0.0080s/iter; left time: 13.7455s
	iters: 500, epoch: 10 | loss: 0.4209876
	speed: 0.0082s/iter; left time: 13.2074s
	iters: 600, epoch: 10 | loss: 0.4133128
	speed: 0.0081s/iter; left time: 12.1565s
	iters: 700, epoch: 10 | loss: 0.4130556
	speed: 0.0080s/iter; left time: 11.2341s
	iters: 800, epoch: 10 | loss: 0.4725194
	speed: 0.0086s/iter; left time: 11.2748s
	iters: 900, epoch: 10 | loss: 0.3410939
	speed: 0.0081s/iter; left time: 9.8390s
	iters: 1000, epoch: 10 | loss: 0.3524643
	speed: 0.0081s/iter; left time: 8.9617s
	iters: 1100, epoch: 10 | loss: 0.3833274
	speed: 0.0081s/iter; left time: 8.1788s
	iters: 1200, epoch: 10 | loss: 0.4010051
	speed: 0.0081s/iter; left time: 7.3504s
	iters: 1300, epoch: 10 | loss: 0.5523353
	speed: 0.0081s/iter; left time: 6.5971s
	iters: 1400, epoch: 10 | loss: 0.3880709
	speed: 0.0080s/iter; left time: 5.6702s
	iters: 1500, epoch: 10 | loss: 0.3651763
	speed: 0.0080s/iter; left time: 4.8715s
	iters: 1600, epoch: 10 | loss: 0.4685596
	speed: 0.0081s/iter; left time: 4.1193s
	iters: 1700, epoch: 10 | loss: 0.5689176
	speed: 0.0083s/iter; left time: 3.3945s
	iters: 1800, epoch: 10 | loss: 0.3743066
	speed: 0.0080s/iter; left time: 2.4684s
	iters: 1900, epoch: 10 | loss: 0.3783349
	speed: 0.0081s/iter; left time: 1.6993s
	iters: 2000, epoch: 10 | loss: 0.3580819
	speed: 0.0081s/iter; left time: 0.8950s
	iters: 2100, epoch: 10 | loss: 0.4135984
	speed: 0.0081s/iter; left time: 0.0810s
Epoch: 10 cost time: 17.174020051956177
Epoch: 10, Steps: 2109 | Train Loss: 0.3987949 Vali Loss: 0.9602902
Updating learning rate to 1.953125e-05
EarlyStopping counter: 4 out of 10
#####   loading best weights   #####
Process: python3 (PID: 544069) is using 416 MiB of GPU memory.
Epoch: 10 | Elapsed Time: 1086.465413093567 s | VRAM usage: 0.40625 Gb | Train MSE: 0.4014 Train MAE: 0.4429 Vali MSE: 0.9581 Vali MAE: 0.6524 Test MSE: 0.4588 Test MAE: 0.4458



